<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hesap Silme - Final Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .step {
            background: #f8f9fa;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            border-left: 4px solid #007bff;
        }
        .step h3 {
            margin: 0 0 15px 0;
            color: #007bff;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 8px;
            font-size: 14px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .danger-button {
            background: #dc2626;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 8px;
            font-size: 14px;
        }
        .danger-button:hover {
            background: #b91c1c;
        }
        .result {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: bold;
        }
        .success { background: #d1fae5; color: #065f46; border: 1px solid #a7f3d0; }
        .error { background: #fee2e2; color: #991b1b; border: 1px solid #fca5a5; }
        .warning { background: #fef3c7; color: #92400e; border: 1px solid #fbbf24; }
        .console-output {
            background: #1f2937;
            color: #f3f4f6;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”§ Hesap Silme - Final Debug Test</h1>
        
        <div class="step">
            <h3>1ï¸âƒ£ Ana Sayfa Durum KontrolÃ¼</h3>
            <button class="test-button" onclick="testMainPageStatus()">Ana Sayfa Test Et</button>
            <div id="main-page-result"></div>
        </div>

        <div class="step">
            <h3>2ï¸âƒ£ Profil SayfasÄ±nÄ± AÃ§</h3>
            <button class="test-button" onclick="openProfilePage()">Profil SayfasÄ±nÄ± AÃ§</button>
            <div id="profile-result"></div>
        </div>

        <div class="step">
            <h3>3ï¸âƒ£ Hesap Silme Butonunu Test Et</h3>
            <button class="danger-button" onclick="testDeleteButton()">Hesap Silme Butonunu Test Et</button>
            <div id="delete-test-result"></div>
        </div>

        <div class="step">
            <h3>4ï¸âƒ£ Manuel Init Test</h3>
            <button class="test-button" onclick="manualInit()">Manuel Initialize</button>
            <div id="manual-init-result"></div>
        </div>

        <div class="step">
            <h3>ğŸ“„ Console Output</h3>
            <div class="console-output" id="console-output">Console mesajlarÄ± burada gÃ¶rÃ¼necek...</div>
        </div>
    </div>

    <script>
        // Console logging
        let consoleLog = '';
        const originalConsole = {
            log: console.log,
            error: console.error,
            warn: console.warn
        };

        function addToConsole(type, ...args) {
            const timestamp = new Date().toLocaleTimeString();
            const message = `[${timestamp}] ${type.toUpperCase()}: ${args.join(' ')}\n`;
            consoleLog += message;
            document.getElementById('console-output').textContent = consoleLog;
            
            // Scroll to bottom
            const output = document.getElementById('console-output');
            output.scrollTop = output.scrollHeight;
        }

        console.log = function(...args) {
            addToConsole('log', ...args);
            originalConsole.log.apply(console, args);
        };

        console.error = function(...args) {
            addToConsole('error', ...args);
            originalConsole.error.apply(console, args);
        };

        console.warn = function(...args) {
            addToConsole('warn', ...args);
            originalConsole.warn.apply(console, args);
        };

        function testMainPageStatus() {
            console.log('ğŸ” Ana sayfa durumu kontrol ediliyor...');
            
            // Ana penceredeki elementi kontrol et
            try {
                const iframe = document.createElement('iframe');
                iframe.src = 'index.html';
                iframe.style.display = 'none';
                document.body.appendChild(iframe);
                
                iframe.onload = function() {
                    try {
                        const deleteBtn = iframe.contentDocument.getElementById('delete-account-button');
                        if (deleteBtn) {
                            document.getElementById('main-page-result').innerHTML = 
                                '<div class="result success">âœ… delete-account-button bulundu!</div>';
                            console.log('âœ… delete-account-button iframe iÃ§inde bulundu');
                        } else {
                            document.getElementById('main-page-result').innerHTML = 
                                '<div class="result error">âŒ delete-account-button bulunamadÄ±!</div>';
                            console.error('âŒ delete-account-button iframe iÃ§inde bulunamadÄ±');
                        }
                    } catch (error) {
                        document.getElementById('main-page-result').innerHTML = 
                            '<div class="result warning">âš ï¸ Cross-origin eriÅŸim hatasÄ±</div>';
                        console.warn('âš ï¸ Cross-origin policy nedeniyle iframe eriÅŸimi engellendi');
                    }
                    
                    document.body.removeChild(iframe);
                };
            } catch (error) {
                console.error('âŒ Iframe test hatasÄ±:', error);
                document.getElementById('main-page-result').innerHTML = 
                    '<div class="result error">âŒ Test baÅŸarÄ±sÄ±z: ' + error.message + '</div>';
            }
        }

        function openProfilePage() {
            console.log('ğŸ“„ Profil sayfasÄ± aÃ§Ä±lmaya Ã§alÄ±ÅŸÄ±lÄ±yor...');
            
            // Ana sayfayÄ± yeni sekmede aÃ§
            const newWindow = window.open('index.html', '_blank');
            
            if (newWindow) {
                document.getElementById('profile-result').innerHTML = 
                    '<div class="result success">âœ… Ana sayfa yeni sekmede aÃ§Ä±ldÄ±. SaÄŸ alt kÃ¶ÅŸedeki ayarlar butonuna (âš™ï¸) tÄ±klayÄ±n, sonra profil seÃ§eneÄŸini seÃ§in.</div>';
                console.log('âœ… Ana sayfa yeni sekmede aÃ§Ä±ldÄ±');
            } else {
                document.getElementById('profile-result').innerHTML = 
                    '<div class="result error">âŒ Popup blocker tarafÄ±ndan engellendi</div>';
                console.error('âŒ Yeni sekme aÃ§Ä±lamadÄ± - popup blocker');
            }
        }

        function testDeleteButton() {
            console.log('ğŸ—‘ï¸ Hesap silme butonu test ediliyor...');
            
            // Ana sayfada JavaScript kodu Ã§alÄ±ÅŸtÄ±r
            const script = `
                // Butonu bul
                const deleteBtn = document.getElementById('delete-account-button');
                if (deleteBtn) {
                    console.log('âœ… Buton bulundu:', deleteBtn);
                    
                    // Event listener'larÄ± kontrol et
                    const events = getEventListeners ? getEventListeners(deleteBtn) : 'Bilinmiyor';
                    console.log('ğŸ”— Event listeners:', events);
                    
                    // initializeAccountDeletion fonksiyonunu kontrol et
                    if (typeof window.initializeAccountDeletion === 'function') {
                        console.log('âœ… initializeAccountDeletion fonksiyonu mevcut');
                        
                        // Manuel olarak initialize et
                        window.initializeAccountDeletion();
                        console.log('ğŸ”„ initializeAccountDeletion manuel olarak Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±');
                    } else {
                        console.error('âŒ initializeAccountDeletion fonksiyonu bulunamadÄ±');
                    }
                } else {
                    console.error('âŒ delete-account-button bulunamadÄ±');
                }
            `;
            
            document.getElementById('delete-test-result').innerHTML = 
                '<div class="result warning">âš ï¸ Test kodu hazÄ±rlandÄ±. Ana sayfanÄ±n console\'Ä±nda Ã§alÄ±ÅŸtÄ±rÄ±n:</div>' +
                '<div style="background: #f1f5f9; padding: 10px; border-radius: 5px; margin: 10px 0; font-family: monospace; font-size: 12px;">' +
                script.replace(/\n/g, '<br>').replace(/ /g, '&nbsp;') +
                '</div>';
            
            console.log('ğŸ“‹ Test kodu hazÄ±rlandÄ± - Ana sayfanÄ±n console\'Ä±nda Ã§alÄ±ÅŸtÄ±rÄ±n');
        }

        function manualInit() {
            console.log('ğŸ”§ Manuel initialize test ediliyor...');
            
            // Test kodu
            const initCode = `
// Manuel Account Deletion Initialize
window.manualAccountDeletionInit = function() {
    console.log('ğŸ”§ Manuel account deletion baÅŸlatÄ±lÄ±yor...');
    
    const deleteBtn = document.getElementById('delete-account-button');
    if (!deleteBtn) {
        console.error('âŒ delete-account-button bulunamadÄ±');
        return false;
    }
    
    console.log('âœ… Buton bulundu, event listener ekleniyor...');
    
    deleteBtn.addEventListener('click', function() {
        console.log('ğŸ—‘ï¸ Hesap silme butonuna tÄ±klandÄ±!');
        alert('TEST: Hesap silme butonu Ã§alÄ±ÅŸÄ±yor!');
        
        const modal = document.getElementById('account-deletion-modal');
        if (modal) {
            modal.style.display = 'flex';
            console.log('âœ… Modal aÃ§Ä±ldÄ±');
        } else {
            console.error('âŒ Modal bulunamadÄ±');
        }
    });
    
    console.log('âœ… Event listener eklendi');
    return true;
};

// Ã‡alÄ±ÅŸtÄ±r
window.manualAccountDeletionInit();
            `;
            
            document.getElementById('manual-init-result').innerHTML = 
                '<div class="result warning">âš ï¸ Manuel init kodu hazÄ±rlandÄ±. Ana sayfanÄ±n console\'Ä±nda Ã§alÄ±ÅŸtÄ±rÄ±n:</div>' +
                '<div style="background: #f1f5f9; padding: 10px; border-radius: 5px; margin: 10px 0; font-family: monospace; font-size: 11px; max-height: 200px; overflow-y: auto;">' +
                initCode.replace(/\n/g, '<br>').replace(/ /g, '&nbsp;') +
                '</div>';
            
            console.log('ğŸ“‹ Manuel init kodu hazÄ±rlandÄ±');
        }

        // Sayfa yÃ¼klendiÄŸinde baÅŸlat
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ Debug test sayfasÄ± yÃ¼klendi');
            addToConsole('info', 'Debug test hazÄ±r - testleri baÅŸlatabilirsiniz');
        });
    </script>
</body>
</html>
