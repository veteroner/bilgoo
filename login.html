<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#4a148c">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains; preload">
    <title>Bilgoo - KullanÄ±cÄ± GiriÅŸi</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="font-awesome-minimal.css">
    <!-- ðŸ”’ GÃœVENLÄ°K KONFÄ°GÃœRASYONU -->
    <script src="runtime-env.js"></script>
    <script src="env-config.js"></script>
    <script src="netlify-config.js"></script>
    <script src="netlify-firebase-fix.js"></script>
    <script src="security-config.js"></script>
    <style>
        /* Ekstra ortalama iÃ§in CSS */
        .user-preferences-container {
            display: flex !important;
            justify-content: center !important;
            align-items: center !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            bottom: 0 !important;
            width: 100% !important;
            height: 100% !important;
            z-index: 1000 !important;
            padding: 20px !important;
        }
        
        .user-preferences-container.hidden {
            display: none !important;
        }
        
        .user-preferences-container .auth-box {
            margin: 0 auto !important;
            max-width: 500px !important;
            width: 100% !important;
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div id="splash-screen">
        <div class="splash-bg-particles"></div>
        <div class="splash-content">
            <div class="splash-logo">
                <div class="teknova-logo">
                    <div class="logo-text gradient-text">Teknova</div>
                    <div class="logo-subtitle">
                        <span>Game Labs</span>
                        <i class="fas fa-flask"></i>
                    </div>
                    <svg width="500" height="120" viewBox="0 0 500 120" fill="none" xmlns="http://www.w3.org/2000/svg" class="circuit-board">
                        <defs>
                            <linearGradient id="circuit-gradient" x1="0" y1="0" x2="500" y2="0" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#3a8dde"/>
                                <stop offset="0.5" stop-color="#7b1fa2"/>
                                <stop offset="1" stop-color="#00eaff"/>
                            </linearGradient>
                            <radialGradient id="circuit-gradient-node" cx="0.5" cy="0.5" r="0.5" fx="0.5" fy="0.5">
                                <stop offset="0%" stop-color="#00eaff"/>
                                <stop offset="100%" stop-color="#7b1fa2"/>
                            </radialGradient>
                        </defs>
                        <!-- Devre Ã§izgileri -->
                        <path d="M60 70 L100 70 L120 50 L180 50 L200 70 L250 70 L270 50 L330 50 L350 70 L400 70" class="circuit-line" />
                        <path d="M80 80 L130 80 L150 60 L220 60 L240 80 L300 80 L320 60 L380 60 L400 80" class="circuit-line" />
                        <path d="M40 90 L70 90 L90 70 L140 70 L160 90 L200 90 L220 70 L280 70 L300 90 L350 90 L370 70 L420 70" class="circuit-line" />
                        <!-- Devre noktalarÄ± -->
                        <circle cx="60" cy="70" r="3" class="circuit-node" />
                        <circle cx="100" cy="70" r="3" class="circuit-node" />
                        <circle cx="120" cy="50" r="3" class="circuit-node" />
                        <circle cx="180" cy="50" r="3" class="circuit-node" />
                        <circle cx="200" cy="70" r="3" class="circuit-node" />
                        <circle cx="250" cy="70" r="3" class="circuit-node" />
                        <circle cx="270" cy="50" r="3" class="circuit-node" />
                        <circle cx="330" cy="50" r="3" class="circuit-node" />
                        <circle cx="350" cy="70" r="3" class="circuit-node" />
                        <circle cx="400" cy="70" r="3" class="circuit-node" />
                        <circle cx="80" cy="80" r="3" class="circuit-node" />
                        <circle cx="130" cy="80" r="3" class="circuit-node" />
                        <circle cx="150" cy="60" r="3" class="circuit-node" />
                        <circle cx="220" cy="60" r="3" class="circuit-node" />
                        <circle cx="240" cy="80" r="3" class="circuit-node" />
                        <circle cx="300" cy="80" r="3" class="circuit-node" />
                        <circle cx="320" cy="60" r="3" class="circuit-node" />
                        <circle cx="380" cy="60" r="3" class="circuit-node" />
                        <circle cx="400" cy="80" r="3" class="circuit-node" />
                        <circle cx="40" cy="90" r="3" class="circuit-node" />
                        <circle cx="70" cy="90" r="3" class="circuit-node" />
                        <circle cx="90" cy="70" r="3" class="circuit-node" />
                        <circle cx="140" cy="70" r="3" class="circuit-node" />
                        <circle cx="160" cy="90" r="3" class="circuit-node" />
                        <circle cx="200" cy="90" r="3" class="circuit-node" />
                        <circle cx="220" cy="70" r="3" class="circuit-node" />
                        <circle cx="280" cy="70" r="3" class="circuit-node" />
                        <circle cx="300" cy="90" r="3" class="circuit-node" />
                        <circle cx="350" cy="90" r="3" class="circuit-node" />
                        <circle cx="370" cy="70" r="3" class="circuit-node" />
                        <circle cx="420" cy="70" r="3" class="circuit-node" />
                    </svg>
                </div>
            </div>
            <div class="splash-loader modern-loader">
                <div class="splash-loader-bar"></div>
                <div class="loader-percentage glass">%0</div>
            </div>
        </div>
    </div>

    <!-- KullanÄ±cÄ± Tercihleri EkranÄ± -->
    <div class="container user-preferences-container" style="display: none;">
        <div class="auth-box" id="preferences-box">
            <div class="main-logo">
                <svg width="300" height="84" viewBox="0 0 500 140" xmlns="http://www.w3.org/2000/svg" style="margin: 0 auto 10px auto; display: block;">
                    <defs>
                        <!-- Gradientler her harf iÃ§in -->
                        <linearGradient id="grad-b" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#4285f4;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#1a73e8;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-i" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#ea4335;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#d93025;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-l" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#fbbc04;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#f9ab00;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-g" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#4285f4;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#1a73e8;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-o1" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#34a853;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#137333;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-o2" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#ea4335;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#d93025;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <!-- B harfi -->
                    <text x="45" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-b)">B</text>
                    <!-- i harfi -->
                    <text x="135" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-i)">i</text>
                    <!-- l harfi -->
                    <text x="175" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-l)">l</text>
                    <!-- g harfi -->
                    <text x="215" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-g)">g</text>
                    <!-- o harfi -->
                    <text x="285" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-o1)">o</text>
                    <!-- o harfi -->
                    <text x="360" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-o2)">o</text>
                </svg>
            </div>
            <h2>Tercihlerinizi AyarlayÄ±n</h2>
            
            <div class="preferences-description">
                Oyun deneyiminizi kiÅŸiselleÅŸtirmek iÃ§in lÃ¼tfen aÅŸaÄŸÄ±daki tercihleri ayarlayÄ±n. Bu tercihler, sizin iÃ§in uygun zorlukta ve dilde sorularÄ±n hazÄ±rlanmasÄ±nÄ± saÄŸlayacaktÄ±r.
            </div>
            
            <form id="user-preferences-form">
                <div class="form-group">
                    <label for="user-language"><i class="fas fa-language"></i> Tercih ettiÄŸiniz dil</label>
                    <select id="user-language" required>
                        <option value="tr" selected>TÃ¼rkÃ§e</option>
                        <option value="en">English</option>
                        <option value="de">Deutsch</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="user-age"><i class="fas fa-user-clock"></i> YaÅŸ AralÄ±ÄŸÄ±nÄ±z</label>
                    <select id="user-age" required>
                        <option value="child">Ã‡ocuk (7-12)</option>
                        <option value="teen">GenÃ§ (13-17)</option>
                        <option value="adult" selected>YetiÅŸkin (18+)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="difficulty-preference"><i class="fas fa-sliders-h"></i> Zorluk Seviyesi</label>
                    <select id="difficulty-preference">
                        <option value="auto" selected>Otomatik (YaÅŸa gÃ¶re ayarla)</option>
                        <option value="easy">Kolay</option>
                        <option value="medium">Orta</option>
                        <option value="hard">Zor</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <button type="submit" class="btn-primary" id="save-preferences">Devam Et</button>
                </div>
            </form>
            
            <div class="preferences-note">
                <i class="fas fa-info-circle"></i> Bu ayarlarÄ± daha sonra oyun iÃ§erisindeki ayarlar menÃ¼sÃ¼nden deÄŸiÅŸtirebilirsiniz.
            </div>
        </div>
    </div>

    <!-- ðŸ”’ GÃœVENLÄ°K: Login container varsayÄ±lan olarak gizli -->
    <div class="container login-container" style="display: none; visibility: hidden;">
        <div class="auth-box" id="login-box">
            <div class="main-logo">
                <svg width="300" height="84" viewBox="0 0 500 140" xmlns="http://www.w3.org/2000/svg" style="margin: 0 auto 10px auto; display: block;">
                    <defs>
                        <!-- Gradientler her harf iÃ§in -->
                        <linearGradient id="grad-b-login" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#4285f4;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#1a73e8;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-i-login" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#ea4335;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#d93025;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-l-login" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#fbbc04;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#f9ab00;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-g-login" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#4285f4;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#1a73e8;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-o1-login" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#34a853;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#137333;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-o2-login" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#ea4335;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#d93025;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <!-- B harfi -->
                    <text x="45" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-b-login)">B</text>
                    <!-- i harfi -->
                    <text x="135" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-i-login)">i</text>
                    <!-- l harfi -->
                    <text x="175" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-l-login)">l</text>
                    <!-- g harfi -->
                    <text x="215" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-g-login)">g</text>
                    <!-- o harfi -->
                    <text x="285" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-o1-login)">o</text>
                    <!-- o harfi -->
                    <text x="360" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-o2-login)">o</text>
                </svg>
            </div>
            <h2>GiriÅŸ Yap</h2>
            
            <div id="login-error" class="error-message"></div>
            
            <form id="login-form">
                <div class="form-group">
                    <label for="login-email"><i class="fas fa-envelope"></i> E-posta</label>
                    <input type="email" id="login-email" required>
                </div>
                <div class="form-group">
                    <label for="login-password"><i class="fas fa-lock"></i> Åžifre</label>
                    <input type="password" id="login-password" required>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn-primary">GiriÅŸ Yap</button>
                </div>
            </form>
            
            <div class="auth-options">
                <p>HesabÄ±nÄ±z yok mu? <a href="#" id="show-register">KayÄ±t Ol</a></p>
                <p><a href="#" id="anonymous-login">Misafir olarak devam et</a></p>
            </div>
        </div>
        
        <div class="auth-box" id="register-box" style="display: none;">
            <div class="main-logo">
                <svg width="300" height="84" viewBox="0 0 500 140" xmlns="http://www.w3.org/2000/svg" style="margin: 0 auto 10px auto; display: block;">
                    <defs>
                        <!-- Gradientler her harf iÃ§in -->
                        <linearGradient id="grad-b-register" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#4285f4;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#1a73e8;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-i-register" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#ea4335;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#d93025;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-l-register" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#fbbc04;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#f9ab00;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-g-register" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#4285f4;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#1a73e8;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-o1-register" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#34a853;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#137333;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad-o2-register" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#ea4335;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#d93025;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <!-- B harfi -->
                    <text x="45" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-b-register)">B</text>
                    <!-- i harfi -->
                    <text x="135" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-i-register)">i</text>
                    <!-- l harfi -->
                    <text x="175" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-l-register)">l</text>
                    <!-- g harfi -->
                    <text x="215" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-g-register)">g</text>
                    <!-- o harfi -->
                    <text x="285" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-o1-register)">o</text>
                    <!-- o harfi -->
                    <text x="360" y="95" font-family="Arial, sans-serif" font-size="100" font-weight="bold" fill="url(#grad-o2-register)">o</text>
                </svg>
            </div>
            <h2>KayÄ±t Ol</h2>
            
            <div id="register-error" class="error-message"></div>
            
            <form id="register-form">
                <div class="form-group">
                    <label for="register-username"><i class="fas fa-user"></i> KullanÄ±cÄ± AdÄ±</label>
                    <input type="text" id="register-username" required>
                </div>
                <div class="form-group">
                    <label for="register-email"><i class="fas fa-envelope"></i> E-posta</label>
                    <input type="email" id="register-email" required>
                </div>
                <div class="form-group">
                    <label for="register-password"><i class="fas fa-lock"></i> Åžifre</label>
                    <input type="password" id="register-password" required minlength="6">
                </div>
                <div class="form-group">
                    <label for="register-password-confirm"><i class="fas fa-lock"></i> Åžifre Tekrar</label>
                    <input type="password" id="register-password-confirm" required>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn-primary">KayÄ±t Ol</button>
                </div>
            </form>
            
            <div class="auth-options">
                <p>Zaten hesabÄ±nÄ±z var mÄ±? <a href="#" id="show-login">GiriÅŸ Yap</a></p>
            </div>
        </div>
    </div>
    
    <!-- Firebase gÃ¶stergesi -->
    <div id="firebase-status" style="position: fixed; bottom: 10px; right: 10px; padding: 5px 10px; background-color: #f8d7da; color: #721c24; border-radius: 3px; font-size: 12px; display: none;">
        Firebase yÃ¼kleniyor...
    </div>
    
    <!-- Firebase SDK'larÄ± -->
    <script>
        // Firebase durumunu gÃ¶ster
        document.getElementById('firebase-status').style.display = 'block';
    </script>
    <!-- Firebase SDK - Yerel Dosyalar (Edge Tracking Prevention Ã‡Ã¶zÃ¼mÃ¼) -->
    <script src="firebase-sdk/firebase-app.js"></script>
    <script src="firebase-sdk/firebase-auth.js"></script>
    <script src="firebase-sdk/firebase-firestore.js"></script>
    <script src="./firebase-config.js"></script>
    <script src="./auth.js"></script>
    <script>
        // Firebase durumunu kontrol et
        window.addEventListener('load', function() {
            try {
                if (typeof firebase !== 'undefined' && firebase.app) {
                    document.getElementById('firebase-status').textContent = 'Firebase hazÄ±r';
                    document.getElementById('firebase-status').style.backgroundColor = '#d4edda';
                    document.getElementById('firebase-status').style.color = '#155724';
                    
                    // 3 saniye sonra gÃ¶stergeyi gizle
                    setTimeout(function() {
                        document.getElementById('firebase-status').style.display = 'none';
                    }, 3000);
                } else {
                    document.getElementById('firebase-status').textContent = 'Firebase yÃ¼klenemedi!';
                }
            } catch (error) {
                document.getElementById('firebase-status').textContent = 'Firebase hatasÄ±: ' + error.message;
            }
        });

        // Splash screen iÅŸlemleri
        document.addEventListener('DOMContentLoaded', function() {
            const splashScreen = document.getElementById('splash-screen');
            const preferencesContainer = document.querySelector('.user-preferences-container');
            const loginContainer = document.querySelector('.login-container');
            const preferencesForm = document.getElementById('user-preferences-form');
            
            // Splash screen'ler iÃ§in akÄ±ÅŸ kontrolÃ¼
            function initSplashScreens() {
                // Splash screen animasyonlarÄ± iÃ§in gerekli CSS sÄ±nÄ±flarÄ±nÄ± uygula
                if (splashScreen) {
                    // Ä°lk ekran logosu iÃ§in animasyonlarÄ± baÅŸlat
                    createSplashParticles();
                    animateCircuitNodes();
                    updateLoaderPercentage();
                }

                // Ä°lk splash ekranÄ± 10 saniye sonra kapatÄ±p doÄŸrudan tercihler ekranÄ±na geÃ§
                setTimeout(function() {
                    splashScreen.classList.add('fade-out');
                    setTimeout(function() {
                        splashScreen.style.display = 'none';
                                preferencesContainer.style.display = 'block';
                            }, 500); // GeÃ§iÅŸ animasyonu iÃ§in sÃ¼re
                }, 10000); // Ä°lk splash screen gÃ¶sterme sÃ¼resi - 10 saniye
            }
            
            // Splash screen akÄ±ÅŸÄ±nÄ± baÅŸlat
            initSplashScreens();
            
            // Gerekli splash screen fonksiyonlarÄ±nÄ± tanÄ±mla
            function createSplashParticles() {
                const container = document.querySelector('.splash-bg-particles');
                if (!container) return;
                const colors = [
                    'rgba(58,141,222,0.1)',
                    'rgba(123,31,162,0.1)',
                    'rgba(0,234,255,0.1)',
                    'rgba(255,255,255,0.1)'
                ];
                const count = 18;
                container.innerHTML = '';
                for (let i = 0; i < count; i++) {
                    const p = document.createElement('div');
                    p.className = 'particle';
                    const size = Math.random() * 60 + 40;
                    p.style.width = `${size}px`;
                    p.style.height = `${size}px`;
                    p.style.left = `${Math.random() * 95}%`;
                    p.style.top = `${Math.random() * 90}%`;
                    p.style.background = colors[Math.floor(Math.random() * colors.length)];
                    p.style.animationDelay = `${Math.random() * 8}s`;
                    p.style.animationDuration = `${10 + Math.random() * 6}s`;
                    container.appendChild(p);
                }
            }

            function animateCircuitNodes() {
                const nodes = document.querySelectorAll('.circuit-node');
                nodes.forEach((node, index) => {
                    node.style.setProperty('--i', index);
                });
            }

            function updateLoaderPercentage() {
                const bar = document.querySelector('.splash-loader-bar');
                const percent = document.querySelector('.loader-percentage');
                let progress = 0;
                const duration = 9500; // ms - 10 saniyeye uygun olarak ayarlandÄ±
                const interval = 20;
                const steps = duration / interval;
                const increment = 100 / steps;
                const timer = setInterval(() => {
                    progress += increment;
                    if (progress >= 100) {
                        progress = 100;
                        clearInterval(timer);
                    }
                    percent.textContent = `%${Math.round(progress)}`;
                    bar.style.width = `${2.88 * progress}px`;
                }, interval);
            }
            
            // KullanÄ±cÄ± tercihlerini kaydetme fonksiyonu
            function saveUserPreferences() {
                console.log('saveUserPreferences fonksiyonu baÅŸladÄ±');
                const language = document.getElementById('user-language').value;
                const ageGroup = document.getElementById('user-age').value;
                const difficulty = document.getElementById('difficulty-preference').value;
                
                // Tercihleri localStorage'a kaydet
                localStorage.setItem('user_language', language);
                localStorage.setItem('user_age_group', ageGroup);
                localStorage.setItem('difficulty_preference', difficulty);
                
                // Otomatik zorluk ayarÄ± ise yaÅŸa gÃ¶re zorluk belirle
                if (difficulty === 'auto') {
                    let calculatedDifficulty = 'medium'; // varsayÄ±lan
                    
                    if (ageGroup === 'child') {
                        calculatedDifficulty = 'easy';
                    } else if (ageGroup === 'teen') {
                        calculatedDifficulty = 'medium';
                    } else if (ageGroup === 'adult') {
                        calculatedDifficulty = 'hard';
                    }
                    
                    localStorage.setItem('calculated_difficulty', calculatedDifficulty);
                }
                
                // Dil tercihini HTML etiketlerine hemen uygula
                document.documentElement.setAttribute('lang', language);
                document.documentElement.setAttribute('data-language', language);
                
                // Sayfadaki metinleri hemen deÄŸiÅŸtir
                applyLanguageToUI(language);
                
                console.log(`Tercihler kaydedildi: Dil=${language}, YaÅŸ Grubu=${ageGroup}, Zorluk=${difficulty}`);
                
                // Tercihler ekranÄ±nÄ± kapat ve login ekranÄ±nÄ± gÃ¶ster
                console.log('Ekran geÃ§iÅŸi yapÄ±lÄ±yor...');
                const currentPreferencesContainer = document.querySelector('.user-preferences-container');
                const currentLoginContainer = document.querySelector('.login-container');
                
                console.log('Preferences container:', currentPreferencesContainer);
                console.log('Login container:', currentLoginContainer);
                
                if (currentPreferencesContainer) {
                    console.log('Preferences container gizleniyor...');
                    currentPreferencesContainer.classList.add('hidden');
                } else {
                    console.error('Preferences container bulunamadÄ±!');
                }
                
                if (currentLoginContainer) {
                    console.log('Login container gÃ¶steriliyor...');
                    currentLoginContainer.style.visibility = 'visible';
                    currentLoginContainer.style.display = 'block';
                    currentLoginContainer.classList.add('fade-in');
                } else {
                    console.error('Login container bulunamadÄ±!');
                }
                
                console.log('Ekran geÃ§iÅŸi tamamlandÄ±');
            }
            
            // ArayÃ¼z dilini anÄ±nda deÄŸiÅŸtir
            function applyLanguageToUI(language) {
                // Dil Ã§evirilerini tanÄ±mla
                const translations = {
                    'tr': {
                        'pageTitle': 'Bilgoo - KullanÄ±cÄ± GiriÅŸi',
                        'gameTitle': 'Bilgoo',
                        'preferences': 'Tercihlerinizi AyarlayÄ±n',
                        'preferencesDesc': 'Oyun deneyiminizi kiÅŸiselleÅŸtirmek iÃ§in lÃ¼tfen aÅŸaÄŸÄ±daki tercihleri ayarlayÄ±n. Bu tercihler, sizin iÃ§in uygun zorlukta ve dilde sorularÄ±n hazÄ±rlanmasÄ±nÄ± saÄŸlayacaktÄ±r.',
                        'langLabel': 'Tercih ettiÄŸiniz dil',
                        'ageLabel': 'YaÅŸ AralÄ±ÄŸÄ±nÄ±z',
                        'difficultyLabel': 'Zorluk Seviyesi',
                        'continueBtn': 'Devam Et',
                        'prefNote': 'Bu ayarlarÄ± daha sonra oyun iÃ§erisindeki ayarlar menÃ¼sÃ¼nden deÄŸiÅŸtirebilirsiniz.',
                        'loginTitle': 'GiriÅŸ Yap',
                        'emailLabel': 'E-posta',
                        'passwordLabel': 'Åžifre',
                        'loginBtn': 'GiriÅŸ Yap',
                        'noAccount': 'HesabÄ±nÄ±z yok mu?',
                        'registerLink': 'KayÄ±t Ol',
                        'guestLogin': 'Misafir olarak devam et',
                        'registerTitle': 'KayÄ±t Ol',
                        'usernameLabel': 'KullanÄ±cÄ± AdÄ±',
                        'confirmPassword': 'Åžifre Tekrar',
                        'registerBtn': 'KayÄ±t Ol',
                        'haveAccount': 'Zaten hesabÄ±nÄ±z var mÄ±?',
                        'auto': 'Otomatik (YaÅŸa gÃ¶re ayarla)',
                        'easy': 'Kolay',
                        'medium': 'Orta',
                        'hard': 'Zor',
                        'child': 'Ã‡ocuk (7-12)',
                        'teen': 'GenÃ§ (13-17)',
                        'adult': 'YetiÅŸkin (18+)'
                    },
                    'en': {
                        'pageTitle': 'Quiz Game - User Login',
                        'gameTitle': 'Quiz Game',
                        'preferences': 'Set Your Preferences',
                        'preferencesDesc': 'Please set the following preferences to customize your game experience. These preferences will ensure that questions are prepared in the appropriate difficulty and language for you.',
                        'langLabel': 'Preferred language',
                        'ageLabel': 'Age Range',
                        'difficultyLabel': 'Difficulty Level',
                        'continueBtn': 'Continue',
                        'prefNote': 'You can change these settings later from the settings menu in the game.',
                        'loginTitle': 'Login',
                        'emailLabel': 'Email',
                        'passwordLabel': 'Password',
                        'loginBtn': 'Login',
                        'noAccount': 'Don\'t have an account?',
                        'registerLink': 'Register',
                        'guestLogin': 'Continue as guest',
                        'registerTitle': 'Register',
                        'usernameLabel': 'Username',
                        'confirmPassword': 'Confirm Password',
                        'registerBtn': 'Register',
                        'haveAccount': 'Already have an account?',
                        'auto': 'Automatic (Adjust based on age)',
                        'easy': 'Easy',
                        'medium': 'Medium',
                        'hard': 'Hard',
                        'child': 'Child (7-12)',
                        'teen': 'Teen (13-17)',
                        'adult': 'Adult (18+)'
                    },
                    'de': {
                        'pageTitle': 'Quiz-Spiel - Benutzeranmeldung',
                        'gameTitle': 'Quiz-Spiel',
                        'preferences': 'Stellen Sie Ihre PrÃ¤ferenzen ein',
                        'preferencesDesc': 'Bitte legen Sie die folgenden PrÃ¤ferenzen fest, um Ihr Spielerlebnis anzupassen. Diese Einstellungen stellen sicher, dass Fragen in der fÃ¼r Sie geeigneten Schwierigkeit und Sprache vorbereitet werden.',
                        'langLabel': 'Bevorzugte Sprache',
                        'ageLabel': 'Altersbereich',
                        'difficultyLabel': 'Schwierigkeitsgrad',
                        'continueBtn': 'Fortfahren',
                        'prefNote': 'Sie kÃ¶nnen diese Einstellungen spÃ¤ter im EinstellungsmenÃ¼ des Spiels Ã¤ndern.',
                        'loginTitle': 'Anmelden',
                        'emailLabel': 'E-Mail',
                        'passwordLabel': 'Passwort',
                        'loginBtn': 'Anmelden',
                        'noAccount': 'Haben Sie kein Konto?',
                        'registerLink': 'Registrieren',
                        'guestLogin': 'Als Gast fortfahren',
                        'registerTitle': 'Registrieren',
                        'usernameLabel': 'Benutzername',
                        'confirmPassword': 'Passwort bestÃ¤tigen',
                        'registerBtn': 'Registrieren',
                        'haveAccount': 'Haben Sie bereits ein Konto?',
                        'auto': 'Automatisch (Nach Alter anpassen)',
                        'easy': 'Leicht',
                        'medium': 'Mittel',
                        'hard': 'Schwer',
                        'child': 'Kind (7-12)',
                        'teen': 'Jugendlicher (13-17)',
                        'adult': 'Erwachsener (18+)'
                    }
                };
                
                // SeÃ§ilen dile gÃ¶re metinleri gÃ¼ncelle
                const langData = translations[language] || translations['tr'];
                
                // Sayfa baÅŸlÄ±ÄŸÄ±nÄ± gÃ¼ncelle
                document.title = langData.pageTitle;
                
                // Tercihler ekranÄ± - h1 logosu artÄ±k SVG olduÄŸu iÃ§in bu satÄ±rÄ± kaldÄ±rÄ±yoruz
                // document.querySelector('h1').textContent = langData.gameTitle;
                const preferencesTitle = document.querySelector('#preferences-box h2');
                if (preferencesTitle) preferencesTitle.textContent = langData.preferences;
                
                const preferencesDesc = document.querySelector('.preferences-description');
                if (preferencesDesc) preferencesDesc.textContent = langData.preferencesDesc;
                
                // Form etiketleri
                document.querySelector('label[for="user-language"]').innerHTML = `<i class="fas fa-language"></i> ${langData.langLabel}`;
                document.querySelector('label[for="user-age"]').innerHTML = `<i class="fas fa-user-clock"></i> ${langData.ageLabel}`;
                document.querySelector('label[for="difficulty-preference"]').innerHTML = `<i class="fas fa-sliders-h"></i> ${langData.difficultyLabel}`;
                
                // SeÃ§enek metinlerini gÃ¼ncelle (select options)
                const ageSelect = document.getElementById('user-age');
                for (let i = 0; i < ageSelect.options.length; i++) {
                    const option = ageSelect.options[i];
                    if (option.value === 'child') option.textContent = langData.child;
                    if (option.value === 'teen') option.textContent = langData.teen;
                    if (option.value === 'adult') option.textContent = langData.adult;
                }
                
                const diffSelect = document.getElementById('difficulty-preference');
                for (let i = 0; i < diffSelect.options.length; i++) {
                    const option = diffSelect.options[i];
                    if (option.value === 'auto') option.textContent = langData.auto;
                    if (option.value === 'easy') option.textContent = langData.easy;
                    if (option.value === 'medium') option.textContent = langData.medium;
                    if (option.value === 'hard') option.textContent = langData.hard;
                }
                
                // Buton ve diÄŸer metinler
                document.getElementById('save-preferences').textContent = langData.continueBtn;
                document.querySelector('.preferences-note').innerHTML = `<i class="fas fa-info-circle"></i> ${langData.prefNote}`;
                
                // Login ve kayÄ±t formlarÄ± (eÄŸer gÃ¶rÃ¼nÃ¼rse)
                const loginTitle = document.querySelector('#login-box h2');
                if (loginTitle) loginTitle.textContent = langData.loginTitle;
                
                const registerTitle = document.querySelector('#register-box h2');
                if (registerTitle) registerTitle.textContent = langData.registerTitle;
                
                // Login formu elementleri
                const loginEmailLabel = document.querySelector('label[for="login-email"]');
                if (loginEmailLabel) loginEmailLabel.innerHTML = `<i class="fas fa-envelope"></i> ${langData.emailLabel}`;
                
                const loginPasswordLabel = document.querySelector('label[for="login-password"]');
                if (loginPasswordLabel) loginPasswordLabel.innerHTML = `<i class="fas fa-lock"></i> ${langData.passwordLabel}`;
                
                const loginButton = document.querySelector('#login-form button');
                if (loginButton) loginButton.textContent = langData.loginBtn;
                
                // Login baÄŸlantÄ±larÄ±
                const noAccountText = document.querySelector('#login-box .auth-options p:first-child');
                if (noAccountText) {
                    const registerLink = noAccountText.querySelector('a');
                    noAccountText.innerHTML = `${langData.noAccount} <a href="#" id="show-register">${langData.registerLink}</a>`;
                    
                    // Event listener'Ä± tekrar ekle
                    document.getElementById('show-register').addEventListener('click', function(e) {
                        e.preventDefault();
                        document.getElementById('login-box').style.display = 'none';
                        document.getElementById('register-box').style.display = 'block';
                    });
                }
                
                const guestLoginLink = document.querySelector('#anonymous-login');
                if (guestLoginLink) guestLoginLink.textContent = langData.guestLogin;
                
                // KayÄ±t formu elementleri
                const usernameLabel = document.querySelector('label[for="register-username"]');
                if (usernameLabel) usernameLabel.innerHTML = `<i class="fas fa-user"></i> ${langData.usernameLabel}`;
                
                const registerEmailLabel = document.querySelector('label[for="register-email"]');
                if (registerEmailLabel) registerEmailLabel.innerHTML = `<i class="fas fa-envelope"></i> ${langData.emailLabel}`;
                
                const registerPasswordLabel = document.querySelector('label[for="register-password"]');
                if (registerPasswordLabel) registerPasswordLabel.innerHTML = `<i class="fas fa-lock"></i> ${langData.passwordLabel}`;
                
                const confirmPasswordLabel = document.querySelector('label[for="register-password-confirm"]');
                if (confirmPasswordLabel) confirmPasswordLabel.innerHTML = `<i class="fas fa-lock"></i> ${langData.confirmPassword}`;
                
                const registerButton = document.querySelector('#register-form button');
                if (registerButton) registerButton.textContent = langData.registerBtn;
                
                // KayÄ±t baÄŸlantÄ±larÄ±
                const haveAccountText = document.querySelector('#register-box .auth-options p');
                if (haveAccountText) {
                    const loginLink = haveAccountText.querySelector('a');
                    haveAccountText.innerHTML = `${langData.haveAccount} <a href="#" id="show-login">${langData.loginTitle}</a>`;
                    
                    // Event listener'Ä± tekrar ekle
                    document.getElementById('show-login').addEventListener('click', function(e) {
                        e.preventDefault();
                        document.getElementById('register-box').style.display = 'none';
                        document.getElementById('login-box').style.display = 'block';
                    });
                }
            }
            
            // Select deÄŸiÅŸtiÄŸinde dili anÄ±nda gÃ¼ncelle
            document.getElementById('user-language').addEventListener('change', function() {
                const selectedLanguage = this.value;
                document.documentElement.setAttribute('lang', selectedLanguage);
                document.documentElement.setAttribute('data-language', selectedLanguage);
                applyLanguageToUI(selectedLanguage);
            });
            
            // YaÅŸ seÃ§imi deÄŸiÅŸtiÄŸinde, otomatik zorluk seÃ§ilmiÅŸse zorluÄŸu gÃ¼ncelle
            document.getElementById('user-age').addEventListener('change', function() {
                const difficultySelect = document.getElementById('difficulty-preference');
                if (difficultySelect.value === 'auto') {
                    // Bilgilendirme mesajÄ± gÃ¶ster
                    const language = document.getElementById('user-language').value;
                    const messages = {
                        'tr': 'Zorluk seviyesi yaÅŸÄ±nÄ±za gÃ¶re otomatik ayarlanacaktÄ±r.',
                        'en': 'Difficulty level will be automatically adjusted based on your age.',
                        'de': 'Der Schwierigkeitsgrad wird automatisch an Ihr Alter angepasst.'
                    };
                    const message = messages[language] || messages['tr'];
                    
                    // Flash mesajÄ± gÃ¶ster
                    const flashMsg = document.createElement('div');
                    flashMsg.className = 'flash-message';
                    flashMsg.textContent = message;
                    flashMsg.style.position = 'fixed';
                    flashMsg.style.bottom = '20px';
                    flashMsg.style.left = '50%';
                    flashMsg.style.transform = 'translateX(-50%)';
                    flashMsg.style.padding = '10px 20px';
                    flashMsg.style.backgroundColor = 'rgba(74, 20, 140, 0.8)';
                    flashMsg.style.color = 'white';
                    flashMsg.style.borderRadius = '5px';
                    flashMsg.style.zIndex = '1000';
                    
                    document.body.appendChild(flashMsg);
                    
                    setTimeout(() => {
                        flashMsg.style.opacity = '0';
                        flashMsg.style.transition = 'opacity 0.5s';
                        
                        setTimeout(() => {
                            document.body.removeChild(flashMsg);
                        }, 500);
                    }, 3000);
                }
            });
            
            // Preferences form submit iÅŸlemi
            if (preferencesForm) {
                console.log('Preferences form bulundu, event listener ekleniyor...');
                preferencesForm.addEventListener('submit', function(e) {
                    console.log('Form submit event tetiklendi!');
                    e.preventDefault();
                    console.log('Tercihler kaydediliyor...');
                    saveUserPreferences();
                });
            } else {
                console.error('Preferences form bulunamadÄ±!');
            }
            
            // Devam Et butonuna da direkt click event ekleyelim
            const saveBtn = document.getElementById('save-preferences');
            if (saveBtn) {
                console.log('Devam Et butonu bulundu, click event ekleniyor...');
                saveBtn.addEventListener('click', function(e) {
                    console.log('Devam Et butonuna tÄ±klandÄ±!');
                    // Form submit olup olmadÄ±ÄŸÄ±nÄ± kontrol et
                    if (e.target.form) {
                        console.log('Buton bir formun iÃ§inde, form submit tetiklenecek');
                    } else {
                        console.log('Buton form dÄ±ÅŸÄ±nda, manuel kaydetme...');
                        e.preventDefault();
                        saveUserPreferences();
                    }
                });
                                } else {
                console.error('Devam Et butonu bulunamadÄ±!');
            }
        });
    </script>
</body>
</html> 