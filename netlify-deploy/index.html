<!DOCTYPE html>
<html lang="tr" data-theme="light" data-language="tr" id="html-root">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="Ücretsiz Türkçe bilgi yarışması! Genel kültür, bilim, tarih ve daha fazla kategoride binlerce soru. Arkadaşlarınla yarış, lider tablosunda yerini al. Hemen oyna!">
    <meta name="keywords" content="bilgi yarışması, quiz, test, genel kültür, eğitim, oyun, türkçe, online, ücretsiz">
    <meta name="author" content="Teknova Bilişim">
    <meta name="robots" content="index, follow">
    <meta name="language" content="Turkish">
    <meta name="theme-color" content="#3b82f6">
    
    <!-- Google AdSense Kodu -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7610338885240453"
     crossorigin="anonymous"></script>
    
    <!-- PWA Meta Tags -->
    <meta name="application-name" content="Quiz Oyunu">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Quiz Oyunu">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-TileColor" content="#3b82f6">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- Tam Ekran PWA Ayarları -->
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-orientations" content="portrait">
    <meta name="screen-orientation" content="portrait">
    <meta name="x5-orientation" content="portrait">
    <meta name="x5-fullscreen" content="true">
    <meta name="x5-page-mode" content="app">
    <meta name="browsermode" content="application">
    <meta name="full-screen" content="yes">
    <meta name="x5-browsermode" content="app">
    
    <!-- PWA İkonları -->
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/icon-192x192.png">
    <link rel="mask-icon" href="icons/icon-192x192.png" color="#3b82f6">
    <link rel="shortcut icon" href="icons/icon-192x192.png">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourdomain.com/">
    <meta property="og:title" content="Bilgoo - Ücretsiz Online Quiz">
    <meta property="og:description" content="Binlerce soruda bilginizi test edin! Arkadaşlarınızla yarışın ve lider tablosunda yerini alın.">
    <meta property="og:image" content="https://yourdomain.com/og-image.jpg">
    <meta property="og:site_name" content="Bilgoo">
    <meta property="og:locale" content="tr_TR">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://yourdomain.com/">
    <meta property="twitter:title" content="Bilgoo - Ücretsiz Online Quiz">
    <meta property="twitter:description" content="Binlerce soruda bilginizi test edin! Arkadaşlarınızla yarışın ve lider tablosunda yerini alın.">
    <meta property="twitter:image" content="https://yourdomain.com/og-image.jpg">
    
    <!-- Schema.org -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Game",
        "name": "Bilgoo",
        "description": "Ücretsiz Türkçe bilgi yarışması oyunu",
        "url": "https://yourdomain.com",
        "applicationCategory": "Game",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "TRY"
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "ratingCount": "1250"
        }
    }
    </script>
    
    <title>Bilgoo - Ücretsiz Online Quiz Oyunu | Test Bilginizi</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css?v=2.9">
    <link rel="stylesheet" href="statistics.css">
    <!-- Font Awesome İkonları -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <!-- Görsel içeren sorular ve Doğru/Yanlış soruları için stil -->
    <link rel="stylesheet" href="custom-question-styles.css">
    <link rel="stylesheet" href="admin-pending-styles.css">
    <!-- Manifest linki direkt olarak ekle -->
    <link rel="manifest" href="manifest.json">
    <style>
        /* Genel stil */
        :root {
            --primary-color: #4a148c;
            --secondary-color: #e91e63;
            --accent-color: #ff9800;
            --text-color: #333;
            --bg-color: #f9f9f9;
            --error-color: #e53935;
            --success-color: #43a047;
            --border-radius: 8px;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            --header-bg: #333;
            --header-text: #fff;
        }

        [data-theme="dark"] {
            --primary-color: #9c27b0;
            --secondary-color: #ff4081;
            --accent-color: #ffb74d;
            --text-color: #f5f5f5;
            --bg-color: #212121;
            --error-color: #e57373;
            --success-color: #81c784;
            --header-bg: #121212;
            --header-text: #f5f5f5;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ... existing styles ... */
        
        /* Profil sayfası stilleri */
        .profile-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .profile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }

        .profile-card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
        }

        .profile-avatar {
            font-size: 48px;
            color: var(--primary-color);
            margin-right: 20px;
            flex: 0 0 80px;
            text-align: center;
        }

        .profile-details {
            flex: 1;
            min-width: 200px;
        }

        .profile-details h2 {
            margin-top: 0;
            color: var(--primary-color);
        }

        .profile-actions-secondary {
            flex: 1 0 100%;
            margin-top: 15px;
            text-align: right;
        }

        .stats-card, .high-scores-card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
        }

        .stat-item {
            text-align: center;
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
            display: block;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
        }

        .high-scores-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .high-scores-table th, .high-scores-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .high-scores-table th {
            background-color: #f5f5f5;
        }

        .profile-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        /* Yükleniyor göstergesi */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-spinner {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .loading-spinner i {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        /* Hata mesajı konteyner */
        .error-container {
            max-width: 500px;
            margin: 100px auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .error-container h3 {
            color: var(--error-color);
            margin-top: 0;
        }

        .error-container i {
            font-size: 28px;
            margin-right: 10px;
        }

        .error-container p {
            margin-bottom: 20px;
        }

        .error-container button {
            margin: 5px;
            min-width: 120px;
        }

        /* Buton stilleri */
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .btn-primary:hover {
            background-color: #7b1fa2;
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .btn-secondary:hover {
            background-color: #c2185b;
        }

        .btn-danger {
            background-color: var(--error-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .btn-danger:hover {
            background-color: #c62828;
        }

        /* Üst bilgi çubuğu (Kullanıcı bilgisi) */
        .user-info-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #333;
            color: white;
            padding: 10px 20px;
            margin-bottom: 20px;
        }

        .user-info {
            display: flex;
            align-items: center;
        }

        .user-info i {
            margin-right: 10px;
            font-size: 18px;
        }

        .user-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            background-color: transparent;
            border: 1px solid white;
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .btn-small:hover {
            background-color: white;
            color: #333;
        }

        /* Karanlık mod ayarları */
        [data-theme="dark"] .profile-card,
        [data-theme="dark"] .stats-card,
        [data-theme="dark"] .high-scores-card,
        [data-theme="dark"] .loading-spinner,
        [data-theme="dark"] .error-container {
            background-color: #333;
            color: #f5f5f5;
        }

        [data-theme="dark"] .stat-item {
            background-color: #444;
        }

        [data-theme="dark"] .high-scores-table th {
            background-color: #444;
        }

        [data-theme="dark"] .high-scores-table td {
            border-bottom: 1px solid #444;
        }

        /* Responsivite için medya sorguları */
        @media (max-width: 600px) {
            .profile-card {
                flex-direction: column;
                text-align: center;
            }

            .profile-avatar {
                margin-right: 0;
                margin-bottom: 15px;
            }

            .user-info-bar {
                flex-direction: column;
                gap: 10px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* ... other existing styles ... */

        /* Hamburger menü stilleri - Bottom Sheet tasarım */
        .hamburger-menu {
            position: fixed;
            bottom: -100%;
            left: 0;
            right: 0;
            width: 100%;
            height: 70vh;
            max-height: 500px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            backdrop-filter: blur(20px);
            color: white;
            box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            overflow-y: auto;
            padding: 0;
            border-top: 3px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px 20px 0 0;
        }

        .hamburger-menu.active {
            bottom: 0;
        }

        /* Desktop için yan panel */
        @media (min-width: 769px) {
            .hamburger-menu {
                top: 0;
                right: -350px;
                bottom: 0;
                left: auto;
                width: 350px;
                height: 100vh;
                min-height: 100vh;
                max-height: 100vh;
                border-radius: 0;
                border-top: none;
                border-left: 3px solid rgba(255, 255, 255, 0.2);
                display: flex;
                flex-direction: column;
            }

            .hamburger-menu.active {
                right: 0;
                bottom: 0;
            }
            
            /* Desktop'ta menü handle'ı gizle */
            .hamburger-menu .menu-handle {
                display: none;
            }
            
            /* Desktop'ta menü içeriğinin tüm alanı kapsaması */
            .hamburger-menu .menu-section {
                flex: 1;
                display: flex;
                flex-direction: column;
            }
        }

        /* Bottom sheet handle (yukarı çekme çubuğu) */
        .menu-handle {
            width: 40px;
            height: 4px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 2px;
            margin: 10px auto 20px auto;
            cursor: pointer;
        }

        /* Mobil Tab Bar Stilleri */
        .mobile-tab-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            backdrop-filter: blur(20px);
            height: 70px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 999;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
        }
        
        /* Mobilde ayarlar menüsü için özel başlık */
        @media (max-width: 768px) {
            .hamburger-menu .menu-section:nth-of-type(2) h3::before {
                content: "⚙️ ";
                margin-right: 8px;
            }
        }

        .tab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 12px;
            transition: all 0.3s ease;
            min-width: 60px;
        }

        .tab-item i {
            font-size: 20px;
            margin-bottom: 4px;
            transition: all 0.3s ease;
        }

        .tab-item span {
            font-size: 10px;
            font-weight: 500;
            text-align: center;
        }

        .tab-item:hover,
        .tab-item.active {
            color: white;
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .tab-item:hover i,
        .tab-item.active i {
            transform: scale(1.2);
            color: #ff6b6b;
        }

        /* Desktop'ta tab bar gizle */
        @media (min-width: 769px) {
            .mobile-tab-bar {
                display: none;
            }
        }

        /* Mobilde hamburger toggle'ı gizle, tab bar'ı göster */
        @media (max-width: 768px) {
            .hamburger-toggle {
                display: none !important;
            }
            
            .mobile-tab-bar {
                display: flex;
            }
            
            /* Container'a alt boşluk ekle */
            .container {
                padding-bottom: 80px;
            }
            
            /* Mobilde gereksiz menü öğelerini gizle */
            .hamburger-menu #menu-home,
            .hamburger-menu #menu-profile,
            .hamburger-menu #menu-friends,
            .hamburger-menu #menu-admin-panel {
                display: none !important;
            }
            
            /* Uygulama başlığını da gizle */
            .hamburger-menu #menu-app-title {
                display: none !important;
            }
            
            /* Profil bilgisini de gizle mobilde */
            .hamburger-menu .user-profile-section {
                display: none !important;
            }
            
            /* İlk menu section'ı gizle (boş kalacağı için) */
            .hamburger-menu .menu-section:first-of-type {
                display: none !important;
            }
            
            /* Zorluk bilgisini gizle mobilde (yer kaplıyor) */
            .hamburger-menu .menu-item[style*="flex-direction: column"] {
                display: none !important;
            }
            
            /* Mobilde menü sabit boyut - kaydırma yok */
            .hamburger-menu {
                height: 280px !important;
                max-height: 280px !important;
                min-height: 280px !important;
                overflow: hidden !important;
            }
            
            /* İçerik taşmasını önle - orta boyut padding */
            .hamburger-menu .menu-section {
                padding: 12px 20px !important;
                margin: 0 !important;
            }
            
            /* Handle için orta boşluk */
            .hamburger-menu .menu-handle {
                margin: 8px auto 12px auto !important;
                width: 40px !important;
                height: 4px !important;
            }
            
            /* Yazı boyutlarını orta büyüklükte yap */
            .hamburger-menu .menu-item {
                padding: 8px 15px !important;
                margin: 5px 0 !important;
                font-size: 15px !important;
                min-height: auto !important;
                line-height: 1.3 !important;
            }
            
            .hamburger-menu .menu-section h3 {
                font-size: 13px !important;
                margin: 0 0 10px 0 !important;
                padding-bottom: 5px !important;
                line-height: 1.2 !important;
            }
            
            /* Toggle switch'leri orta boyut */
            .hamburger-menu .toggle-switch,
            .hamburger-menu .theme-switch-wrapper {
                transform: scale(0.9) !important;
                margin-left: auto !important;
            }
            
            /* Tema switch içindeki icon'ları orta boyut */
            .hamburger-menu .theme-switch .slider i {
                font-size: 10px !important;
            }
            
            /* Icon'ları orta boyut */
            .hamburger-menu .menu-item i {
                font-size: 16px !important;
                margin-right: 12px !important;
                width: 18px !important;
            }
            
            /* Çıkış bölümü için özel ayar */
            .hamburger-menu .menu-section:last-of-type {
                border-top: 1px solid rgba(255, 107, 107, 0.3) !important;
                margin-top: 10px !important;
                padding-top: 10px !important;
            }
            
            /* Çıkış bölümünü mobilde göster */
            .hamburger-menu .menu-section:last-of-type {
                display: block !important;
                border-top: 2px solid rgba(255, 107, 107, 0.3);
                margin-top: 15px;
            }
            
            /* Çıkış butonu özel stil mobilde - orta boyut */
            .hamburger-menu #menu-logout {
                background: rgba(255, 107, 107, 0.1);
                border: 1px solid rgba(255, 107, 107, 0.3);
                color: #ff6b6b !important;
                border-radius: 8px !important;
                padding: 8px 15px !important;
                font-size: 15px !important;
            }
            
            .hamburger-menu #menu-logout:hover {
                background: rgba(255, 107, 107, 0.2) !important;
                color: white !important;
            }
            
            .hamburger-menu #menu-logout i {
                color: #ff6b6b !important;
                font-size: 16px !important;
            }
        }

        .hamburger-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            cursor: pointer;
            z-index: 1001;
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.3);
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .hamburger-toggle:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 12px 30px rgba(255, 107, 107, 0.5);
            background: linear-gradient(135deg, #ff5252, #d32f2f);
        }

        .hamburger-toggle i {
            font-size: 18px;
            transition: transform 0.3s ease;
        }

        .hamburger-toggle:hover i {
            transform: rotate(90deg);
        }

        .menu-section {
            padding: 20px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.15);
            position: relative;
        }

        .menu-section::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, #ff6b6b, #ee5a24);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .menu-section:hover::before {
            opacity: 1;
        }

        .menu-section h3 {
            margin: 0 0 15px 0;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 600;
            position: relative;
            padding-bottom: 8px;
        }

        .menu-section h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 30px;
            height: 2px;
            background: linear-gradient(to right, #ff6b6b, #ee5a24);
            border-radius: 1px;
        }

        .menu-item {
            padding: 12px 15px;
            display: flex;
            align-items: center;
            cursor: pointer;
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            border-radius: 10px;
            margin: 5px 0;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .menu-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 0;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            transition: width 0.3s ease;
            z-index: -1;
        }

        .menu-item:hover::before {
            width: 100%;
        }

        .menu-item i {
            margin-right: 15px;
            width: 20px;
            text-align: center;
            font-size: 16px;
            color: #ff6b6b;
            transition: all 0.3s ease;
        }

        .menu-item:hover {
            color: white;
            transform: translateX(5px);
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .menu-item:hover i {
            color: #ffffff;
            transform: scale(1.2);
        }

        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
        }

        .menu-overlay.active {
            display: block;
        }

        /* Düzen ayarlamaları */
        body {
            padding-top: 20px; /* Hamburger toggle için alan */
        }



        .hamburger-menu .toggle-switch {
            margin-left: auto;
        }

        .user-profile-section {
            display: flex;
            align-items: center;
            padding: 25px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
            backdrop-filter: blur(10px);
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 10px;
        }

        .user-avatar {
            font-size: 32px;
            margin-right: 15px;
            color: #ff6b6b;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 50%;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.2);
        }

        .user-info-menu {
            flex: 1;
        }

        .user-info-menu p {
            margin: 0;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }

        .user-info-menu .user-name {
            font-weight: 600;
            font-size: 18px;
            color: white;
            margin-bottom: 5px;
        }

        /* Responsive ayarlamalar */
        @media (max-width: 600px) {
            .hamburger-menu {
                width: 80%;
                max-width: 300px;
            }
        }

        /* Boşluk doldurma harfleri görünürlük düzeltmesi */
        .blank-filling-container .letters-container {
            display: flex !important;
            flex-wrap: wrap !important;
            justify-content: center !important;
            visibility: visible !important;
            opacity: 1 !important;
            position: relative !important;
            z-index: 10 !important;
        }

        .tab-button.active {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            background: rgba(0,0,0,0.01);
        }

        /* Toggle switch stillerini güncelleme */
        input:checked + .slider {
            background-color: var(--primary-color);
        }

        /* Dil değiştirici için stiller */
        .language-selector {
            display: flex;
            align-items: center;
            margin-left: auto;
            margin-right: 15px;
        }
        
        .language-selector label {
            margin-right: 5px;
            color: var(--header-text);
            font-size: 14px;
        }
        
        .language-selector select {
            background-color: transparent;
            border: 1px solid rgba(255,255,255,0.3);
            color: var(--header-text);
            padding: 3px 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .language-selector select:hover {
            background-color: rgba(255,255,255,0.1);
        }
        
        .language-selector select option {
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        /* Reklam Alanları */
        .ad-banner {
            margin: 0 0 10px 0; /* Üstteki margin kaldırıldı, sadece altta bırakıldı */
            min-height: 50px;
            text-align: center;
            background: #f5f5f5;
            border-radius: 8px;
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .interstitial-ad {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10000;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        /* Cookie Consent Stilleri */
        .cookie-consent {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            z-index: 10000;
            border-top: 3px solid rgba(255,255,255,0.2);
        }

        .cookie-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 20px;
        }

        .cookie-text h3 {
            margin: 0 0 10px 0;
            font-size: 18px;
        }

        .cookie-text p {
            margin: 0;
            font-size: 14px;
            line-height: 1.4;
        }

        .cookie-text a {
            color: #ffd700;
            text-decoration: underline;
        }

        .cookie-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .cookie-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .cookie-btn-primary {
            background: #ff6b6b;
            color: white;
        }

        .cookie-btn-primary:hover {
            background: #ff5252;
            transform: translateY(-2px);
        }

        .cookie-btn-secondary {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .cookie-btn-secondary:hover {
            background: rgba(255,255,255,0.3);
        }

        .cookie-btn-link {
            background: transparent;
            color: #ffd700;
            text-decoration: underline;
        }

        /* Cookie Modal */
        .cookie-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 10001;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cookie-modal-content {
            background: white;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .cookie-modal-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cookie-modal-header h3 {
            margin: 0;
            color: var(--primary-color);
        }

        .cookie-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .cookie-modal-body {
            padding: 20px;
        }

        .cookie-category {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #eee;
            border-radius: 8px;
        }

        .cookie-toggle {
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .cookie-toggle input[type="checkbox"] {
            display: none;
        }

        .cookie-slider {
            width: 50px;
            height: 25px;
            background: #ccc;
            border-radius: 25px;
            position: relative;
            margin-right: 15px;
            transition: all 0.3s ease;
        }

        .cookie-slider:before {
            content: '';
            position: absolute;
            width: 21px;
            height: 21px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: all 0.3s ease;
        }

        .cookie-toggle input:checked + .cookie-slider {
            background: var(--primary-color);
        }

        .cookie-toggle input:checked + .cookie-slider:before {
            transform: translateX(25px);
        }

        .cookie-toggle input:disabled + .cookie-slider {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .cookie-info h4 {
            margin: 0 0 5px 0;
            font-size: 16px;
            color: var(--primary-color);
        }

        .cookie-info p {
            margin: 0;
            font-size: 14px;
            color: #666;
        }

        .cookie-modal-footer {
            padding: 20px;
            border-top: 1px solid #eee;
            text-align: right;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .cookie-content {
                flex-direction: column;
                text-align: center;
            }

            .cookie-buttons {
                justify-content: center;
            }

            .ad-banner {
                margin: 0 0 10px 0; /* Üstteki margin kaldırıldı, sadece altta bırakıldı */
                min-height: 50px;
            }
        }
        
        /* Admin Panel Stilleri */
        .admin-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            overflow-y: auto;
            padding: 20px;
            box-sizing: border-box;
        }

        .admin-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px 10px 0 0;
            margin-bottom: 0;
        }

        .admin-panel-header h2 {
            margin: 0;
            font-size: 24px;
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .admin-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            overflow-x: auto;
        }

        .admin-tab-btn {
            background: none;
            border: none;
            padding: 15px 20px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            color: #6c757d;
            font-weight: 500;
        }

        .admin-tab-btn:hover {
            background: #e9ecef;
            color: #495057;
        }

        .admin-tab-btn.active {
            background: white;
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .admin-content {
            background: white;
            min-height: 70vh;
            padding: 20px;
            border-radius: 0 0 10px 10px;
        }

        .admin-tab-content {
            display: none;
        }

        .admin-tab-content.active {
            display: block;
        }

        .admin-stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .admin-stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .admin-stat-card .stat-icon {
            font-size: 32px;
            margin-bottom: 10px;
            opacity: 0.8;
        }

        .admin-stat-card .stat-value {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 5px;
            color: white;
        }

        .admin-stat-card .stat-label {
            font-size: 14px;
            opacity: 0.9;
            color: white;
        }

        .admin-search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
        }

        .admin-search-box input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .admin-search-box select {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            min-width: 150px;
        }

        .admin-btn-secondary {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .admin-table th {
            background: var(--primary-color);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .admin-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .admin-table tr:hover {
            background: #f8f9fa;
        }

        .admin-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }

        .admin-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .admin-action-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .admin-action-btn:hover {
            background: #7b1fa2;
            transform: translateY(-2px);
        }

        .admin-recent-activity {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
        }

        .admin-recent-activity h3 {
            margin-top: 0;
            color: var(--primary-color);
        }

        .admin-activity-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .admin-tab-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .admin-tab-header h3 {
            margin: 0;
            color: var(--primary-color);
        }

        .admin-filter {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .admin-pending-questions-list,
        .admin-reports-list {
            display: grid;
            gap: 15px;
        }

        .admin-settings-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .admin-settings-section h3 {
            margin-top: 0;
            color: var(--primary-color);
        }

        .admin-setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #dee2e6;
        }

        .admin-setting-item:last-child {
            border-bottom: none;
        }

        .admin-toggle {
            position: relative;
            width: 50px;
            height: 25px;
        }

        .admin-toggle input {
            display: none;
        }

        .admin-toggle-slider {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #ccc;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-toggle-slider:before {
            content: '';
            position: absolute;
            height: 19px;
            width: 19px;
            left: 3px;
            bottom: 3px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .admin-toggle input:checked + .admin-toggle-slider {
            background: var(--primary-color);
        }

        .admin-toggle input:checked + .admin-toggle-slider:before {
            transform: translateX(25px);
        }

        .admin-settings-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .admin-btn-primary {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-btn-primary:hover {
            background: #7b1fa2;
            transform: translateY(-2px);
        }

        /* Karanlık tema desteği */
        [data-theme="dark"] .admin-panel {
            background: rgba(0, 0, 0, 0.95);
        }

        [data-theme="dark"] .admin-content {
            background: #333;
            color: #f5f5f5;
        }

        [data-theme="dark"] .admin-tabs {
            background: #444;
        }

        [data-theme="dark"] .admin-tab-btn {
            color: #ccc;
        }

        [data-theme="dark"] .admin-tab-btn.active {
            background: #333;
            color: white;
        }

        [data-theme="dark"] .admin-table {
            background: #333;
            color: #f5f5f5;
        }

        [data-theme="dark"] .admin-table td {
            border-bottom-color: #555;
        }

        [data-theme="dark"] .admin-table tr:hover {
            background: #444;
        }

        [data-theme="dark"] .admin-settings-section,
        [data-theme="dark"] .admin-recent-activity {
            background: #444;
        }

        /* Responsive admin panel */
        @media (max-width: 768px) {
            .admin-panel {
                padding: 10px;
            }

            .admin-stats-cards {
                grid-template-columns: 1fr;
            }

            .admin-tabs {
                flex-direction: column;
            }

            .admin-search-box {
                flex-direction: column;
            }

            .admin-actions {
                flex-direction: column;
            }

            .admin-table {
                font-size: 12px;
            }

            .admin-table th,
            .admin-table td {
                padding: 8px;
            }
        }

        /* Modal stilleri */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        .modal-content {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            margin: 3% auto;
            padding: 0;
            border: none;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            position: relative;
            animation: slideIn 0.4s ease-out;
            overflow: hidden;
        }

        @keyframes slideIn {
            from { 
                transform: translateY(-50px); 
                opacity: 0; 
            }
            to { 
                transform: translateY(0); 
                opacity: 1; 
            }
        }

        .modal-content h2 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            margin: 0;
            padding: 25px;
            font-size: 24px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            position: relative;
        }

        .modal-content h2::before {
            content: '✨';
            margin-right: 10px;
            font-size: 20px;
        }

        .close {
            position: absolute;
            top: 15px;
            right: 20px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
        }

        .close:hover,
        .close:focus {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
            text-decoration: none;
        }

        #question-form {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2d3748;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-group label::before {
            margin-right: 8px;
        }

        .form-group:nth-child(1) label::before { content: '📋'; }
        .form-group:nth-child(2) label::before { content: '❓'; }
        .form-group:nth-child(3) label::before { content: '📝'; }
        .form-group:nth-child(4) label::before { content: '✅'; }
        .form-group:nth-child(5) label::before { content: '⚡'; }

        .form-group select,
        .form-group textarea,
        .form-group input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            background: white;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            font-family: 'Poppins', sans-serif;
        }

        .form-group select:focus,
        .form-group textarea:focus,
        .form-group input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
            transform: translateY(-2px);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-group input[type="text"] {
            margin-bottom: 12px;
        }

        .form-group input[type="text"]:nth-child(2)::placeholder::before { content: '🅰️ '; }
        .form-group input[type="text"]:nth-child(3)::placeholder::before { content: '🅱️ '; }
        .form-group input[type="text"]:nth-child(4)::placeholder::before { content: '🅾️ '; }
        .form-group input[type="text"]:nth-child(5)::placeholder::before { content: '🔴 '; }

        .submit-button {
            width: 100%;
            padding: 15px 30px;
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 18px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(72,187,120,0.3);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .submit-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(72,187,120,0.4);
            background: linear-gradient(135deg, #38a169, #2f855a);
        }

        .submit-button:active {
            transform: translateY(-1px);
        }

        .submit-button::before {
            content: '✅ ';
            margin-right: 8px;
        }

        /* Responsive modal */
        @media (max-width: 768px) {
            .modal-content {
                width: 95%;
                margin: 10px auto;
                border-radius: 15px;
            }
            
            .modal-content h2 {
                font-size: 20px;
                padding: 20px;
            }
            
            #question-form {
                padding: 20px;
            }
            
            .form-group {
                margin-bottom: 20px;
            }
        }

        /* Loading animation */
        .submit-button.loading {
            position: relative;
            color: transparent;
        }

        .submit-button.loading::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -10px;
            border: 2px solid transparent;
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Başarı mesajı animasyonları */
        @keyframes slideInRight {
            from {
                transform: translateX(300px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(300px);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Sol Yan Reklam Alanı -->
    <div class="side-ad-left" style="position: fixed; top: 50%; transform: translateY(-50%); left: 10px; width: 160px; min-height: 600px; background: rgba(255, 255, 255, 0.9); border-radius: 10px; padding: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);">
        <div style="font-size: 12px; color: #666; margin-bottom: 10px; text-align: center;">Reklam Alanı</div>
        <!-- Google AdSense Yan Panel Reklam -->
        <ins class="adsbygoogle"
             style="display:block; min-height: 600px; width: 160px;"
             data-ad-client="ca-pub-7610338885240453"
             data-ad-slot="3489961712"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    
    <style>
    /* Mobil Cihazlar için Reklam Stilleri */
    @media (max-width: 768px) {
        .side-ad-left, 
        .side-ad-right {
            display: none !important;
        }
        
        /* Dark mode için */
        [data-theme="dark"] .side-ad-left,
        [data-theme="dark"] .side-ad-right {
            display: none !important;
        }
    }
    </style>
    
    <!-- Sağ Yan Reklam Alanı -->
    <div class="side-ad-right" style="position: fixed; top: 50%; transform: translateY(-50%); right: 10px; width: 160px; min-height: 600px; background: rgba(255, 255, 255, 0.9); border-radius: 10px; padding: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);">
        <div style="font-size: 12px; color: #666; margin-bottom: 10px; text-align: center;">Reklam Alanı</div>
        <!-- Google AdSense Yan Panel Reklam -->
        <ins class="adsbygoogle"
             style="display:block; min-height: 600px; width: 160px;"
             data-ad-client="ca-pub-7610338885240453"
             data-ad-slot="3489961712"
             data-ad-format="vertical"
             data-full-width-responsive="false"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    <!-- Ana İçerik -->
    <!-- Ses efektleri için audio elementleri -->
    <audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/951/951.wav" preload="auto"></audio>
    <audio id="sound-wrong" src="https://assets.mixkit.co/active_storage/sfx/1021/1021.wav" preload="auto"></audio>
    <audio id="sound-timer" src="https://assets.mixkit.co/active_storage/sfx/3005/3005.wav" preload="auto"></audio>
    <audio id="sound-gameover" src="https://assets.mixkit.co/active_storage/sfx/3006/3006.wav" preload="auto"></audio>
    <audio id="sound-victory" src="https://assets.mixkit.co/active_storage/sfx/2018/2018.wav" preload="auto"></audio>
    <audio id="sound-applause" src="https://assets.mixkit.co/active_storage/sfx/1465/1465.wav" preload="auto"></audio>
    
    <!-- Hamburger Menü Toggle -->
    <div class="hamburger-toggle" id="hamburger-toggle">
        <i class="fas fa-bars"></i>
    </div>
    
    <!-- Menü Overlay (Arka plan kapatıcı) -->
    <div class="menu-overlay" id="menu-overlay"></div>
    
    <!-- Hamburger Menü -->
    <div class="hamburger-menu" id="hamburger-menu">
        <!-- Bottom sheet handle -->
        <div class="menu-handle"></div>
        

        
        <!-- Kullanıcı Profil Bilgisi (Oturum açıksa görünür) -->
        <div class="user-profile-section" id="user-profile-section" style="display: none;">
            <div class="user-avatar">
                <i class="fas fa-user-circle"></i>
            </div>
            <div class="user-info-menu">
                <p class="user-name" id="menu-user-name">Kullanıcı</p>
                <p class="user-email" id="menu-user-email">kullanici@email.com</p>
            </div>
        </div>
        
        <!-- Menü Öğeleri -->
        <div class="menu-section">
            <h3 id="menu-app-title">Uygulama</h3>
            <div class="menu-item" id="menu-home">
                <i class="fas fa-home"></i> <span id="menu-home-text">Ana Sayfa</span>
            </div>
            <div class="menu-item" id="menu-profile">
                <i class="fas fa-user"></i> <span id="menu-profile-text">Profilim</span>
            </div>
            <div class="menu-item" id="menu-friends">
                <i class="fas fa-user-friends"></i> <span id="menu-friends-text">Arkadaşlarım</span>
            </div>
            <div class="menu-item" id="menu-admin-panel" style="display: none;">
                <i class="fas fa-shield-alt"></i> <span id="menu-admin-text">Yönetici Paneli</span>
            </div>
        </div>
        
        <!-- Ayarlar Bölümü -->
        <div class="menu-section">
            <h3 id="menu-settings-title">Ayarlar</h3>

            
            <!-- Ses Ayarları -->
            <div class="menu-item">
                <i class="fas fa-volume-up"></i> <span id="menu-sound-text">Ses</span>
                <div class="toggle-switch">
                    <input type="checkbox" id="sound-toggle" checked />
                    <label for="sound-toggle" class="switch-label"></label>
                </div>
            </div>
            
            <!-- Tema Ayarları -->
            <div class="menu-item">
                <i class="fas fa-moon"></i> <span id="menu-theme-text">Karanlık Tema</span>
                <div class="theme-switch-wrapper">
                    <label class="theme-switch" for="checkbox">
                        <input type="checkbox" id="checkbox" />
                        <div class="slider round">
                            <i class="fas fa-sun"></i>
                            <i class="fas fa-moon"></i>
                        </div>
                    </label>
                </div>
            </div>
        </div>
        
        <!-- Çıkış Bölümü -->
        <div class="menu-section">
            <div class="menu-item" id="menu-logout">
                <i class="fas fa-sign-out-alt"></i> <span id="menu-logout-text">Çıkış Yap</span>
            </div>
        </div>
    </div>

    <!-- Mobil Tab Bar (Sadece mobilde görünür) -->
    <div class="mobile-tab-bar" id="mobile-tab-bar">
        <div class="tab-item" id="tab-home">
            <i class="fas fa-home"></i>
            <span>Ana Sayfa</span>
        </div>
        <div class="tab-item" id="tab-profile">
            <i class="fas fa-user"></i>
            <span>Profil</span>
        </div>
        <div class="tab-item" id="tab-friends">
            <i class="fas fa-user-friends"></i>
            <span>Arkadaş</span>
        </div>
        <div class="tab-item" id="tab-settings">
            <i class="fas fa-cog"></i>
            <span>Ayarlar</span>
        </div>
    </div>

    <!-- Joker Tab Bar (Sadece quiz aktifken görünür) -->
    <div class="joker-tab-bar" id="joker-tab-bar">
        <div class="joker-tab" id="joker-tab-fifty">
            <i class="fas fa-star-half-alt"></i>
            <span>50:50</span>
        </div>
        <div class="joker-tab" id="joker-tab-hint">
            <i class="fas fa-lightbulb"></i>
            <span>İpucu</span>
        </div>
        <div class="joker-tab" id="joker-tab-time">
            <i class="fas fa-clock"></i>
            <span>Süre</span>
        </div>
        <div class="joker-tab" id="joker-tab-skip">
            <i class="fas fa-forward"></i>
            <span>Pas</span>
        </div>
        <div class="joker-tab" id="joker-tab-store">
            <i class="fas fa-store"></i>
            <span>Mağaza</span>
        </div>
        <div class="joker-tab home-tab" id="joker-tab-home">
            <i class="fas fa-home"></i>
            <span>Çıkış</span>
        </div>
    </div>

    <div class="container">
        <div class="main-logo-container" style="text-align: center; margin-bottom: 10px;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 140" width="400" height="112" style="max-width: 100%; height: auto;">
                <defs>
                    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
                        <feDropShadow dx="2" dy="4" stdDeviation="3" flood-color="rgba(0,0,0,0.2)"/>
                    </filter>
                                            <linearGradient id="purpleGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#7c3aed;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#5b21b6;stop-opacity:1" />
                    </linearGradient>
                        <linearGradient id="orangeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#f97316;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#ea580c;stop-opacity:1" />
                    </linearGradient>
                        <linearGradient id="tealGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#0d9488;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#0f766e;stop-opacity:1" />
                    </linearGradient>
                        <linearGradient id="indigoGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#4f46e5;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#3730a3;stop-opacity:1" />
                    </linearGradient>
                </defs>
                <text x="60" y="100" font-family="Arial, sans-serif" font-size="100" font-weight="bold" 
                          fill="url(#purpleGrad)" filter="url(#shadow)">B</text>
                <text x="135" y="100" font-family="Arial, sans-serif" font-size="100" font-weight="bold" 
                          fill="url(#orangeGrad)" filter="url(#shadow)">i</text>
                <text x="170" y="100" font-family="Arial, sans-serif" font-size="100" font-weight="bold" 
                          fill="url(#tealGrad)" filter="url(#shadow)">l</text>
                <text x="205" y="100" font-family="Arial, sans-serif" font-size="100" font-weight="bold" 
                          fill="url(#indigoGrad)" filter="url(#shadow)">g</text>
                <text x="275" y="100" font-family="Arial, sans-serif" font-size="100" font-weight="bold" 
                          fill="url(#purpleGrad)" filter="url(#shadow)">o</text>
                <text x="345" y="100" font-family="Arial, sans-serif" font-size="100" font-weight="bold" 
                          fill="url(#orangeGrad)" filter="url(#shadow)">o</text>
            </svg>
        </div>

        <!-- Çevrimiçi oyun bölümü -->
        <div id="online-game-options" style="display: none;">
            <h2><i class="fas fa-globe"></i> <span data-i18n="online_mode">Çevrimiçi Mod</span></h2>
            <div class="online-options">
                <button id="create-room" class="online-btn"><i class="fas fa-plus-circle"></i> <span data-i18n="create_room">Oda Oluştur</span></button>
                <button id="join-room" class="online-btn"><i class="fas fa-sign-in-alt"></i> <span data-i18n="join_room">Odaya Katıl</span></button>
                <button id="back-to-main" class="online-btn"><i class="fas fa-arrow-left"></i> <span data-i18n="back">Geri</span></button>
            </div>
            <div id="room-creation" style="display: none;">
                <input type="text" id="room-name" placeholder="Oda adı" maxlength="20">
                <div class="room-capacity-container">
                    <label for="room-capacity">Oda Kapasitesi:</label>
                    <select id="room-capacity">
                        <option value="2">2 Oyuncu</option>
                        <option value="3">3 Oyuncu</option>
                        <option value="4">4 Oyuncu</option>
                        <option value="5">5 Oyuncu</option>
                        <option value="6">6 Oyuncu</option>
                    </select>
                </div>
                <div class="room-category-container">
                    <label for="room-category">Kategori:</label>
                    <select id="room-category">
                        <option value="">Kategori Seçin</option>
                        <!-- Kategoriler JS ile dinamik olarak eklenecek -->
                    </select>
                </div>
                <button id="create-room-submit" class="btn-primary"><i class="fas fa-check-circle"></i> <span data-i18n="create">Oluştur</span></button>
            </div>
            <div id="room-join" style="display: none;">
                <input type="text" id="room-code" placeholder="Oda kodu" maxlength="6">
                <button id="join-room-submit" class="btn-primary"><i class="fas fa-sign-in-alt"></i> <span data-i18n="join">Katıl</span></button>
            </div>
        </div>
        
        <!-- Bekleme odası - çoklu oyun başlığı dışında -->
        <div id="waiting-room" style="display: none;">
            <h3><i class="fas fa-users"></i> <span data-i18n="waiting_players">Oyuncular Bekleniyor</span></h3>
            <div class="room-code-display">
                <p><span data-i18n="room_code">Oda Kodu</span>:</p>
                <div id="display-room-code" class="room-code">XXXXXX</div>
                <button class="copy-code-btn" onclick="navigator.clipboard.writeText(document.getElementById('display-room-code').textContent)"><i class="fas fa-copy"></i></button>
            </div>
            <div class="waiting-room-container">
                <div class="player-list-container">
                    <h4><i class="fas fa-user-friends"></i> <span data-i18n="players">Oyuncular</span></h4>
                    <div id="player-list">
                        <!-- Oyuncular buraya eklenecek -->
                    </div>
                </div>
                
                <div class="chat-container">
                    <div class="chat-header">
                        <h4><i class="fas fa-comments"></i> Sohbet</h4>
                        <button id="chat-rules-btn" class="chat-rules-btn" title="Sohbet kuralları"><i class="fas fa-info-circle"></i></button>
                    </div>
                    <div class="chat-consent-notice" id="chat-consent-notice">
                        <p>Bu sohbetteki mesajlar KVKK/GDPR kapsamında korunmaktadır. Mesajlar süresiz olarak saklanabilir. Kişisel bilgilerinizi paylaşmayınız.</p>
                        <button id="accept-chat-terms" class="accept-btn">Kabul Ediyorum</button>
                        <a href="#" id="chat-policy-link">Gizlilik Politikası</a>
                    </div>
                    <div id="chat-messages" class="chat-messages">
                        <!-- Mesajlar buraya eklenecek -->
                        <div class="system-message">Oda oluşturuldu. Oyuncular bekleniyor...</div>
                    </div>
                    <div class="chat-controls">
                        <div class="chat-input-container">
                            <input type="text" id="chat-input" placeholder="Bir mesaj yazın..." maxlength="100" disabled>
                            <button id="send-message-btn" disabled><i class="fas fa-paper-plane"></i></button>
                        </div>
                        <div class="chat-actions">
                            <button id="report-message-btn" class="action-btn" title="Mesajı bildir"><i class="fas fa-flag"></i></button>
                            <button id="block-user-btn" class="action-btn" title="Kullanıcıyı engelle"><i class="fas fa-ban"></i></button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="waiting-room-actions">
                <button id="start-game" class="btn-success" disabled><i class="fas fa-play"></i> <span data-i18n="start_game">Oyunu Başlat</span></button>
                <button id="leave-room" class="btn-danger"><i class="fas fa-sign-out-alt"></i> <span data-i18n="leave_room">Odadan Ayrıl</span></button>
            </div>
        </div>

        <!-- Banner Reklam Alanı Kaldırıldı -->

        <div id="main-menu" class="main-menu" style="display: none;">
            <div class="menu-buttons">
                <button id="single-player-btn" class="menu-button">Tekli Oyun</button>
                <button id="online-game-button" class="menu-button">Çok Oyunculu</button>
                <button id="view-global-leaderboard" class="menu-button">Küresel Skor Tablosu</button>
                <button id="show-stats" class="menu-button">İstatistikler</button>
                <button id="add-question-button" class="menu-button">Soru Ekle</button>
            </div>
        </div>

        <!-- Kategori seçimi -->
        <div id="category-selection" style="display: none;">
            <h2><i class="fas fa-th-list"></i> <span data-i18n="select_category">Kategori Seçin</span></h2>
            <div id="categories"></div>
        </div>

        <div id="quiz" style="display: none;"> <!-- Başlangıçta gizli -->
            
            <!-- Oyun Sırasında Puan Göstergesi -->
            <div class="game-header">
                <!-- Can gösterimi -->
                <div id="lives-container" class="lives-container">
                    <!-- Canlar JavaScript ile dinamik olarak eklenecek -->
                </div>
                
                <!-- Zamanlayıcı -->
                <div id="timer" class="timer-display"><i class="fas fa-hourglass-half"></i> <span id="time-left">--</span>sn</div>
                
                <!-- Puan gösterimi -->
                <div class="score-display-simple">
                    <div class="total-score-simple">
                        <i class="fas fa-star"></i>
                        <span id="total-score-value">0</span>
                    </div>
                    <div class="current-score-simple">
                        <i class="fas fa-trophy"></i>
                        <span id="current-score">0</span>
                    </div>
                </div>
            </div>
            
            <div class="quiz-container">
                <div class="quiz-main">
                    <div id="question">Soru burada görünecek</div>
                    
                    <!-- Çevrimiçi oyun göstergeleri -->
                    <div id="online-indicators" style="display: none;">
                        <div id="player-scores">
                            <!-- Oyuncu skorları burada gösterilecek -->
                        </div>
                    </div>
                    
                    <div id="options">
                        <!-- Seçenekler buraya JavaScript ile eklenecek -->
                    </div>
                    <button id="next-question" style="display: none;"><i class="fas fa-arrow-right"></i> <span data-i18n="next_question">Sonraki Soru</span></button> <!-- Sonraki soru butonu eklendi -->
                    
                    <!-- Joker butonları - en alta alındı -->
                    <div id="jokers">
                        <button id="joker-fifty" class="joker-btn" title="50:50 - İki yanlış cevabı ele"><i class="fas fa-star-half-alt"></i></button>
                        <button id="joker-hint" class="joker-btn" title="İpucu - Doğru cevap hakkında ipucu verir"><i class="fas fa-lightbulb"></i></button>
                        <button id="joker-time" class="joker-btn" title="Süre Uzatma - Sorunun süresini 15 saniye uzatır"><i class="fas fa-clock"></i></button>
                        <button id="joker-skip" class="joker-btn" title="Pas - Bu soruyu atlayın ve puan kaybetmeyin"><i class="fas fa-forward"></i></button>
                        <button id="joker-store" class="joker-store-btn" title="Joker Mağazası - Puanlarınızla joker satın alın"><i class="fas fa-store"></i></button>
                    </div>
                </div>
                
                <!-- Oyun sırasında görünecek chat paneli -->
                <div id="game-chat-container" class="game-chat-container">
                    <div class="chat-header">
                        <h4><i class="fas fa-comments"></i> Sohbet</h4>
                        <button id="game-chat-rules-btn" class="chat-rules-btn" title="Sohbet kuralları"><i class="fas fa-info-circle"></i></button>
                    </div>
                    <div class="chat-consent-notice" id="game-chat-consent-notice">
                        <p>Bu sohbetteki mesajlar KVKK/GDPR kapsamında korunmaktadır. Mesajlar süresiz olarak saklanabilir. Kişisel bilgilerinizi paylaşmayınız.</p>
                        <button id="game-accept-chat-terms" class="accept-btn">Kabul Ediyorum</button>
                        <a href="#" id="game-chat-policy-link">Gizlilik Politikası</a>
                    </div>
                    <div id="game-chat-messages" class="chat-messages">
                        <!-- Mesajlar buraya eklenecek -->
                        <div class="system-message">Oyun başladı. İyi şanslar!</div>
                    </div>
                    <div class="chat-controls">
                        <div class="chat-input-container">
                            <input type="text" id="game-chat-input" placeholder="Bir mesaj yazın..." maxlength="100" disabled>
                            <button id="game-send-message-btn" disabled><i class="fas fa-paper-plane"></i></button>
                        </div>
                        <div class="chat-actions">
                            <button id="game-report-message-btn" class="action-btn" title="Mesajı bildir"><i class="fas fa-flag"></i></button>
                            <button id="game-block-user-btn" class="action-btn" title="Kullanıcıyı engelle"><i class="fas fa-ban"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Kazanan ekranı -->
        <div id="winner-screen" style="display: none;" class="winner-container">
            <div class="winner-content">
                <h2><i class="fas fa-trophy"></i> <span data-i18n="winner">Kazanan</span></h2>
                <div class="winner-info">
                    <div id="winner-name" class="winner-name">Oyuncu Adı</div>
                    <div id="winner-score" class="winner-score">Skor: 0/10</div>
                </div>
                <div class="winner-medal">🏆</div>
                <div id="all-player-results" class="all-player-results">
                    <!-- Diğer oyuncuların sonuçları burada listelenecek -->
                </div>
                <div class="winner-actions">
                    <button id="play-again-btn" class="btn-primary"><i class="fas fa-redo"></i> <span data-i18n="play_again">Tekrar Oyna</span></button>
                    <button id="back-to-menu-btn" class="btn-secondary"><i class="fas fa-home"></i> <span data-i18n="main_menu">Ana Menü</span></button>
                </div>
            </div>
        </div>

        <!-- Lider tablosu -->
        <div id="global-leaderboard" style="display: none;">
            <h2><i class="fas fa-trophy"></i> <span data-i18n="leaderboard_title">Küresel Lider Tablosu</span></h2>
            
            <div class="leaderboard-filters">
                <select id="leaderboard-category">
                    <option value="all" data-i18n="leaderboard_all">Tüm Kategoriler</option>
                    <option value="Genel Kültür" data-i18n="categoryGeneral">Genel Kültür</option>
                    <option value="Bilim" data-i18n="categoryScience">Bilim</option>
                    <option value="Teknoloji" data-i18n="categoryTechnology">Teknoloji</option>
                    <option value="Spor" data-i18n="categorySports">Spor</option>
                    <option value="Müzik" data-i18n="categoryMusic">Müzik</option>
                    <option value="Edebiyat" data-i18n="categoryLiterature">Edebiyat</option>
                    <option value="Tarih" data-i18n="categoryHistory">Tarih</option>
                </select>
                <select id="leaderboard-time">
                    <option value="weekly" data-i18n="leaderboard_weekly">Haftalık</option>
                    <option value="monthly" data-i18n="leaderboard_monthly">Aylık</option>
                    <option value="alltime" data-i18n="leaderboard_alltime">Tüm Zamanlar</option>
                </select>
                <button id="refresh-leaderboard" class="refresh-btn"><i class="fas fa-sync-alt"></i> <span data-i18n="leaderboard_refresh">Yenile</span></button>
            </div>
            
            <div id="leaderboard-list" class="leaderboard-list">
                <!-- Lider tablosu burada gösterilecek -->
            </div>
            
            <div class="leaderboard-info">
                <p><i class="fas fa-info-circle"></i> <span data-i18n="leaderboard_info">Yüksek skorlar, her kategorideki doğru cevap oranına göre sıralanır.</span></p>
                <p><span data-i18n="leaderboard_filter_info">Filtreleri kullanarak farklı kategorilerdeki ve zaman dilimlerindeki skorları görebilirsiniz.</span></p>
            </div>
            
            <button id="back-from-leaderboard" class="back-btn"><i class="fas fa-arrow-left"></i> <span data-i18n="back_to_menu">Ana Menüye Dön</span></button>
        </div>

        <!-- Profil Sayfası -->
        <div id="profile-page" style="display: none;">
            <div class="profile-page-header">
                <h2><i class="fas fa-user-circle"></i> Profilim</h2>
            </div>
            
            <div class="profile-container">
                <div class="profile-card">
                    <div class="profile-details">
                        <h2 id="profile-name">Kullanıcı Adı</h2>
                        <p id="profile-email">kullanici@email.com</p>
                        <p class="profile-since">Üyelik: <span id="profile-join-date">01.01.2025</span></p>
                        <div class="profile-score">
                            <div class="score-info">
                                <span class="score-label">Toplam Puanım:</span>
                                <span class="score-value" id="profile-total-score">0</span>
                            </div>
                            <div class="level-info">
                                <span class="level-label">Seviye:</span>
                                <span class="level-value" id="profile-user-level">1</span>
                            </div>
                        </div>
                    </div>
                    <div class="profile-actions-secondary">
                        <button class="btn-secondary" id="edit-profile-btn"><i class="fas fa-edit"></i> Profili Düzenle</button>
                    </div>
                </div>
                
                <div class="stats-card">
                    <h3><i class="fas fa-chart-line"></i> İstatistikler</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-value" id="stats-total-games">0</span>
                            <span class="stat-label">Toplam Oyun</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="stats-total-questions">0</span>
                            <span class="stat-label">Toplam Soru</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="stats-correct-answers">0</span>
                            <span class="stat-label">Doğru Cevap</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="stats-accuracy">%0</span>
                            <span class="stat-label">Doğruluk Oranı</span>
                        </div>
                    </div>
                </div>
                
                <div class="badges-showcase">
                    <h3><i class="fas fa-award"></i> Rozetler</h3>
                    <div class="badges-grid" id="profile-badges-container">
                        <!-- Rozetler burada gösterilecek -->
                        <div class="badge-placeholder">Henüz rozet kazanılmadı</div>
                    </div>
                </div>
                
                <div class="high-scores-card">
                    <h3><i class="fas fa-trophy"></i> En Yüksek Skorlar</h3>
                    <table class="high-scores-table">
                        <thead>
                            <tr>
                                <th>Kategori</th>
                                <th>Skor</th>
                                <th>Tarih</th>
                            </tr>
                        </thead>
                        <tbody id="profile-high-scores">
                            <!-- Yüksek skorlar burada gösterilecek -->
                            <tr><td colspan="3" class="no-data">Henüz kaydedilen skor yok</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="recent-activities">
                    <h3><i class="fas fa-history"></i> Son Aktiviteler</h3>
                    <div class="activity-list" id="recent-activities-list">
                        <!-- Aktiviteler burada dinamik olarak yüklenecek -->
                        <div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i> Aktiviteler yükleniyor...</div>
                    </div>
                </div>
                
                <div class="profile-actions">
                    <button class="btn-primary" id="back-from-profile"><i class="fas fa-arrow-left"></i> Ana Menüye Dön</button>
                    <button class="btn-danger" id="logout-from-profile"><i class="fas fa-sign-out-alt"></i> Çıkış Yap</button>
                </div>
            </div>
        </div>

        <div id="result" style="display: none;">
            <h2><i class="fas fa-trophy"></i> <span data-i18n="result">Sonuç</span></h2>
            <div id="confetti-container"></div> <!-- Konfeti için container -->
            <p id="score"></p>
            
            <!-- Başarı rozetleri -->
            <div id="badges" class="badges-container">
                <!-- Rozetler JavaScript ile eklenecek -->
            </div>
            
            <!-- İstatistikler -->
            <div id="stats" class="stats-container">
                <h3><i class="fas fa-chart-bar"></i> <span data-i18n="statistics">İstatistikler</span></h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-value" id="total-questions">0</span>
                        <span class="stat-label" data-i18n="total_questions">Toplam Soru</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="correct-answers">0</span>
                        <span class="stat-label" data-i18n="correct_answers">Doğru Cevap</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="average-time">0s</span>
                        <span class="stat-label" data-i18n="average_time">Ort. Süre</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="best-category">-</span>
                        <span class="stat-label" data-i18n="best_category">En İyi Kategori</span>
                    </div>
                </div>
            </div>
            
            <button id="restart"><i class="fas fa-redo"></i> <span data-i18n="back_to_categories">Kategori Seçimine Dön</span></button>
            <button id="share-score"><i class="fas fa-share-alt"></i> <span data-i18n="share_score">Skoru Paylaş</span></button>
            <button id="report-question" class="report-question" style="display: none;"><i class="fas fa-flag"></i> <span data-i18n="report_question">Soruyu Bildir</span></button>
            
            <!-- Yeni sekme sistemi -->
            <div class="result-tabs">
                <div class="tab-nav">
                    <button class="tab-button active" data-tab="high-scores"><i class="fas fa-trophy"></i> Yüksek Skorlar</button>
                    <button class="tab-button" data-tab="daily-tasks"><i class="fas fa-tasks"></i> Günlük Görevler</button>
                    <button class="tab-button" data-tab="achievements"><i class="fas fa-award"></i> Başarımlar</button>
                    <button class="tab-button" data-tab="progress" id="progress-tab"><i class="fas fa-chart-line"></i> İlerleme</button>
                    <button class="tab-button" data-tab="feedbacks"><i class="fas fa-comment-alt"></i> Bildirimler</button>
                </div>
                
                <div class="tab-content">
                    <!-- Yüksek Skorlar Sekmesi -->
                    <div class="tab-pane active" id="high-scores-tab">
                        <div id="high-scores">
                            <h3><i class="fas fa-medal"></i> <span data-i18n="high_scores">En Yüksek Skorlar</span></h3>
                            <ul id="high-scores-list">
                                <!-- Skorlar buraya eklenecek -->
                            </ul>
                        </div>
                    </div>
                    
                    <!-- Günlük Görevler Sekmesi -->
                    <div class="tab-pane" id="daily-tasks-tab">
                        <div id="daily-tasks-container">
                            <!-- Günlük görevler buraya JavaScript ile eklenecek -->
                        </div>
                    </div>
                    
                    <!-- Başarımlar Sekmesi -->
                    <div class="tab-pane" id="achievements-tab">
                        <div id="achievements-container">
                            <!-- Başarımlar buraya JavaScript ile eklenecek -->
                        </div>
                    </div>
                    
                    <!-- İlerleme Sekmesi -->
                    <div class="tab-pane" id="progress-tab">
                        <div class="charts-container">
                            <div class="chart-section">
                                <h3><i class="fas fa-chart-bar"></i> Kategori Başarısı</h3>
                                <div class="chart-wrapper">
                                    <canvas id="category-chart"></canvas>
                                </div>
                            </div>
                            
                            <div class="chart-section">
                                <h3><i class="fas fa-chart-line"></i> Zaman İçindeki Performans</h3>
                                <div class="chart-wrapper">
                                    <canvas id="time-chart"></canvas>
                                </div>
                            </div>
                            
                            <button id="update-charts" class="update-btn"><i class="fas fa-sync"></i> Grafikleri Güncelle</button>
                        </div>
                    </div>
                    
                    <!-- Bildirimler Sekmesi -->
                    <div class="tab-pane" id="feedbacks-tab">
                        <div class="feedbacks-container">
                            <h3><i class="fas fa-comment-alt"></i> Soru Bildirimleri</h3>
                            <div id="feedback-list">
                                <!-- Bildirimler buraya JavaScript ile eklenecek -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- İstatistikler Sayfası -->
        <div id="statistics-page" style="display: none;">
            <div class="page-header">
                <h2><i class="fas fa-chart-bar"></i> İstatistiklerim</h2>
                <button id="back-from-stats" class="btn-secondary">
                    <i class="fas fa-arrow-left"></i> Ana Menüye Dön
                </button>
            </div>
            
            <div class="statistics-container">
                <!-- Genel İstatistikler -->
                <div class="stats-section">
                    <h3><i class="fas fa-trophy"></i> Genel İstatistikler</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-gamepad"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-value" id="total-games-stat">0</span>
                                <span class="stat-label">Toplam Oyun</span>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-question-circle"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-value" id="total-questions-stat">0</span>
                                <span class="stat-label">Toplam Soru</span>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-value" id="correct-answers-stat">0</span>
                                <span class="stat-label">Doğru Cevap</span>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-percentage"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-value" id="accuracy-stat">%0</span>
                                <span class="stat-label">Doğruluk Oranı</span>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-value" id="highest-score-stat">0</span>
                                <span class="stat-label">En Yüksek Skor</span>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-value" id="average-score-stat">0</span>
                                <span class="stat-label">Ortalama Skor</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Kategori İstatistikleri -->
                <div class="stats-section">
                    <h3><i class="fas fa-th-list"></i> Kategori Başarıları</h3>
                    <div id="category-stats" class="category-stats">
                        <!-- Kategori istatistikleri JavaScript ile eklenecek -->
                    </div>
                </div>
                
                <!-- Son Oyunlar -->
                <div class="stats-section">
                    <h3><i class="fas fa-history"></i> Son Oyunlar</h3>
                    <div id="recent-games" class="recent-games">
                        <!-- Son oyunlar JavaScript ile eklenecek -->
                    </div>
                </div>
                
                <!-- Grafikler -->
                <div class="stats-section">
                    <h3><i class="fas fa-chart-area"></i> Performans Grafikleri</h3>
                    <div class="charts-container">
                        <div class="chart-box">
                            <h4>Kategori Dağılımı</h4>
                            <canvas id="category-pie-chart"></canvas>
                        </div>
                        <div class="chart-box">
                            <h4>Zaman İçindeki Performans</h4>
                            <canvas id="performance-line-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- İstatistikler Sayfası -->
        <div id="statistics-page" style="display: none;">
            <div class="page-header">
                <h2><i class="fas fa-chart-bar"></i> İstatistiklerim</h2>
                <button id="back-from-stats" class="btn-secondary">
                    <i class="fas fa-arrow-left"></i> Ana Menüye Dön
                </button>
            </div>
            
            <div class="statistics-container">
                <!-- Genel İstatistikler -->
                <div class="stats-section">
                    <h3><i class="fas fa-trophy"></i> Genel İstatistikler</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-gamepad"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-value" id="total-games-stat">0</span>
                                <span class="stat-label">Toplam Oyun</span>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-question-circle"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-value" id="total-questions-stat">0</span>
                                <span class="stat-label">Toplam Soru</span>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-value" id="correct-answers-stat">0</span>
                                <span class="stat-label">Doğru Cevap</span>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-percentage"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-value" id="accuracy-stat">%0</span>
                                <span class="stat-label">Doğruluk Oranı</span>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-value" id="highest-score-stat">0</span>
                                <span class="stat-label">En Yüksek Skor</span>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-value" id="average-score-stat">0</span>
                                <span class="stat-label">Ortalama Skor</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Kategori İstatistikleri -->
                <div class="stats-section">
                    <h3><i class="fas fa-th-list"></i> Kategori Başarıları</h3>
                    <div id="category-stats" class="category-stats">
                        <!-- Kategori istatistikleri JavaScript ile eklenecek -->
                    </div>
                </div>
                
                <!-- Son Oyunlar -->
                <div class="stats-section">
                    <h3><i class="fas fa-history"></i> Son Oyunlar</h3>
                    <div id="recent-games" class="recent-games">
                        <!-- Son oyunlar JavaScript ile eklenecek -->
                    </div>
                </div>
                
                <!-- Grafikler -->
                <div class="stats-section">
                    <h3><i class="fas fa-chart-area"></i> Performans Grafikleri</h3>
                    <div class="charts-container">
                        <div class="chart-box">
                            <h4>Kategori Dağılımı</h4>
                            <canvas id="category-pie-chart"></canvas>
                        </div>
                        <div class="chart-box">
                            <h4>Zaman İçindeki Performans</h4>
                            <canvas id="performance-line-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Soru Ekleme Formu -->
        <div id="add-question-form" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Yeni Soru Ekle</h2>
                
                <div class="approval-notice">
                    <div class="notice-icon">
                        <i class="fas fa-info-circle"></i>
                    </div>
                    <div class="notice-content">
                        <h4>📋 Onay Süreci</h4>
                        <p>Eklediğiniz sorular önce yönetici onayından geçecek ve ardından soru bankasına eklenecektir. Bu süreç genellikle 24-48 saat içinde tamamlanır.</p>
                    </div>
                </div>
                
                <form id="question-form">
                    <div class="form-group">
                        <label for="question-category">Kategori:</label>
                        <select id="question-category" required>
                            <option value="">Kategori seçin...</option>
                            <option value="Genel Kültür">📚 Genel Kültür</option>
                            <option value="Bilim">🔬 Bilim</option>
                            <option value="Teknoloji">💻 Teknoloji</option>
                            <option value="Spor">⚽ Spor</option>
                            <option value="Sanat">🎨 Sanat</option>
                            <option value="Tarih">🏛️ Tarih</option>
                            <option value="Coğrafya">🌍 Coğrafya</option>
                            <option value="Edebiyat">📖 Edebiyat</option>
                            <option value="Matematik">🔢 Matematik</option>
                            <option value="Müzik">🎵 Müzik</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="question-text">Soru:</label>
                        <textarea id="question-text" required placeholder="Sorunuzu buraya yazın..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Şıklar:</label>
                        <input type="text" id="option-a" placeholder="🅰️ A Şıkkı" required>
                        <input type="text" id="option-b" placeholder="🅱️ B Şıkkı" required>
                        <input type="text" id="option-c" placeholder="🅾️ C Şıkkı" required>
                        <input type="text" id="option-d" placeholder="🔴 D Şıkkı" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="correct-answer">Doğru Cevap:</label>
                        <select id="correct-answer" required>
                            <option value="">Doğru cevabı seçin...</option>
                            <option value="0">🅰️ A Şıkkı</option>
                            <option value="1">🅱️ B Şıkkı</option>
                            <option value="2">🅾️ C Şıkkı</option>
                            <option value="3">🔴 D Şıkkı</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="question-difficulty">Zorluk Seviyesi:</label>
                        <select id="question-difficulty" required>
                            <option value="">Zorluk seviyesi seçin...</option>
                            <option value="1">🟢 Kolay</option>
                            <option value="2">🟡 Orta</option>
                            <option value="3">🔴 Zor</option>
                        </select>
                    </div>
                    
                    <button type="submit" class="submit-button btn-primary">Soruyu Ekle</button>
                </form>
            </div>
        </div>

        <footer>
            <div class="company-info">
                <div class="logo">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="32" height="32">
                        <!-- Yaprak şekli -->
                        <path d="M25,2 C22,5 12,12 8,18 C4,24 5,36 12,40 C19,44 28,45 35,40 C42,35 43,28 42,22 C41,16 35,10 30,6 C27,4 25,2 25,2 Z" fill="#4CAF50"/>
                        
                        <!-- Devre yolları olarak yaprak damarları -->
                        <path d="M25,2 C25,15 25,28 25,40" stroke="white" stroke-width="1.2" fill="none"/>
                        <circle cx="25" cy="2" r="1" fill="white"/>
                        <circle cx="25" cy="15" r="1" fill="white"/>
                        <circle cx="25" cy="28" r="1" fill="white"/>
                        <circle cx="25" cy="40" r="1" fill="white"/>
                        
                        <path d="M10,18 C20,20 30,18 40,20" stroke="white" stroke-width="1.2" fill="none"/>
                        <circle cx="10" cy="18" r="1" fill="white"/>
                        <circle cx="20" cy="20" r="1" fill="white"/>
                        <circle cx="30" cy="18" r="1" fill="white"/>
                        <circle cx="40" cy="20" r="1" fill="white"/>
                        
                        <path d="M12,32 C20,34 30,32 38,30" stroke="white" stroke-width="1.2" fill="none"/>
                        <circle cx="12" cy="32" r="1" fill="white"/>
                        <circle cx="20" cy="34" r="1" fill="white"/>
                        <circle cx="30" cy="32" r="1" fill="white"/>
                        <circle cx="38" cy="30" r="1" fill="white"/>
                        
                        <!-- Diğer devre yolları -->
                        <path d="M15,10 L35,10 L35,20 L30,20 L30,25 L35,25 L35,30 L25,30 L25,35 L15,35 L15,25 L20,25 L20,20 L15,20 Z" 
                              stroke="white" stroke-width="1.2" fill="none"/>
                        <circle cx="15" cy="10" r="1" fill="white"/>
                        <circle cx="35" cy="10" r="1" fill="white"/>
                        <circle cx="35" cy="20" r="1" fill="white"/>
                        <circle cx="30" cy="20" r="1" fill="white"/>
                        <circle cx="30" cy="25" r="1" fill="white"/>
                        <circle cx="35" cy="25" r="1" fill="white"/>
                        <circle cx="35" cy="30" r="1" fill="white"/>
                        <circle cx="25" cy="30" r="1" fill="white"/>
                        <circle cx="25" cy="35" r="1" fill="white"/>
                        <circle cx="15" cy="35" r="1" fill="white"/>
                        <circle cx="15" cy="25" r="1" fill="white"/>
                        <circle cx="20" cy="25" r="1" fill="white"/>
                        <circle cx="20" cy="20" r="1" fill="white"/>
                        <circle cx="15" cy="20" r="1" fill="white"/>
                    </svg>
                </div>
                <p>&copy; 2025 TEKNOVA BİLİŞİM</p>
            </div>
        </footer>
    </div>

    <!-- Konfeti library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <!-- Chart.js için CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Firebase için CDN -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="firebase-config.js"></script>
    <!-- Diğer JS dosyaları -->
    <!-- Dil dosyası -->
    <script src="languages.js"></script>
    <script src="script.js?v=2.9"></script>
    <script src="online-game.js?v=2.1"></script>
    <script src="friends.js"></script>
    <script src="daily-tasks.js"></script>
    <script src="achievements.js"></script>
    <script src="progress-chart.js"></script>
    <script src="feedback.js"></script>
    <script src="admin-pending-questions.js"></script>
    <script src="monetization.js"></script>
    
    <!-- Cookie Consent Banner -->
    <div id="cookie-consent" class="cookie-consent" style="display: none;">
        <div class="cookie-content">
            <div class="cookie-text">
                <h3>🍪 Çerez Bildirimi</h3>
                <p>Web sitemiz, size daha iyi hizmet verebilmek ve reklamları kişiselleştirmek için çerezler kullanır. 
                Detaylı bilgi için <a href="privacy-policy.html" target="_blank">Gizlilik Politikamızı</a> inceleyebilirsiniz.</p>
            </div>
            <div class="cookie-buttons">
                <button id="accept-essential" class="cookie-btn cookie-btn-secondary">Sadece Gerekli</button>
                <button id="accept-all" class="cookie-btn cookie-btn-primary">Tümünü Kabul Et</button>
                <button id="cookie-settings" class="cookie-btn cookie-btn-link">Ayarlar</button>
            </div>
        </div>
    </div>

    <!-- Cookie Settings Modal -->
    <div id="cookie-settings-modal" class="cookie-modal" style="display: none;">
        <div class="cookie-modal-content">
            <div class="cookie-modal-header">
                <h3>Çerez Ayarları</h3>
                <button id="close-cookie-modal" class="cookie-close">&times;</button>
            </div>
            <div class="cookie-modal-body">
                <div class="cookie-category">
                    <label class="cookie-toggle">
                        <input type="checkbox" id="essential-cookies" checked disabled>
                        <span class="cookie-slider"></span>
                        <div class="cookie-info">
                            <h4>Zorunlu Çerezler</h4>
                            <p>Sitenin çalışması için gerekli çerezler</p>
                        </div>
                    </label>
                </div>
                <div class="cookie-category">
                    <label class="cookie-toggle">
                        <input type="checkbox" id="analytics-cookies">
                        <span class="cookie-slider"></span>
                        <div class="cookie-info">
                            <h4>Analitik Çerezler</h4>
                            <p>Site kullanımını analiz etmek için kullanılır</p>
                        </div>
                    </label>
                </div>
                <div class="cookie-category">
                    <label class="cookie-toggle">
                        <input type="checkbox" id="advertising-cookies">
                        <span class="cookie-slider"></span>
                        <div class="cookie-info">
                            <h4>Reklam Çerezleri</h4>
                            <p>Kişiselleştirilmiş reklamlar göstermek için kullanılır</p>
                        </div>
                    </label>
                </div>
            </div>
            <div class="cookie-modal-footer">
                <button id="save-cookie-preferences" class="cookie-btn cookie-btn-primary">Kaydet</button>
            </div>
        </div>
    </div>



    <script>
        // Hamburger menü işlevleri
        document.addEventListener('DOMContentLoaded', function() {
            const hamburgerToggle = document.getElementById('hamburger-toggle');
            const hamburgerMenu = document.getElementById('hamburger-menu');
            const menuOverlay = document.getElementById('menu-overlay');
            
            // Menüyü aç/kapat
            hamburgerToggle.addEventListener('click', function() {
                hamburgerMenu.classList.toggle('active');
                menuOverlay.classList.toggle('active');
                
                // Debug: Admin panel durumunu kontrol et
                const adminPanelMenuItem = document.getElementById('menu-admin-panel');
                console.log('=== Hamburger menü açıldı - Admin panel debug ===');
                console.log('Admin panel element var mı?', adminPanelMenuItem ? 'Evet' : 'Hayır');
                if (adminPanelMenuItem) {
                    console.log('Admin panel display değeri:', adminPanelMenuItem.style.display);
                    console.log('Admin panel computed style:', window.getComputedStyle(adminPanelMenuItem).display);
                }
                console.log('Aktif kullanıcı:', firebase.auth && firebase.auth().currentUser ? firebase.auth().currentUser.uid : 'Giriş yapılmamış');
                console.log('================================================');
                
                // Icon değiştirme
                const icon = hamburgerToggle.querySelector('i');
                if (hamburgerMenu.classList.contains('active')) {
                    icon.classList.remove('fa-bars');
                    icon.classList.add('fa-times');
                } else {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            });
            
            // Overlay'e tıklayınca menüyü kapat
            menuOverlay.addEventListener('click', function() {
                hamburgerMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
                
                // İkonu bars'a geri çevir
                const icon = hamburgerToggle.querySelector('i');
                if (icon) {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            });
            
            // Bottom sheet dışına tıklayınca kapat (mobil için)
            document.addEventListener('click', function(e) {
                if (hamburgerMenu.classList.contains('active')) {
                    // Tıklanan element hamburger menü veya toggle değilse kapat
                    if (!hamburgerMenu.contains(e.target) && 
                        !hamburgerToggle.contains(e.target) &&
                        !e.target.closest('.tab-item')) {
                        
                        hamburgerMenu.classList.remove('active');
                        const icon = hamburgerToggle.querySelector('i');
                        if (icon) {
                            icon.classList.remove('fa-times');
                            icon.classList.add('fa-bars');
                        }
                    }
                }
            });
            
            // Menü öğelerine olay dinleyiciler ekle
            document.getElementById('menu-home').addEventListener('click', function() {
                hamburgerMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
                
                // OYUNU DURDUR - Timer'ları ve oyun durumunu temizle
                if (typeof quizApp !== 'undefined') {
                    // Zamanlayıcıyı durdur
                    if (quizApp.stopTimer) {
                        quizApp.stopTimer();
                    }
                    
                    // Online oyun varsa durdur
                    if (typeof onlineGame !== 'undefined' && onlineGame && onlineGame.gameStarted) {
                        onlineGame.gameStarted = false;
                        onlineGame.leaveRoom();
                    }
                    
                    // Oyun durumunu sıfırla
                    quizApp.currentQuestionIndex = 0;
                    quizApp.score = 0;
                    quizApp.lives = 5;
                    quizApp.timeLeft = 0;
                    
                    // Body class'larını temizle
                    document.body.classList.remove('quiz-active', 'category-selection');
                }
                
                // Tüm sayfaları gizle
                const elementsToHide = [
                    'category-selection',
                    'quiz',
                    'result',
                    'profile-page',
                    'online-game-options',
                    'global-leaderboard',
                    'friends-page',
                    'admin-panel'
                ];
                
                elementsToHide.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) element.style.display = 'none';
                });
                
                // Ana menüyü göster
                const mainMenu = document.getElementById('main-menu');
                if (mainMenu) {
                    mainMenu.style.display = 'block';
                }
                
                // Hamburger menü ikonunu bars'a geri çevir
                const icon = hamburgerToggle.querySelector('i');
                if (icon) {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            });
            
            document.getElementById('menu-profile').addEventListener('click', function() {
                hamburgerMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
                
                // Profil sayfasını göster
                if (typeof quizApp !== 'undefined' && typeof quizApp.showProfilePage === 'function') {
                    quizApp.showProfilePage();
                } else {
                    // quizApp veya fonksiyon yoksa uyarı göster
                    alert('Profil sayfası şu anda kullanılamıyor.');
                }
                
                // Hamburger menü ikonunu bars'a geri çevir
                const icon = hamburgerToggle.querySelector('i');
                if (icon) {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            });
            
            document.getElementById('menu-friends').addEventListener('click', function() {
                hamburgerMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
                
                // Arkadaşlar sayfasını göster
                if (window.friendsModule && window.friendsModule.showFriendsPage) {
                    window.friendsModule.showFriendsPage();
                }
                
                // Hamburger menü ikonunu bars'a geri çevir
                const icon = hamburgerToggle.querySelector('i');
                if (icon) {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            });
            

            document.getElementById('menu-logout').addEventListener('click', function() {
                hamburgerMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
                
                // Çıkış yap
                if (firebase.auth) {
                    firebase.auth().signOut().then(() => {
                        window.location.href = 'login.html';
                    });
                }
                
                // Hamburger menü ikonunu bars'a geri çevir
                const icon = hamburgerToggle.querySelector('i');
                if (icon) {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            });
            
            // Mobil Tab Bar işlevleri
            const tabItems = document.querySelectorAll('.tab-item');
            
            // Tab item click events
            tabItems.forEach(tab => {
                let pressTimer;
                
                // Normal tıklama
                tab.addEventListener('click', function() {
                    // Aktif tab'ı temizle
                    tabItems.forEach(t => t.classList.remove('active'));
                    // Bu tab'ı aktif yap
                    this.classList.add('active');
                    
                    // Tab'a göre işlem yap
                    const tabId = this.id;
                    switch(tabId) {
                        case 'tab-home':
                            // Ana sayfa fonksiyonunu çağır
                            document.getElementById('menu-home').click();
                            break;
                        case 'tab-profile':
                            // Profil fonksiyonunu çağır
                            document.getElementById('menu-profile').click();
                            break;
                        case 'tab-friends':
                            // Arkadaşlar fonksiyonunu çağır
                            document.getElementById('menu-friends').click();
                            break;
                        case 'tab-settings':
                            // Ayarlar için bottom sheet menüyü aç
                            hamburgerMenu.classList.add('active');
                            menuOverlay.classList.add('active');
                            break;
                    }
                });

                // Uzun basma kaldırıldı - artık direkt çıkış butonu var
            });

            // Bottom sheet için swipe özelliği (mobilde aşağı kaydırarak kapatma)
            let startY = 0;
            let currentY = 0;
            let isScrolling = false;

            hamburgerMenu.addEventListener('touchstart', function(e) {
                startY = e.touches[0].clientY;
                isScrolling = false;
            });

            hamburgerMenu.addEventListener('touchmove', function(e) {
                currentY = e.touches[0].clientY;
                const deltaY = currentY - startY;
                
                // Aşağı kaydırma algılandı ve menü scrollTop'ta
                if (deltaY > 0 && hamburgerMenu.scrollTop === 0) {
                    e.preventDefault();
                    isScrolling = true;
                    
                    // Menüyü hafifçe aşağı kaydır (visual feedback)
                    if (deltaY < 100) {
                        hamburgerMenu.style.transform = `translateY(${deltaY}px)`;
                    }
                }
            });

            hamburgerMenu.addEventListener('touchend', function(e) {
                if (isScrolling) {
                    const deltaY = currentY - startY;
                    
                    // Eğer 100px'den fazla aşağı kaydırıldıysa menüyü kapat
                    if (deltaY > 100) {
                        hamburgerMenu.classList.remove('active');
                        // Icon'u da sıfırla
                        const icon = hamburgerToggle.querySelector('i');
                        if (icon) {
                            icon.classList.remove('fa-times');
                            icon.classList.add('fa-bars');
                        }
                    }
                    
                    // Transform'u sıfırla
                    hamburgerMenu.style.transform = '';
                }
                
                isScrolling = false;
            });

            // Menu handle'a tıklama ile kapatma
            const menuHandle = document.querySelector('.menu-handle');
            if (menuHandle) {
                menuHandle.addEventListener('click', function() {
                    hamburgerMenu.classList.remove('active');
                    const icon = hamburgerToggle.querySelector('i');
                    if (icon) {
                        icon.classList.remove('fa-times');
                        icon.classList.add('fa-bars');
                    }
                });
            }

            // Yönetici Paneli menü öğesi (sadece adminler için görünür)
            document.getElementById('menu-admin-panel').addEventListener('click', function() {
                hamburgerMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
                
                // Yönetici panelini göster
                if (window.adminModule && window.adminModule.showAdminPanel) {
                    window.adminModule.showAdminPanel();
                } else {
                    // adminModule yoksa basit gösterim
                    const adminPanel = document.getElementById('admin-panel');
                    if (adminPanel) {
                        // Tüm sayfaları gizle
                        const elementsToHide = [
                            'main-menu',
                            'quiz',
                            'category-selection',
                            'result',
                            'profile-page',
                            'online-game-options',
                            'global-leaderboard',
                            'friends-page'
                        ];
                        
                        elementsToHide.forEach(id => {
                            const element = document.getElementById(id);
                            if (element) element.style.display = 'none';
                        });
                        
                        // Yönetici panelini göster
                        adminPanel.style.display = 'block';
                    } else {
                        alert('Yönetici paneli şu anda kullanılamıyor.');
                    }
                }
                
                // Hamburger menü ikonunu bars'a geri çevir
                const icon = hamburgerToggle.querySelector('i');
                if (icon) {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            });
            
            // Hamburger menüdeki tema toggle işlevi
            const themeToggle = document.getElementById('checkbox');
            if (themeToggle) {
                themeToggle.addEventListener('change', function() {
                    const theme = this.checked ? 'dark' : 'light';
                    document.documentElement.setAttribute('data-theme', theme);
                    localStorage.setItem('theme', theme);
                    console.log('Tema değiştirildi:', theme);
                });
                
                // Sayfa yüklendiğinde kayıtlı temayı uygula
                const savedTheme = localStorage.getItem('theme') || 'light';
                document.documentElement.setAttribute('data-theme', savedTheme);
                themeToggle.checked = savedTheme === 'dark';
            }
            
            // Hamburger menüdeki ses toggle işlevi
            const soundToggle = document.getElementById('sound-toggle');
            if (soundToggle) {
                soundToggle.addEventListener('change', function() {
                    const soundEnabled = this.checked;
                    
                    // Hem localStorage'a hem de quizApp'e ses ayarını bildir
                    localStorage.setItem('soundEnabled', soundEnabled);
                    console.log('Ses ayarı değiştirildi:', soundEnabled);
                    
                    // quizApp'e doğrudan ses ayarını bildir
                    if (window.quizApp) {
                        window.quizApp.soundEnabled = soundEnabled;
                        
                        // Ayrıca kullanıcı ayarlarını da güncelle
                        if (window.quizApp.userSettings) {
                            window.quizApp.userSettings.soundEnabled = soundEnabled;
                        }
                        
                        // Ayarları kaydet
                        if (typeof window.quizApp.saveUserSettings === 'function') {
                            window.quizApp.saveUserSettings();
                        }
                        
                        console.log('quizApp ses ayarı güncellendi:', soundEnabled);
                    }
                });
                
                // Sayfa yüklendiğinde kayıtlı ses ayarını uygula
                // Önce quizApp'in ses ayarını kontrol et
                let savedSound = null;
                if (window.quizApp && typeof window.quizApp.soundEnabled !== 'undefined') {
                    savedSound = window.quizApp.soundEnabled;
                } else {
                    // quizApp henüz yüklenmediyse localStorage'dan kontrol et
                    const localStorageSound = localStorage.getItem('soundEnabled');
                    if (localStorageSound !== null) {
                        savedSound = localStorageSound === 'true';
                    }
                }
                
                if (savedSound !== null) {
                    soundToggle.checked = savedSound;
                }
            }
            
            // Zorluk seviyesi ayarları kaldırıldı
            
            // Firebase auth state change dinleyicisi
            if (firebase.auth) {
                firebase.auth().onAuthStateChanged(function(user) {
                    const userProfileSection = document.getElementById('user-profile-section');
                    const adminPanelMenuItem = document.getElementById('menu-admin-panel');
                    
                    if (user && !user.isAnonymous) {
                        // Kullanıcı bilgilerini menüde göster
                        userProfileSection.style.display = 'flex';
                        document.getElementById('menu-user-name').textContent = user.displayName || 'Kullanıcı';
                        document.getElementById('menu-user-email').textContent = user.email || '';
                        
                        // quizApp'e kullanıcı bilgilerini aktar
                        if (window.quizApp) {
                            window.quizApp.isLoggedIn = true;
                            window.quizApp.currentUser = user;
                            console.log('QuizApp kullanıcı bilgileri güncellendi');
                            
                            // Kullanıcı verilerini Firebase'den yükle
                            window.quizApp.loadUserData(user.uid);
                        }
                        
                        // Kullanıcıyı Firestore'a kaydet (varsa güncelle)
                        if (firebase.firestore) {
                            firebase.firestore().collection('users').doc(user.uid).set({
                                displayName: user.displayName || '',
                                email: user.email || '',
                                createdAt: user.metadata && user.metadata.creationTime ? new Date(user.metadata.creationTime) : new Date(),
                                disabled: false,
                                displayNameLower: (user.displayName || '').toLowerCase()
                            }, { merge: true });
                        }
                        
                        // Çıkış öğesini göster
                        document.getElementById('menu-logout').style.display = 'flex';
                        document.getElementById('menu-profile').style.display = 'flex';
                        
                        // Yönetici kontrolü yap
                        console.log('Yönetici kontrolü başlatılıyor...');
                        console.log('Firebase firestore var mı?', firebase.firestore ? 'Evet' : 'Hayır');
                        console.log('Kullanıcı ID:', user.uid);
                        console.log('Kullanıcı Email:', user.email);
                        
                        if (firebase.firestore) {
                            // Wet_oner@hotmail.com için özel kontrol
                            if (user.email === 'wet_oner@hotmail.com') {
                                console.log('Wet_oner@hotmail.com tespit edildi - Admin paneli direkt gösteriliyor');
                                adminPanelMenuItem.style.display = 'flex';
                                return;
                            }
                            
                            // Birden fazla ID formatını kontrol et
                            const possibleAdminIds = [
                                user.uid, // Gerçek kullanıcı ID'si
                                user.email?.toLowerCase().replace(/[.@]/g, '_'), // E-posta temizlenmiş
                                user.email?.replace(/[@.]/g, '_'), // Alternatif temizleme
                                'wet_oner_hotmail_com' // Sabit ID
                            ].filter(Boolean);
                            
                            console.log('Kontrol edilecek admin ID\'leri:', possibleAdminIds);
                            
                            // Tüm olası ID'leri kontrol et
                            const adminChecks = possibleAdminIds.map(adminId => 
                                firebase.firestore().collection('admins').doc(adminId).get()
                            );
                            
                            Promise.all(adminChecks)
                                .then((docs) => {
                                    let isAdmin = false;
                                    
                                    docs.forEach((doc, index) => {
                                        console.log(`Admin kontrolü [${possibleAdminIds[index]}]:`, doc.exists);
                                        if (doc.exists) {
                                            isAdmin = true;
                                            console.log('Admin dokuman verisi:', doc.data());
                                        }
                                    });
                                    
                                    if (isAdmin) {
                                        // Kullanıcı yönetici - yönetici paneli menü öğesini göster
                                        adminPanelMenuItem.style.display = 'flex';
                                        console.log('Yönetici kullanıcı tespit edildi - Admin paneli gösteriliyor');
                                    } else {
                                        // Normal kullanıcı - yönetici paneli menü öğesini gizle
                                        adminPanelMenuItem.style.display = 'none';
                                        console.log('Normal kullanıcı - Admin paneli gizleniyor');
                                        
                                        // Wet_oner@hotmail.com ise admin olarak ekle
                                        if (user.email === 'wet_oner@hotmail.com') {
                                            console.log('Wet_oner@hotmail.com admin olarak ekleniyor...');
                                            
                                            const adminId = user.email.toLowerCase().replace(/[.@]/g, '_');
                                            firebase.firestore().collection('admins').doc(adminId).set({
                                                email: user.email,
                                                role: 'admin',
                                                uid: user.uid,
                                                addedAt: firebase.firestore.FieldValue.serverTimestamp(),
                                                addedBy: 'auto_auth_check'
                                            }).then(() => {
                                                console.log('Admin başarıyla eklendi, panel gösteriliyor');
                                                adminPanelMenuItem.style.display = 'flex';
                                            }).catch(err => {
                                                console.error('Admin ekleme hatası:', err);
                                            });
                                        }
                                    }
                                })
                                .catch((error) => {
                                    console.log('Yönetici kontrolü yapılamadı:', error);
                                    console.error('Firestore hatası:', error.code, error.message);
                                    
                                    // Hata durumunda wet_oner@hotmail.com ise paneli göster
                                    if (user.email === 'wet_oner@hotmail.com') {
                                        console.log('Hata durumunda wet_oner@hotmail.com için panel gösteriliyor');
                                        adminPanelMenuItem.style.display = 'flex';
                                    } else {
                                        adminPanelMenuItem.style.display = 'none';
                                    }
                                });
                        } else {
                            console.log('Firebase Firestore mevcut değil!');
                            
                            // Firestore yoksa wet_oner@hotmail.com için paneli göster
                            if (user.email === 'wet_oner@hotmail.com') {
                                console.log('Firestore yok ama wet_oner@hotmail.com için panel gösteriliyor');
                                adminPanelMenuItem.style.display = 'flex';
                            } else {
                                adminPanelMenuItem.style.display = 'none';
                            }
                        }
                    } else {
                        // Kullanıcı bilgilerini gizle
                        userProfileSection.style.display = 'none';
                        
                        // quizApp'i misafir moduna geçir
                        if (window.quizApp) {
                            window.quizApp.isLoggedIn = false;
                            window.quizApp.currentUser = null;
                            console.log('QuizApp misafir moduna geçirildi');
                            
                            // localStorage'dan skor verilerini yükle
                            window.quizApp.loadScoreFromLocalStorage();
                        }
                        
                        // Çıkış butonu her zaman görünsün - mobilde bottom sheet'te var
                        // document.getElementById('menu-logout').style.display = 'none';
                        document.getElementById('menu-profile').style.display = 'none';
                        adminPanelMenuItem.style.display = 'none';
                    }
                });
            }
            
            // Ana menüye dön butonu için olay dinleyici
            const backFromProfileBtn = document.getElementById('back-from-profile');
            if (backFromProfileBtn) {
                backFromProfileBtn.addEventListener('click', function() {
                    // Profil sayfasını gizle
                    const profilePage = document.getElementById('profile-page');
                    if (profilePage) profilePage.style.display = 'none';
                    
                    // Ana menüyü göster
                    const mainMenu = document.getElementById('main-menu');
                    if (mainMenu) mainMenu.style.display = 'block';
                });
            }
            
            // Lider tablosundan ana menüye dön butonu için olay dinleyici
            const backFromLeaderboardBtn = document.getElementById('back-from-leaderboard');
            if (backFromLeaderboardBtn) {
                backFromLeaderboardBtn.addEventListener('click', function() {
                    // Lider tablosunu gizle
                    const leaderboard = document.getElementById('global-leaderboard');
                    if (leaderboard) leaderboard.style.display = 'none';
                    
                    // Ana menüyü göster
                    const mainMenu = document.getElementById('main-menu');
                    if (mainMenu) mainMenu.style.display = 'block';
                });
            }
            
            // Profilden çıkış yapma butonu için olay dinleyici
            const logoutFromProfileBtn = document.getElementById('logout-from-profile');
            if (logoutFromProfileBtn) {
                logoutFromProfileBtn.addEventListener('click', function() {
                    // Firebase ile çıkış yap
                    if (firebase.auth) {
                        firebase.auth().signOut().then(() => {
                            window.location.href = 'login.html';
                        }).catch(error => {
                            console.error("Çıkış yapılırken hata oluştu:", error);
                            alert("Çıkış yapılırken bir hata oluştu");
                        });
                    }
                });
            }
            
            // Çıkış butonu kaldırıldı
            
            // Profil düzenleme butonu için olay dinleyici
            const editProfileBtn = document.getElementById('edit-profile-btn');
            if (editProfileBtn) {
                editProfileBtn.addEventListener('click', function() {
                    alert("Profil düzenleme özelliği yakında eklenecek!");
                });
            }
        });
    </script>

    <script>
        // Sayfa yüklendiğinde, localStorage'da kayıtlı dili kontrol et ve ayarla
        document.addEventListener('DOMContentLoaded', function() {
            // Dil seçimi işleminin quizApp yüklendikten sonra yapılmasını sağla
            setTimeout(function() {
                if (window.quizApp && window.quizApp.currentLanguage) {
                    
                    // HTML lang özelliğini güncelle
                    document.documentElement.setAttribute('lang', window.quizApp.currentLanguage);
                    document.documentElement.setAttribute('data-language', window.quizApp.currentLanguage);
                    
                    // UI'ı güncelle
                    if (typeof window.quizApp.updateUITexts === 'function') {
                        window.quizApp.updateUITexts();
                    }
                    
                    // Ses toggle'ı quizApp'in ses durumuna göre güncelle
                    const soundToggle = document.getElementById('sound-toggle');
                    if (soundToggle && typeof window.quizApp.soundEnabled !== 'undefined') {
                        soundToggle.checked = window.quizApp.soundEnabled;
                        console.log('Ses toggle quizApp durumuna göre güncellendi:', window.quizApp.soundEnabled);
                    }
                }
            }, 500); // quizApp'in yüklenmesi için biraz bekle
        });
    </script>

    <!-- Joker Mağazası Modal -->
    <div id="joker-store-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-store"></i> Joker Mağazası</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="joker-store-points">
                    <i class="fas fa-coins"></i> Puanınız: <span id="joker-store-points-display">0</span>
                </div>
                <div class="joker-store-items">
                    <div class="joker-store-item" data-joker="fifty" data-price="10">
                        <div class="joker-icon"><i class="fas fa-star-half-alt"></i></div>
                        <div class="joker-info">
                            <h3>50:50 Joker</h3>
                            <p>İki yanlış şıkkı eleme</p>
                            <div class="joker-price">10 <i class="fas fa-coins"></i></div>
                        </div>
                        <div class="joker-count">Sahip olduğunuz: <span class="joker-owned-count">0</span></div>
                        <button class="joker-buy-btn">Satın Al</button>
                    </div>
                    <div class="joker-store-item" data-joker="hint" data-price="15">
                        <div class="joker-icon"><i class="fas fa-lightbulb"></i></div>
                        <div class="joker-info">
                            <h3>İpucu Joker</h3>
                            <p>Doğru cevap hakkında ipucu al</p>
                            <div class="joker-price">15 <i class="fas fa-coins"></i></div>
                        </div>
                        <div class="joker-count">Sahip olduğunuz: <span class="joker-owned-count">0</span></div>
                        <button class="joker-buy-btn">Satın Al</button>
                    </div>
                    <div class="joker-store-item" data-joker="time" data-price="20">
                        <div class="joker-icon"><i class="fas fa-clock"></i></div>
                        <div class="joker-info">
                            <h3>Süre Joker</h3>
                            <p>Bu soru için 15 saniye ekle</p>
                            <div class="joker-price">20 <i class="fas fa-coins"></i></div>
                        </div>
                        <div class="joker-count">Sahip olduğunuz: <span class="joker-owned-count">0</span></div>
                        <button class="joker-buy-btn">Satın Al</button>
                    </div>
                    <div class="joker-store-item" data-joker="skip" data-price="25">
                        <div class="joker-icon"><i class="fas fa-forward"></i></div>
                        <div class="joker-info">
                            <h3>Pas Joker</h3>
                            <p>Bu soruyu pas geç ve can kaybetme</p>
                            <div class="joker-price">25 <i class="fas fa-coins"></i></div>
                        </div>
                        <div class="joker-count">Sahip olduğunuz: <span class="joker-owned-count">0</span></div>
                        <button class="joker-buy-btn">Satın Al</button>
                    </div>
                    <div class="joker-store-item lives-item" data-joker="lives" data-price="15" data-currency="stars">
                        <div class="joker-icon"><i class="fas fa-heart"></i></div>
                        <div class="joker-info">
                            <h3>Can Paketi</h3>
                            <p>3 adet can satın al</p>
                            <div class="joker-price">15 <span class="star-icon">⭐</span></div>
                        </div>
                        <div class="joker-count">Mevcut canınız: <span class="lives-count">3</span></div>
                        <button class="lives-buy-btn">Satın Al</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Kuralları Modal -->
    <div id="chat-rules-modal" class="chat-rules-modal">
        <div class="chat-rules-content">
            <div class="chat-rules-header">
                <h3><i class="fas fa-comments"></i> Sohbet Kuralları ve Gizlilik Bildirimi</h3>
                <button id="close-chat-rules" class="chat-rules-close">&times;</button>
            </div>
            <div class="chat-rules-body">
                <h4>Kişisel Veri ve KVKK/GDPR Bildirimi</h4>
                <p>Bu uygulamada gönderdiğiniz mesajlar, 6698 sayılı Kişisel Verilerin Korunması Kanunu (KVKK) ve AB Genel Veri Koruma Yönetmeliği (GDPR) kapsamında kişisel veri olarak değerlendirilmektedir.</p>
                
                <h4>Veri Saklama Politikası</h4>
                <ul>
                    <li>Mesajlarınız, oyun tamamlandıktan sonra en fazla 30 gün süreyle saklanabilir.</li>
                    <li>Mesajlarınız, güvenli sunucularda şifrelenmiş olarak saklanmaktadır.</li>
                    <li>Mesajların içeriği, yalnızca yasal zorunluluklar olması halinde yetkili mercilerle paylaşılabilir.</li>
                </ul>
                
                <h4>Uyulması Gereken Kurallar</h4>
                <ul>
                    <li>Kişisel bilgilerinizi (isim, adres, telefon, e-posta vb.) sohbet kısmında paylaşmayınız.</li>
                    <li>Hakaret, küfür ve uygunsuz içerikler paylaşılması yasaktır.</li>
                    <li>Irkçı, cinsiyetçi, ayrımcı ve nefret söylemi içeren mesajlar göndermek yasaktır.</li>
                    <li>Diğer oyuncuları rahatsız edici davranışlarda bulunmak yasaktır.</li>
                    <li>Yasadışı faaliyetleri teşvik eden mesajlar göndermek yasaktır.</li>
                </ul>
                
                <h4>Kural İhlalleri ve Sonuçları</h4>
                <p>Kurallara uymayan mesajlar, diğer kullanıcılar tarafından bildirilebilir ve gerekli durumda şu işlemler uygulanabilir:</p>
                <ul>
                    <li>Mesajın kaldırılması</li>
                    <li>Geçici olarak sohbet özelliğinin engellenmesi</li>
                    <li>Hesabın kalıcı olarak engellenmesi</li>
                    <li>Gerekli durumlarda yasal yollara başvurulması</li>
                </ul>
                
                <h4>Haklarınız</h4>
                <p>KVKK ve GDPR kapsamında, kişisel verilerinize ilişkin şu haklara sahipsiniz:</p>
                <ul>
                    <li>Kişisel verilerinizin işlenip işlenmediğini öğrenme</li>
                    <li>Kişisel verileriniz işlenmişse buna ilişkin bilgi talep etme</li>
                    <li>Kişisel verilerinizin silinmesini veya yok edilmesini isteme</li>
                </ul>
                <p>Bu haklarınızı kullanmak için <a href="mailto:contact@example.com">contact@example.com</a> adresine e-posta gönderebilirsiniz.</p>
            </div>
            <div class="chat-rules-footer">
                <button id="accept-rules-btn">Anladım ve Kabul Ediyorum</button>
            </div>
        </div>
    </div>

    <!-- Yönetici Paneli -->
    <div id="admin-panel" class="admin-panel" style="display: none;">
        <div class="admin-panel-header">
            <h2><i class="fas fa-shield-alt"></i> Yönetici Paneli</h2>
            <button id="close-admin-panel" class="close-btn"><i class="fas fa-times"></i></button>
        </div>
        
        <div class="admin-tabs">
            <button class="admin-tab-btn active" data-tab="dashboard">Dashboard</button>
            <button class="admin-tab-btn" data-tab="users">Kullanıcılar</button>
            <button class="admin-tab-btn" data-tab="questions">Sorular</button>
            <button class="admin-tab-btn" data-tab="pending-questions">Bekleyen Sorular</button>
            <button class="admin-tab-btn" data-tab="reports">Şikayetler</button>
            <button class="admin-tab-btn" data-tab="settings">Ayarlar</button>
        </div>
        
        <div class="admin-content">
            <!-- Kontrol Paneli -->
            <div id="admin-dashboard" class="admin-tab-content active">
                <div class="admin-stats-cards">
                    <div class="admin-stat-card">
                        <div class="stat-icon"><i class="fas fa-users"></i></div>
                        <div class="stat-value" id="admin-total-users">0</div>
                        <div class="stat-label">Toplam Kullanıcı</div>
                    </div>
                    <div class="admin-stat-card">
                        <div class="stat-icon"><i class="fas fa-question-circle"></i></div>
                        <div class="stat-value" id="admin-total-questions">0</div>
                        <div class="stat-label">Toplam Soru</div>
                    </div>
                    <div class="admin-stat-card">
                        <div class="stat-icon"><i class="fas fa-gamepad"></i></div>
                        <div class="stat-value" id="admin-total-games">0</div>
                        <div class="stat-label">Toplam Oyun</div>
                    </div>
                    <div class="admin-stat-card">
                        <div class="stat-icon"><i class="fas fa-exclamation-triangle"></i></div>
                        <div class="stat-value" id="admin-pending-reports">0</div>
                        <div class="stat-label">Bekleyen Şikayet</div>
                    </div>
                </div>
                
                <div class="admin-recent-activity">
                    <h3>Son Aktiviteler</h3>
                    <div class="admin-activity-list" id="admin-activity-list">
                        <!-- Aktiviteler buraya yüklenecek -->
                    </div>
                </div>
            </div>
            
            <!-- Kullanıcılar -->
            <div id="admin-users" class="admin-tab-content">
                <div class="admin-search-box">
                    <input type="text" id="admin-user-search" placeholder="Kullanıcı ara...">
                    <button id="admin-user-search-btn" class="admin-btn-secondary"><i class="fas fa-search"></i></button>
                </div>
                
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Kullanıcı Adı</th>
                            <th>E-posta</th>
                            <th>Kayıt Tarihi</th>
                            <th>Durum</th>
                            <th>İşlemler</th>
                        </tr>
                    </thead>
                    <tbody id="admin-users-list">
                        <!-- Kullanıcılar burada listelenecek -->
                    </tbody>
                </table>
                
                <div class="admin-pagination">
                    <button id="admin-prev-page" class="admin-btn-secondary"><i class="fas fa-chevron-left"></i></button>
                    <span id="admin-current-page">Sayfa 1</span>
                    <button id="admin-next-page" class="admin-btn-secondary"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
            
            <!-- Sorular -->
            <div id="admin-questions" class="admin-tab-content">
                <div class="admin-actions">
                    <button id="admin-add-question" class="admin-action-btn"><i class="fas fa-plus"></i> Yeni Soru Ekle</button>
                    <button id="admin-import-questions" class="admin-action-btn"><i class="fas fa-file-import"></i> İçe Aktar</button>
                    <button id="admin-export-questions" class="admin-action-btn"><i class="fas fa-file-export"></i> Dışa Aktar</button>
                </div>
                
                <div class="admin-search-box">
                    <select id="admin-question-category">
                        <option value="all">Tüm Kategoriler</option>
                    </select>
                    <input type="text" id="admin-question-search" placeholder="Soru ara...">
                    <button id="admin-question-search-btn" class="admin-btn-secondary"><i class="fas fa-search"></i></button>
                </div>
                
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Soru</th>
                            <th>Kategori</th>
                            <th>Zorluk</th>
                            <th>Ekleyen</th>
                            <th>İşlemler</th>
                        </tr>
                    </thead>
                    <tbody id="admin-questions-list">
                        <!-- Sorular buraya yüklenecek -->
                    </tbody>
                </table>
                
                <div class="admin-pagination">
                    <button id="admin-prev-question-page" class="admin-btn-secondary"><i class="fas fa-chevron-left"></i></button>
                    <span id="admin-current-question-page">Sayfa 1</span>
                    <button id="admin-next-question-page" class="admin-btn-secondary"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
            
            <!-- Bekleyen Sorular -->
            <div id="admin-pending-questions" class="admin-tab-content">
                <div class="admin-tab-header">
                    <h3>Bekleyen Sorular</h3>
                    <div class="admin-filter">
                        <button id="admin-refresh-pending" class="admin-btn-secondary">
                            <i class="fas fa-sync-alt"></i> Yenile
                        </button>
                    </div>
                </div>
                
                <div id="admin-pending-questions-list" class="admin-pending-questions-list">
                    <!-- Bekleyen sorular burada listelenecek -->
                </div>
            </div>
            
            <!-- Şikayetler -->
            <div id="admin-reports" class="admin-tab-content">
                <div class="admin-tab-header">
                    <h3>Şikayet Yönetimi</h3>
                    <div class="admin-filter">
                        <label for="admin-report-filter">Filtrele:</label>
                        <select id="admin-report-filter">
                            <option value="all">Tümü</option>
                            <option value="pending">Bekleyen</option>
                            <option value="resolved">Çözülmüş</option>
                            <option value="rejected">Reddedilmiş</option>
                        </select>
                    </div>
                </div>
                
                <div id="admin-reports-list" class="admin-reports-list">
                    <!-- Şikayetler burada listelenecek -->
                </div>
            </div>
            
            <!-- Ayarlar -->
            <div id="admin-settings" class="admin-tab-content">
                <div class="admin-settings-section">
                    <h3>Genel Ayarlar</h3>
                    <div class="admin-setting-item">
                        <label for="admin-maintenance-mode">Bakım Modu:</label>
                        <label class="admin-toggle">
                            <input type="checkbox" id="admin-maintenance-mode">
                            <span class="admin-toggle-slider"></span>
                        </label>
                    </div>
                    
                    <div class="admin-setting-item">
                        <label for="admin-allow-registrations">Yeni Kayıtlara İzin Ver:</label>
                        <label class="admin-toggle">
                            <input type="checkbox" id="admin-allow-registrations" checked>
                            <span class="admin-toggle-slider"></span>
                        </label>
                    </div>
                    
                    <div class="admin-setting-item">
                        <label for="admin-question-approval">Soru Onayı Gerekli:</label>
                        <label class="admin-toggle">
                            <input type="checkbox" id="admin-question-approval" checked>
                            <span class="admin-toggle-slider"></span>
                        </label>
                    </div>
                    
                    <div class="admin-setting-item">
                        <label for="admin-max-failed-login">Maksimum Başarısız Giriş:</label>
                        <input type="number" id="admin-max-failed-login" value="5" min="1" max="10">
                    </div>
                </div>
                
                <div class="admin-settings-section">
                    <h3>E-posta Bildirimleri</h3>
                    <div class="admin-setting-item">
                        <label for="admin-email-new-user">Yeni Kullanıcı Kaydı:</label>
                        <label class="admin-toggle">
                            <input type="checkbox" id="admin-email-new-user" checked>
                            <span class="admin-toggle-slider"></span>
                        </label>
                    </div>
                    
                    <div class="admin-setting-item">
                        <label for="admin-email-new-report">Yeni Şikayet:</label>
                        <label class="admin-toggle">
                            <input type="checkbox" id="admin-email-new-report" checked>
                            <span class="admin-toggle-slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="admin-settings-actions">
                    <button id="admin-save-settings" class="admin-btn-primary">Ayarları Kaydet</button>
                    <button id="admin-reset-settings" class="admin-btn-secondary">Varsayılana Sıfırla</button>
                    <button id="admin-export-settings" class="admin-btn-secondary" onclick="exportSettings()" style="background: #17a2b8;">
                        <i class="fas fa-download"></i> Dışa Aktar
                    </button>
                    <button id="admin-import-settings" class="admin-btn-secondary" onclick="importSettings()" style="background: #6f42c1;">
                        <i class="fas fa-upload"></i> İçe Aktar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bu kısım silinebilir çünkü aynı kod daha önce sayfada zaten eklenmiş -->
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'GA_MEASUREMENT_ID');
    </script>
    
    <!-- Meta Pixel -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', 'YOUR_PIXEL_ID');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=YOUR_PIXEL_ID&ev=PageView&noscript=1"
    /></noscript>

    <script>
        // Manuel admin panel gösterme fonksiyonu (debugging için)
        window.showAdminPanelManual = function() {
            const adminPanelMenuItem = document.getElementById('menu-admin-panel');
            if (adminPanelMenuItem) {
                adminPanelMenuItem.style.display = 'flex';
                console.log('Admin panel manuel olarak gösterildi');
            } else {
                console.error('Admin panel menü öğesi bulunamadı!');
            }
        };
        
        // Admin koleksiyonuna kullanıcı ekleme fonksiyonu (debugging için)
        window.addUserToAdmins = function(userId) {
            if (!userId && firebase.auth && firebase.auth().currentUser) {
                userId = firebase.auth().currentUser.uid;
            }
            
            if (!userId) {
                console.error('Kullanıcı ID belirtilmedi ve aktif kullanıcı bulunamadı');
                return;
            }
            
            if (firebase.firestore) {
                firebase.firestore().collection('admins').doc(userId).set({
                    email: firebase.auth().currentUser ? firebase.auth().currentUser.email : 'test@admin.com',
                    role: 'admin',
                    addedAt: firebase.firestore.FieldValue.serverTimestamp()
                }).then(() => {
                    console.log('Kullanıcı admin koleksiyonuna eklendi:', userId);
                    alert('Admin yetkisi verildi! Sayfayı yenileyin.');
                }).catch((error) => {
                    console.error('Admin ekleme hatası:', error);
                    alert('Admin ekleme başarısız: ' + error.message);
                });
            } else {
                console.error('Firestore mevcut değil!');
            }
        };
        
        // E-posta adresiyle kullanıcıyı admin yapma fonksiyonu
        window.addUserToAdminsByEmail = function(email) {
            if (!email) {
                console.error('E-posta adresi belirtilmedi');
                return;
            }
            
            if (!firebase.firestore) {
                console.error('Firestore mevcut değil!');
                return;
            }
            
            console.log('E-posta adresiyle kullanıcı aranıyor:', email);
            
            // Kullanıcıları e-posta adresine göre ara
            firebase.firestore().collection('users').where('email', '==', email).get()
                .then((querySnapshot) => {
                    if (querySnapshot.empty) {
                        console.log('Bu e-posta adresiyle kullanıcı bulunamadı:', email);
                        
                        // Alternatif olarak direkt e-posta ile admin koleksiyonuna ekle
                        const adminId = email.replace(/[.@]/g, '_'); // E-posta adresini ID'ye çevir
                        
                        return firebase.firestore().collection('admins').doc(adminId).set({
                            email: email,
                            role: 'admin',
                            addedAt: firebase.firestore.FieldValue.serverTimestamp(),
                            addedBy: 'manual',
                            note: 'E-posta adresi ile manuel olarak eklendi'
                        });
                    } else {
                        // Kullanıcı bulundu, admin koleksiyonuna ekle
                        const userDoc = querySnapshot.docs[0];
                        const userData = userDoc.data();
                        const userId = userDoc.id;
                        
                        console.log('Kullanıcı bulundu:', userData);
                        
                        return firebase.firestore().collection('admins').doc(userId).set({
                            email: email,
                            role: 'admin',
                            displayName: userData.displayName || userData.name || 'Admin',
                            addedAt: firebase.firestore.FieldValue.serverTimestamp(),
                            addedBy: 'manual'
                        });
                    }
                })
                .then(() => {
                    console.log('Kullanıcı admin koleksiyonuna eklendi:', email);
                    alert('Admin yetkisi verildi: ' + email + '\nSayfayı yenileyin.');
                })
                .catch((error) => {
                    console.error('Admin ekleme hatası:', error);
                    
                    // Hata durumunda alternatif yöntem - direkt UID ile ekle
                    console.log('Alternatif yöntem deneniyor...');
                    
                    // E-posta adresini temizle ve UID benzeri string oluştur
                    const cleanEmail = email.toLowerCase().replace(/[.@]/g, '_');
                    
                    firebase.firestore().collection('admins').doc(cleanEmail).set({
                        email: email,
                        role: 'admin',
                        addedAt: firebase.firestore.FieldValue.serverTimestamp(),
                        addedBy: 'manual_fallback',
                        note: 'E-posta adresi ile fallback yöntemiyle eklendi'
                    }).then(() => {
                        console.log('Kullanıcı fallback yöntemiyle admin yapıldı:', email);
                        alert('Admin yetkisi verildi (alternatif yöntem): ' + email);
                    }).catch((fallbackError) => {
                        console.error('Fallback admin ekleme hatası:', fallbackError);
                        alert('Admin ekleme başarısız: ' + fallbackError.message);
                    });
                });
        };
        
        // Wet_oner@hotmail.com adresini admin yap
        window.makeWetOnerAdmin = function() {
            addUserToAdminsByEmail('wet_oner@hotmail.com');
        };
        
        // Sayfa yüklendiğinde otomatik admin kontrolü ve ekleme
        document.addEventListener('DOMContentLoaded', function() {
            // Firebase yüklendikten sonra admin kontrolü yap
            setTimeout(function() {
                if (firebase.firestore) {
                    console.log('Otomatik admin kontrolü başlatılıyor...');
                    
                    // Önce wet_oner@hotmail.com'un admin olup olmadığını kontrol et
                    const adminEmails = ['wet_oner@hotmail.com'];
                    
                    adminEmails.forEach(email => {
                        const cleanEmail = email.toLowerCase().replace(/[.@]/g, '_');
                        
                        firebase.firestore().collection('admins').doc(cleanEmail).get()
                            .then((doc) => {
                                if (!doc.exists) {
                                    console.log('Admin kaydı bulunamadı, ekleniyor:', email);
                                    
                                    // Admin olarak ekle
                                    return firebase.firestore().collection('admins').doc(cleanEmail).set({
                                        email: email,
                                        role: 'admin',
                                        addedAt: firebase.firestore.FieldValue.serverTimestamp(),
                                        addedBy: 'auto_setup',
                                        displayName: 'Admin',
                                        note: 'Otomatik olarak eklendi'
                                    });
                                } else {
                                    console.log('Admin kaydı zaten mevcut:', email);
                                    return Promise.resolve();
                                }
                            })
                            .then(() => {
                                console.log('Admin kontrolü tamamlandı:', email);
                                
                                // Eğer mevcut kullanıcı bu e-posta adresiyse, admin panelini hemen göster
                                if (firebase.auth().currentUser && 
                                    firebase.auth().currentUser.email === email) {
                                    
                                    setTimeout(() => {
                                        const adminPanelMenuItem = document.getElementById('menu-admin-panel');
                                        if (adminPanelMenuItem) {
                                            adminPanelMenuItem.style.display = 'flex';
                                            console.log('Admin paneli otomatik olarak gösterildi');
                                        }
                                    }, 1000);
                                }
                            })
                            .catch((error) => {
                                console.error('Otomatik admin ekleme hatası:', error);
                                
                                // Alternatif ID ile dene
                                const altId = email.replace(/[@.]/g, '_');
                                firebase.firestore().collection('admins').doc(altId).set({
                                    email: email,
                                    role: 'admin',
                                    addedAt: firebase.firestore.FieldValue.serverTimestamp(),
                                    addedBy: 'auto_setup_fallback'
                                }).then(() => {
                                    console.log('Admin fallback yöntemiyle eklendi:', email);
                                }).catch(err => {
                                    console.error('Fallback admin ekleme hatası:', err);
                                });
                            });
                    });
                } else {
                    console.log('Firebase Firestore henüz hazır değil, tekrar denenecek...');
                    
                    // Firebase hazır değilse 2 saniye sonra tekrar dene
                    setTimeout(arguments.callee, 2000);
                }
            }, 2000); // Sayfa yüklendikten 2 saniye sonra kontrol et
        });
        
        // Wet_oner@hotmail.com için zorla admin paneli göster
        window.forceShowAdminPanel = function() {
            const adminPanelMenuItem = document.getElementById('menu-admin-panel');
            if (adminPanelMenuItem) {
                adminPanelMenuItem.style.display = 'flex';
                adminPanelMenuItem.style.visibility = 'visible';
                adminPanelMenuItem.style.opacity = '1';
                console.log('Admin panel zorla gösterildi');
                
                // Ayrıca element'i DOM'da en üste taşı
                const menuSection = adminPanelMenuItem.parentElement;
                if (menuSection) {
                    menuSection.appendChild(adminPanelMenuItem);
                }
                
                alert('Admin panel zorla gösterildi! Hamburger menüsünü kontrol edin.');
            } else {
                console.error('Admin panel menü öğesi bulunamadı!');
                alert('Admin panel elementi bulunamadı!');
            }
        };
        
        // Sayfa yüklendiğinde wet_oner@hotmail.com kontrolü
        window.checkCurrentUserForAdmin = function() {
            if (firebase.auth && firebase.auth().currentUser) {
                const user = firebase.auth().currentUser;
                console.log('Mevcut kullanıcı kontrolü:', user.email);
                
                if (user.email === 'wet_oner@hotmail.com') {
                    console.log('Wet_oner@hotmail.com tespit edildi, admin panel gösteriliyor');
                    const adminPanelMenuItem = document.getElementById('menu-admin-panel');
                    if (adminPanelMenuItem) {
                        adminPanelMenuItem.style.display = 'flex';
                        console.log('Admin panel başarıyla gösterildi');
                    }
                }
            } else {
                console.log('Henüz giriş yapılmamış');
            }
        };
        
        // Admin Panel İşlevleri
        document.addEventListener('DOMContentLoaded', function() {
            // Admin panel initialization
            initializeAdminPanel();
            
            // Admin panel kapatma
            const closeAdminPanel = document.getElementById('close-admin-panel');
            if (closeAdminPanel) {
                closeAdminPanel.addEventListener('click', function() {
                    const adminPanel = document.getElementById('admin-panel');
                    if (adminPanel) {
                        adminPanel.style.display = 'none';
                    }
                    
                    // Ana menüyü göster
                    const mainMenu = document.getElementById('main-menu');
                    if (mainMenu) {
                        mainMenu.style.display = 'block';
                    }
                });
            }

            // Admin tab switching
            const adminTabBtns = document.querySelectorAll('.admin-tab-btn');
            const adminTabContents = document.querySelectorAll('.admin-tab-content');

            adminTabBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    
                    // Remove active class from all tabs and contents
                    adminTabBtns.forEach(b => b.classList.remove('active'));
                    adminTabContents.forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked tab and corresponding content
                    this.classList.add('active');
                    const targetContent = document.getElementById(`admin-${tabName}`);
                    if (targetContent) {
                        targetContent.classList.add('active');
                    }
                    
                    // Load content based on tab
                    loadAdminTabContent(tabName);
                });
            });

            // Soru ekle butonları
            const showStatsBtn = document.getElementById('show-stats');
            const addQuestionBtn = document.getElementById('add-question-button');
            const addQuestionModal = document.getElementById('add-question-form');
            const closeModalBtn = addQuestionModal?.querySelector('.close');

            // İstatistikler butonu
            if (showStatsBtn) {
                showStatsBtn.addEventListener('click', function() {
                    showStatistics();
                });
            }
            
            // İstatistikler sayfası geri butonu
            const backFromStatsBtn = document.getElementById('back-from-stats');
            if (backFromStatsBtn) {
                backFromStatsBtn.addEventListener('click', function() {
                    hideStatistics();
                });
            }
            
            // Ana menüdeki Küresel Skor Tablosu butonu
            const globalLeaderboardBtn = document.getElementById('view-global-leaderboard');
            if (globalLeaderboardBtn) {
                globalLeaderboardBtn.addEventListener('click', function() {
                    console.log('Küresel Skor Tablosu butonu tıklandı');
                    
                    // Tüm sayfaları gizle
                    const elementsToHide = [
                        'main-menu',
                        'quiz',
                        'category-selection',
                        'result',
                        'profile-page',
                        'online-game-options',
                        'friends-page',
                        'admin-panel',
                        'statistics-page'
                    ];
                    
                    elementsToHide.forEach(id => {
                        const element = document.getElementById(id);
                        if (element) element.style.display = 'none';
                    });
                    
                    // Lider tablosunu göster
                    const globalLeaderboard = document.getElementById('global-leaderboard');
                    if (globalLeaderboard) {
                        globalLeaderboard.style.display = 'block';
                        
                        // Online game modülü varsa onun lider tablosu fonksiyonunu kullan (daha kapsamlı)
                        if (window.onlineGame && typeof window.onlineGame.loadLeaderboard === 'function') {
                            console.log('Online game lider tablosu yükleniyor...');
                            window.onlineGame.loadLeaderboard();
                        } 
                        // QuizApp varsa onun fonksiyonunu kullan
                        else if (typeof quizApp !== 'undefined' && typeof quizApp.loadLeaderboardData === 'function') {
                            console.log('QuizApp lider tablosu yükleniyor...');
                            quizApp.loadLeaderboardData();
                        }
                        else {
                            // Hiçbiri yoksa basit mesaj göster
                            const leaderboardList = document.getElementById('leaderboard-list');
                            if (leaderboardList) {
                                leaderboardList.innerHTML = '<div class="loading-message">Lider tablosu yükleniyor...</div>';
                            }
                        }
                    } else {
                        alert('Lider tablosu sayfası bulunamadı.');
                    }
                });
            }

            // Soru ekle butonu
            if (addQuestionBtn) {
                addQuestionBtn.addEventListener('click', function() {
                    if (addQuestionModal) {
                        addQuestionModal.style.display = 'block';
                    }
                });
            }

            // Modal kapatma
            if (closeModalBtn) {
                closeModalBtn.addEventListener('click', function() {
                    addQuestionModal.style.display = 'none';
                });
            }

            // Modal dışına tıklayınca kapat
            if (addQuestionModal) {
                addQuestionModal.addEventListener('click', function(e) {
                    if (e.target === addQuestionModal) {
                        addQuestionModal.style.display = 'none';
                    }
                });
            }

            // Soru ekleme formu
            const questionForm = document.getElementById('question-form');
            if (questionForm) {
                questionForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    submitNewQuestion();
                });
            }

            // Yenile butonu için olay dinleyici
            const refreshPendingBtn = document.getElementById('admin-refresh-pending');
            if (refreshPendingBtn) {
                refreshPendingBtn.addEventListener('click', function() {
                    console.log('Bekleyen sorular yenileniyor...');
                    loadPendingQuestionsData();
                });
            }

            // Kullanıcı arama butonları için olay dinleyici
            const userSearchBtn = document.getElementById('admin-user-search-btn');
            const userSearchInput = document.getElementById('admin-user-search');
            if (userSearchBtn && userSearchInput) {
                userSearchBtn.addEventListener('click', function() {
                    searchUsers();
                });
                
                userSearchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        searchUsers();
                    }
                });
            }

            // Şikayet filtresi için olay dinleyici
            const reportFilter = document.getElementById('admin-report-filter');
            if (reportFilter) {
                reportFilter.addEventListener('change', function() {
                    loadReportsData(); // Filtre değiştiğinde verileri yeniden yükle
                });
            }

            // Ayarlar butonları için olay dinleyiciler
            const saveSettingsBtn = document.getElementById('admin-save-settings');
            const resetSettingsBtn = document.getElementById('admin-reset-settings');
            
            if (saveSettingsBtn) {
                saveSettingsBtn.addEventListener('click', function() {
                    saveAdminSettings();
                });
            }
            
            if (resetSettingsBtn) {
                resetSettingsBtn.addEventListener('click', function() {
                    resetAdminSettings();
                });
            }

            // Ayar değişikliklerini takip etmek için
            setupSettingsChangeTracking();

            // SORULAR YÖNETİMİ EVENT LİSTENER'LARI
            // Yeni soru ekle butonu
            const adminAddQuestionBtn = document.getElementById('admin-add-question');
            if (adminAddQuestionBtn) {
                adminAddQuestionBtn.addEventListener('click', function() {
                    showAddQuestionModal();
                });
            }

            // Soruları içe aktar butonu
            const adminImportQuestionsBtn = document.getElementById('admin-import-questions');
            if (adminImportQuestionsBtn) {
                adminImportQuestionsBtn.addEventListener('click', function() {
                    importQuestions();
                });
            }

            // Soruları dışa aktar butonu
            const adminExportQuestionsBtn = document.getElementById('admin-export-questions');
            if (adminExportQuestionsBtn) {
                adminExportQuestionsBtn.addEventListener('click', function() {
                    exportQuestions();
                });
            }

            // Soru arama butonu ve enter tuşu
            const adminQuestionSearchBtn = document.getElementById('admin-question-search-btn');
            const adminQuestionSearchInput = document.getElementById('admin-question-search');
            const adminQuestionCategorySelect = document.getElementById('admin-question-category');
            
            if (adminQuestionSearchBtn) {
                adminQuestionSearchBtn.addEventListener('click', function() {
                    searchQuestions();
                });
            }
            
            if (adminQuestionSearchInput) {
                adminQuestionSearchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        searchQuestions();
                    }
                });
            }

            if (adminQuestionCategorySelect) {
                adminQuestionCategorySelect.addEventListener('change', function() {
                    searchQuestions();
                });
            }

            // Sorular sayfalama butonları
            const adminPrevQuestionPageBtn = document.getElementById('admin-prev-question-page');
            const adminNextQuestionPageBtn = document.getElementById('admin-next-question-page');
            
            if (adminPrevQuestionPageBtn) {
                adminPrevQuestionPageBtn.addEventListener('click', function() {
                    if (currentQuestionsPage > 1) {
                        currentQuestionsPage--;
                        displayQuestions();
                    }
                });
            }
            
            if (adminNextQuestionPageBtn) {
                adminNextQuestionPageBtn.addEventListener('click', function() {
                    const totalPages = Math.ceil(filteredQuestions.length / questionsPerPage);
                    if (currentQuestionsPage < totalPages) {
                        currentQuestionsPage++;
                        displayQuestions();
                    }
                });
            }
        });

        // İstatistikler sayfasını göster
        function showStatistics() {
            console.log('İstatistikler sayfası açılıyor...');
            
            // Tüm sayfaları gizle
            const elementsToHide = [
                'main-menu',
                'quiz',
                'category-selection',
                'result',
                'profile-page',
                'online-game-options',
                'global-leaderboard',
                'friends-page',
                'admin-panel'
            ];
            
            elementsToHide.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.style.display = 'none';
            });
            
            // İstatistikler sayfasını göster
            const statsPage = document.getElementById('statistics-page');
            if (statsPage) {
                statsPage.style.display = 'block';
                loadStatisticsData();
            } else {
                console.error('İstatistikler sayfası bulunamadı!');
                alert('İstatistikler sayfası şu anda kullanılamıyor.');
            }
        }
        
        // İstatistikler sayfasını gizle
        function hideStatistics() {
            const statsPage = document.getElementById('statistics-page');
            if (statsPage) {
                statsPage.style.display = 'none';
            }
            
            // Ana menüyü göster
            const mainMenu = document.getElementById('main-menu');
            if (mainMenu) {
                mainMenu.style.display = 'block';
            }
        }
        
        // İstatistik verilerini yükle
        function loadStatisticsData() {
            console.log('İstatistik verileri yükleniyor...');
            
            try {
                let stats;
                
                // Önce QuizApp'den gerçek istatistikleri hesapla
                if (window.quizApp && typeof window.quizApp.calculateRealStats === 'function') {
                    console.log('QuizApp calculateRealStats fonksiyonu bulundu, hesaplama yapılıyor...');
                    stats = window.quizApp.calculateRealStats();
                    console.log('QuizApp\'den hesaplanan istatistikler:', stats);
            } else {
                    console.log('QuizApp calculateRealStats fonksiyonu bulunamadı, manuel hesaplama yapılıyor...');
                    // Manuel hesaplama
                    stats = calculateStatsManually();
                    console.log('Manuel hesaplanan istatistikler:', stats);
                }
                
                // Eğer stats hala boş ise fallback
                if (!stats || stats.totalGames === 0) {
                    console.log('İstatistikler boş, localStorage\'dan kontrol ediliyor...');
                    const localStats = localStorage.getItem('userStats');
                    if (localStats) {
                        try {
                        stats = JSON.parse(localStats);
                            console.log('localStorage\'dan alınan istatistikler:', stats);
                        } catch (e) {
                            console.error('localStorage istatistikleri parse edilemedi:', e);
                        }
                    }
                    
                    // Hala boş ise gameHistory'den hesapla
                    if (!stats || stats.totalGames === 0) {
                        console.log('localStorage da boş, gameHistory\'den hesaplama yapılıyor...');
                        stats = calculateStatsFromGameHistory();
                        console.log('gameHistory\'den hesaplanan istatistikler:', stats);
                    }
                }
                
                updateStatisticsUI(stats);
                } catch (error) {
                    console.error('İstatistikler yüklenirken hata:', error);
                    updateStatisticsUI({
                        totalGames: 0,
                        totalQuestions: 0,
                        correctAnswers: 0,
                        highestScore: 0,
                    averageScore: 0,
                    accuracy: 0,
                        categoryStats: {}
                    });
                }
            }

        // Manuel istatistik hesaplama (fallback)
        function calculateStatsManually() {
            console.log('calculateStatsManually çağrıldı');
            return calculateStatsFromGameHistory();
        }

        // GameHistory'den istatistik hesaplama
        function calculateStatsFromGameHistory() {
            console.log('calculateStatsFromGameHistory çağrıldı');
            
            try {
            const gameHistory = JSON.parse(localStorage.getItem('gameHistory')) || [];
                console.log('GameHistory bulundu:', gameHistory.length, 'oyun');
                
            let totalGames = gameHistory.length;
            let totalQuestions = 0;
            let correctAnswers = 0;
            let totalScore = 0;
                let highestScore = 0;
            let categoryStats = {};

            gameHistory.forEach(game => {
                totalQuestions += game.totalQuestions || 0;
                correctAnswers += game.correctAnswers || 0;
                totalScore += game.score || 0;
                    
                    if ((game.score || 0) > highestScore) {
                        highestScore = game.score || 0;
                    }
                
                if (game.category) {
                    if (!categoryStats[game.category]) {
                        categoryStats[game.category] = { total: 0, correct: 0, games: 0 };
                    }
                    categoryStats[game.category].total += game.totalQuestions || 0;
                    categoryStats[game.category].correct += game.correctAnswers || 0;
                    categoryStats[game.category].games++;
                }
            });

                // Eğer gameHistory boşsa, highScores'tan veri al
                if (totalGames === 0) {
                    console.log('GameHistory boş, highScores kontrol ediliyor...');
                    const categories = ['Genel Kültür', 'Bilim', 'Teknoloji', 'Spor', 'Müzik', 'Tarih', 'Coğrafya', 'Sanat'];
                    
                    categories.forEach(category => {
                        const categoryScores = JSON.parse(localStorage.getItem(`highScores_${category}`) || '[]');
                        categoryScores.forEach(score => {
                            if (score.score) {
                                totalGames++;
                                totalScore += score.score;
                                totalQuestions += score.total || 10;
                                correctAnswers += score.score; // Score genellikle doğru cevap sayısıdır
                                
                                if (score.score > highestScore) {
                                    highestScore = score.score;
                                }
                                
                                if (!categoryStats[category]) {
                                    categoryStats[category] = { total: 0, correct: 0, games: 0 };
                                }
                                categoryStats[category].total += score.total || 10;
                                categoryStats[category].correct += score.score;
                                categoryStats[category].games++;
                            }
                        });
                    });
                }

                const stats = {
                totalGames,
                totalQuestions,
                correctAnswers,
                totalScore,
                    highestScore,
                averageScore: totalGames > 0 ? Math.round(totalScore / totalGames) : 0,
                accuracy: totalQuestions > 0 ? Math.round((correctAnswers / totalQuestions) * 100) : 0,
                categoryStats
            };

                console.log('Hesaplanan final istatistikler:', stats);
                return stats;
            } catch (error) {
                console.error('İstatistik hesaplama hatası:', error);
                return {
                    totalGames: 0,
                    totalQuestions: 0,
                    correctAnswers: 0,
                    totalScore: 0,
                    highestScore: 0,
                    averageScore: 0,
                    accuracy: 0,
                    categoryStats: {}
                };
            }
        }
        
        // İstatistik UI'sını güncelle
        function updateStatisticsUI(stats) {
            console.log('İstatistik UI güncelleniyor:', stats);
            
            // Genel istatistikler
            const totalGames = stats.totalGames || 0;
            const totalQuestions = stats.totalQuestions || 0;
            const correctAnswers = stats.correctAnswers || 0;
            const highestScore = stats.highestScore || 0;
            
            // Doğruluk oranını hesapla
            const accuracy = totalQuestions > 0 ? Math.round((correctAnswers / totalQuestions) * 100) : 0;
            const averageScore = totalGames > 0 ? Math.round(highestScore / totalGames) : 0;
            
            // UI elementlerini güncelle
            const totalGamesEl = document.getElementById('total-games-stat');
            const totalQuestionsEl = document.getElementById('total-questions-stat');
            const correctAnswersEl = document.getElementById('correct-answers-stat');
            const accuracyEl = document.getElementById('accuracy-stat');
            const highestScoreEl = document.getElementById('highest-score-stat');
            const averageScoreEl = document.getElementById('average-score-stat');
            
            if (totalGamesEl) totalGamesEl.textContent = totalGames;
            if (totalQuestionsEl) totalQuestionsEl.textContent = totalQuestions;
            if (correctAnswersEl) correctAnswersEl.textContent = correctAnswers;
            if (accuracyEl) accuracyEl.textContent = '%' + accuracy;
            if (highestScoreEl) highestScoreEl.textContent = highestScore;
            if (averageScoreEl) averageScoreEl.textContent = averageScore;
            
            console.log('İstatistik UI elementleri güncellendi:', {
                totalGames, totalQuestions, correctAnswers, accuracy, highestScore, averageScore
            });
            
            // Kategori istatistiklerini güncelle
            updateCategoryStats(stats.categoryStats || {});
            
            // Son oyunları yükle
            loadRecentGames();
            
            // Grafikleri çiz
            drawStatisticsCharts(stats);
        }
        
        // Kategori istatistiklerini güncelle
        function updateCategoryStats(categoryStats) {
            const categoryContainer = document.getElementById('category-stats');
            if (!categoryContainer) return;
            
            categoryContainer.innerHTML = '';
            
            if (Object.keys(categoryStats).length === 0) {
                categoryContainer.innerHTML = '<p class="empty-message">Henüz kategori istatistiği bulunmuyor.</p>';
                return;
            }
            
            Object.entries(categoryStats).forEach(([category, data]) => {
                const accuracy = data.total > 0 ? Math.round((data.correct / data.total) * 100) : 0;
                
                const categoryItem = document.createElement('div');
                categoryItem.className = 'category-stat-item';
                categoryItem.innerHTML = `
                    <div class="category-info">
                        <h4>${category}</h4>
                        <div class="category-details">
                            <span>Oynanmış: ${data.total || 0} soru</span>
                            <span>Doğru: ${data.correct || 0}</span>
                            <span>Başarı: %${accuracy}</span>
                        </div>
                    </div>
                    <div class="category-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${accuracy}%"></div>
                        </div>
                    </div>
                `;
                
                categoryContainer.appendChild(categoryItem);
            });
        }
        
        // Son oyunları yükle
        function loadRecentGames() {
            const recentGamesContainer = document.getElementById('recent-games');
            if (!recentGamesContainer) return;
            
            try {
                const gameHistory = JSON.parse(localStorage.getItem('gameHistory')) || [];
                const recentGames = gameHistory.slice(-5).reverse(); // Son 5 oyun
                
                if (recentGames.length === 0) {
                    recentGamesContainer.innerHTML = '<p class="empty-message">Henüz oyun geçmişi bulunmuyor.</p>';
                    return;
                }
                
                recentGamesContainer.innerHTML = '';
                
                recentGames.forEach((game, index) => {
                    const gameDate = new Date(game.date || Date.now()).toLocaleDateString('tr-TR');
                    const accuracy = game.totalQuestions > 0 ? Math.round((game.correctAnswers / game.totalQuestions) * 100) : 0;
                    
                    const gameItem = document.createElement('div');
                    gameItem.className = 'recent-game-item';
                    gameItem.innerHTML = `
                        <div class="game-info">
                            <h4>${game.category || 'Bilinmeyen Kategori'}</h4>
                            <span class="game-date">${gameDate}</span>
                        </div>
                        <div class="game-results">
                            <span>Skor: ${game.score || 0}</span>
                            <span>Doğru: ${game.correctAnswers || 0}/${game.totalQuestions || 0}</span>
                            <span class="accuracy ${accuracy >= 70 ? 'good' : accuracy >= 50 ? 'average' : 'poor'}">%${accuracy}</span>
                        </div>
                    `;
                    
                    recentGamesContainer.appendChild(gameItem);
                });
            } catch (error) {
                console.error('Son oyunlar yüklenirken hata:', error);
                recentGamesContainer.innerHTML = '<p class="error-message">Son oyunlar yüklenirken bir hata oluştu.</p>';
            }
        }
        
        // İstatistik grafiklerini çiz
        function drawStatisticsCharts(stats) {
            // Chart.js kullanarak grafikleri çiz
            if (typeof Chart === 'undefined') {
                console.warn('Chart.js yüklenmedi, basit grafikler gösteriliyor');
                drawSimpleCharts(stats);
                return;
            }
            
            // Kategori dağılımı pasta grafiği
            const categoryPieCtx = document.getElementById('category-pie-chart');
            if (categoryPieCtx && stats.categoryStats) {
                const categoryData = Object.entries(stats.categoryStats);
                if (categoryData.length > 0) {
                    new Chart(categoryPieCtx, {
                        type: 'pie',
                        data: {
                            labels: categoryData.map(([category, data]) => category),
                            datasets: [{
                                data: categoryData.map(([category, data]) => data.total || 0),
                                backgroundColor: [
                                    '#FF6384',
                                    '#36A2EB',
                                    '#FFCE56',
                                    '#4BC0C0',
                                    '#9966FF',
                                    '#FF9F40',
                                    '#FF6384',
                                    '#C9CBCF'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });
                }
            }
            
            // Performans çizgi grafiği (basit örnek)
            const performanceLineCtx = document.getElementById('performance-line-chart');
            if (performanceLineCtx) {
                // Son 30 günün örnek verisi
                const dates = [];
                const scores = [];
                for (let i = 29; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    dates.push(date.toLocaleDateString('tr-TR', { month: 'short', day: 'numeric' }));
                    scores.push(Math.floor(Math.random() * 100)); // Örnek veri
                }
                
                new Chart(performanceLineCtx, {
                    type: 'line',
                    data: {
                        labels: dates,
                        datasets: [{
                            label: 'Doğruluk Oranı (%)',
                            data: scores,
                            borderColor: '#36A2EB',
                            backgroundColor: 'rgba(54, 162, 235, 0.1)',
                            fill: true,
                            tension: 0.3
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }
        }

        // Basit grafikler çiz (Chart.js olmadan)
        function drawSimpleCharts(stats) {
            try {
                // Kategori dağılımı için basit çubuk grafik
                const categoryPieCtx = document.getElementById('category-pie-chart');
                if (categoryPieCtx && stats.categoryStats) {
                    const categoryData = Object.entries(stats.categoryStats);
                    if (categoryData.length > 0) {
                        categoryPieCtx.innerHTML = '';
                        categoryPieCtx.style.display = 'flex';
                        categoryPieCtx.style.flexDirection = 'column';
                        categoryPieCtx.style.gap = '10px';
                        categoryPieCtx.style.padding = '20px';
                        
                        const maxValue = Math.max(...categoryData.map(([cat, data]) => data.total || 0));
                        
                        categoryData.forEach(([category, data], index) => {
                            const value = data.total || 0;
                            const percentage = maxValue > 0 ? (value / maxValue) * 100 : 0;
                            const colors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40'];
                            const color = colors[index % colors.length];
                            
                            const barContainer = document.createElement('div');
                            barContainer.style.cssText = `
                                display: flex;
                                align-items: center;
                                margin-bottom: 8px;
                            `;
                            
                            barContainer.innerHTML = `
                                <div style="width: 100px; font-size: 12px; margin-right: 10px;">${category}</div>
                                <div style="flex: 1; background: #f0f0f0; border-radius: 10px; height: 20px; position: relative;">
                                    <div style="background: ${color}; height: 100%; width: ${percentage}%; border-radius: 10px; transition: width 0.3s ease;"></div>
                                </div>
                                <div style="margin-left: 10px; font-size: 12px; font-weight: bold;">${value}</div>
                            `;
                            
                            categoryPieCtx.appendChild(barContainer);
                        });
                    }
                }
                
                // Performans çizgi grafiği için basit çizgi
                const performanceLineCtx = document.getElementById('performance-line-chart');
                if (performanceLineCtx) {
                    performanceLineCtx.innerHTML = '';
                    performanceLineCtx.style.display = 'flex';
                    performanceLineCtx.style.alignItems = 'center';
                    performanceLineCtx.style.justifyContent = 'center';
                    performanceLineCtx.style.height = '200px';
                    performanceLineCtx.style.background = 'linear-gradient(45deg, #f0f8ff, #e6f3ff)';
                    performanceLineCtx.style.borderRadius = '10px';
                    performanceLineCtx.style.padding = '20px';
                    
                    const accuracy = stats.accuracy || 0;
                    const perfectGames = stats.perfectGames || 0;
                    const totalGames = stats.totalGames || 0;
                    
                    performanceLineCtx.innerHTML = `
                        <div style="text-align: center;">
                            <div style="font-size: 48px; font-weight: bold; color: #36A2EB; margin-bottom: 10px;">${accuracy}%</div>
                            <div style="font-size: 16px; color: #666; margin-bottom: 15px;">Ortalama Başarı Oranı</div>
                            <div style="display: flex; justify-content: space-around; margin-top: 20px;">
                                <div style="text-align: center;">
                                    <div style="font-size: 24px; font-weight: bold; color: #4BC0C0;">${perfectGames}</div>
                                    <div style="font-size: 12px; color: #666;">Mükemmel Oyun</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 24px; font-weight: bold; color: #FFCE56;">${totalGames}</div>
                                    <div style="font-size: 12px; color: #666;">Toplam Oyun</div>
                                </div>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Basit grafikler çizilirken hata:', error);
            }
        }

        // Admin panel başlatma fonksiyonu
        function initializeAdminPanel() {
            // Admin panel değişkenlerini başlat
            currentUserPage = 1;
            currentQuestionPage = 1;
            allUsers = [];
            allQuestions = [];
            filteredUsers = [];
            filteredQuestions = [];
            
            console.log('Admin panel başlatıldı');
        }

        // Admin tab içerik yükleme fonksiyonu
        function loadAdminTabContent(tabName) {
            console.log('Loading admin tab content:', tabName);
            
            switch(tabName) {
                case 'dashboard':
                    loadDashboardData();
                    break;
                case 'users':
                    loadUsersData();
                    break;
                case 'questions':
                    loadQuestionsData();
                    break;
                case 'pending-questions':
                    loadPendingQuestionsData();
                    break;
                case 'reports':
                    loadReportsData();
                    break;
                case 'settings':
                    loadSettingsData();
                    break;
            }
        }

        // Dashboard verilerini yükle
        function loadDashboardData() {
            console.log('Dashboard verileri yükleniyor...');
            
            if (firebase.firestore) {
                // Firebase'den gerçek verileri al
                Promise.all([
                    firebase.firestore().collection('users').get(),
                    firebase.firestore().collection('questions').get(),
                    firebase.firestore().collection('adminQuestions').get(),
                    firebase.firestore().collection('pending-questions').where('status', '==', 'pending').get(),
                    firebase.firestore().collection('reports').where('status', '==', 'pending').get(),
                    firebase.firestore().collection('game-sessions').get()
                ]).then(([usersSnapshot, questionsSnapshot, adminQuestionsSnapshot, pendingSnapshot, reportsSnapshot, gamesSnapshot]) => {
                    
                    // İstatistikleri güncelle
                    const totalQuestions = questionsSnapshot.size + adminQuestionsSnapshot.size;
                    
                    document.getElementById('admin-total-users').textContent = usersSnapshot.size.toLocaleString('tr-TR');
                    document.getElementById('admin-total-questions').textContent = totalQuestions.toLocaleString('tr-TR');
                    document.getElementById('admin-total-games').textContent = gamesSnapshot.size.toLocaleString('tr-TR');
                    document.getElementById('admin-pending-reports').textContent = reportsSnapshot.size.toLocaleString('tr-TR');
                    
                    // Son aktiviteleri güncelle
                    updateFirebaseActivities(usersSnapshot, questionsSnapshot, adminQuestionsSnapshot, pendingSnapshot, reportsSnapshot);
                    
                    console.log('Firebase dashboard verileri yüklendi');
                    
                }).catch(error => {
                    console.error('Dashboard verileri yüklenemedi:', error);
                    loadLocalDashboardData();
                });
            } else {
                loadLocalDashboardData();
            }
        }

        // Local dashboard verilerini yükle
        function loadLocalDashboardData() {
            console.log('Local dashboard verileri yükleniyor...');
            
            const localUsers = JSON.parse(localStorage.getItem('localUsers') || '[]');
            const localQuestions = JSON.parse(localStorage.getItem('adminQuestions') || '[]');
            const localPendingQuestions = JSON.parse(localStorage.getItem('localPendingQuestions') || '[]');
            const localReports = JSON.parse(localStorage.getItem('localReports') || '[]');
            const gamesPlayed = parseInt(localStorage.getItem('gamesPlayed') || '0');
            
            // Eğer veriler yoksa örnek veri oluştur
            if (localUsers.length === 0) {
                generateSampleDashboardData();
                return;
            }
            
            const pendingQuestionsCount = localPendingQuestions.filter(q => q.status === 'pending').length;
            const pendingReportsCount = localReports.filter(r => r.status === 'pending').length;
            
            // İstatistikleri güncelle
            document.getElementById('admin-total-users').textContent = localUsers.length.toLocaleString('tr-TR');
            document.getElementById('admin-total-questions').textContent = localQuestions.length.toLocaleString('tr-TR');
            document.getElementById('admin-total-games').textContent = gamesPlayed.toLocaleString('tr-TR');
            document.getElementById('admin-pending-reports').textContent = pendingReportsCount.toLocaleString('tr-TR');
            
            // Local aktiviteleri göster
            updateLocalActivities(localUsers, localQuestions, localPendingQuestions, localReports);
            
            console.log('Local dashboard verileri yüklendi');
        }

        // Örnek dashboard verisi oluştur
        function generateSampleDashboardData() {
            console.log('Örnek dashboard verileri oluşturuluyor...');
            
            const sampleUsers = [
                {
                    id: 'admin_user',
                    displayName: 'Admin Kullanıcı',
                    email: 'admin@bilgoo.com',
                    createdAt: new Date(Date.now() - 86400000 * 30).toISOString(),
                    disabled: false,
                    role: 'admin'
                },
                {
                    id: 'demo_user_1',
                    displayName: 'Ahmet Yılmaz',
                    email: 'ahmet@example.com',
                    createdAt: new Date(Date.now() - 86400000 * 7).toISOString(),
                    disabled: false,
                    role: 'user'
                },
                {
                    id: 'demo_user_2',
                    displayName: 'Ayşe Kaya',
                    email: 'ayse@example.com',
                    createdAt: new Date(Date.now() - 86400000 * 3).toISOString(),
                    disabled: false,
                    role: 'user'
                },
                {
                    id: 'demo_user_3',
                    displayName: 'Mehmet Demir',
                    email: 'mehmet@example.com',
                    createdAt: new Date(Date.now() - 86400000 * 1).toISOString(),
                    disabled: false,
                    role: 'user'
                },
                {
                    id: 'demo_user_4',
                    displayName: 'Fatma Özkan',
                    email: 'fatma@example.com',
                    createdAt: new Date().toISOString(),
                    disabled: false,
                    role: 'user'
                }
            ];

            const sampleReports = [
                {
                    id: 'report_1',
                    type: 'inappropriate_content',
                    reportedBy: 'demo_user_1',
                    reporterName: 'Ahmet Yılmaz',
                    description: 'Uygunsuz içerik tespit edildi',
                    details: 'Kullanıcı profil fotoğrafında uygunsuz içerik mevcut',
                    status: 'pending',
                    createdAt: new Date(Date.now() - 86400000 * 2).toISOString()
                },
                {
                    id: 'report_2',
                    type: 'spam',
                    reportedBy: 'demo_user_2',
                    reporterName: 'Ayşe Kaya',
                    description: 'Spam davranış bildirimi',
                    details: 'Kullanıcı sürekli aynı mesajları gönderiyor',
                    status: 'pending',
                    createdAt: new Date(Date.now() - 86400000 * 1).toISOString()
                },
                {
                    id: 'report_3',
                    type: 'harassment',
                    reportedBy: 'demo_user_3',
                    reporterName: 'Mehmet Demir',
                    description: 'Taciz bildirimi',
                    details: 'Kullanıcı rahatsız edici mesajlar gönderiyor',
                    status: 'pending',
                    createdAt: new Date(Date.now() - 86400000 * 0.5).toISOString()
                }
            ];

            const samplePendingQuestions = [
                {
                    id: 'pending_1',
                    question: 'React.js nedir ve ne işe yarar?',
                    category: 'Teknoloji',
                    difficulty: 'Orta',
                    options: ['UI Kütüphanesi', 'Veritabanı', 'Web Sunucusu', 'İşletim Sistemi'],
                    correctAnswer: 0,
                    status: 'pending',
                    submittedBy: 'demo_user_1',
                    submittedByName: 'Ahmet Yılmaz',
                    submittedAt: new Date(Date.now() - 86400000 * 1).toISOString()
                },
                {
                    id: 'pending_2',
                    question: 'Türkiye\'nin en yüksek dağı hangisidir?',
                    category: 'Genel Kültür',
                    difficulty: 'Kolay',
                    options: ['Erciyes', 'Ağrı Dağı', 'Kaçkar', 'Uludağ'],
                    correctAnswer: 1,
                    status: 'pending',
                    submittedBy: 'demo_user_2',
                    submittedByName: 'Ayşe Kaya',
                    submittedAt: new Date(Date.now() - 86400000 * 0.5).toISOString()
                }
            ];

            // Local storage'a kaydet
            localStorage.setItem('localUsers', JSON.stringify(sampleUsers));
            localStorage.setItem('localReports', JSON.stringify(sampleReports));
            localStorage.setItem('localPendingQuestions', JSON.stringify(samplePendingQuestions));
            localStorage.setItem('gamesPlayed', '347');
            localStorage.setItem('totalQuizzes', '2147');

            console.log('Örnek dashboard verileri oluşturuldu');

            // Dashboard'ı tekrar yükle
            loadLocalDashboardData();
        }

        // Firebase aktiviteleri güncelle
        function updateFirebaseActivities(usersSnapshot, questionsSnapshot, adminQuestionsSnapshot, pendingSnapshot, reportsSnapshot) {
            const activityList = document.getElementById('admin-activity-list');
            if (!activityList) return;

            let activities = [];

            // Yeni kullanıcı kayıtları
            usersSnapshot.forEach(doc => {
                const data = doc.data();
                if (data.createdAt) {
                    const createdAt = data.createdAt.toDate ? data.createdAt.toDate() : new Date(data.createdAt);
                    activities.push({
                        type: 'user_registered',
                        data: data,
                        timestamp: createdAt,
                        icon: 'fas fa-user-plus',
                        color: '#28a745'
                    });
                }
            });

            // Admin sorular
            adminQuestionsSnapshot.forEach(doc => {
                const data = doc.data();
                if (data.addedAt) {
                    activities.push({
                        type: 'question_added',
                        data: data,
                        timestamp: new Date(data.addedAt),
                        icon: 'fas fa-plus-circle',
                        color: '#17a2b8'
                    });
                }
            });

            // Bekleyen sorular
            pendingSnapshot.forEach(doc => {
                const data = doc.data();
                if (data.submittedAt) {
                    activities.push({
                        type: 'question_pending',
                        data: data,
                        timestamp: new Date(data.submittedAt),
                        icon: 'fas fa-clock',
                        color: '#ffc107'
                    });
                }
            });

            // Yeni raporlar
            reportsSnapshot.forEach(doc => {
                const data = doc.data();
                if (data.createdAt) {
                    activities.push({
                        type: 'report_submitted',
                        data: data,
                        timestamp: new Date(data.createdAt),
                        icon: 'fas fa-exclamation-triangle',
                        color: '#dc3545'
                    });
                }
            });

            // Son 10 aktiviteyi sırala ve göster
            activities = activities
                .sort((a, b) => b.timestamp - a.timestamp)
                .slice(0, 10);

            displayActivities(activities, activityList);
        }

        // Local aktiviteleri güncelle
        function updateLocalActivities(users, questions, pendingQuestions, reports) {
            const activityList = document.getElementById('admin-activity-list');
            if (!activityList) return;

            let activities = [];

            // Local kullanıcılardan aktivite
            users.forEach(user => {
                if (user.createdAt) {
                    activities.push({
                        type: 'user_registered',
                        data: user,
                        timestamp: new Date(user.createdAt),
                        icon: 'fas fa-user-plus',
                        color: '#28a745'
                    });
                }
            });

            // Local sorulardan aktivite
            questions.forEach(question => {
                if (question.addedAt) {
                    activities.push({
                        type: 'question_added',
                        data: question,
                        timestamp: new Date(question.addedAt),
                        icon: 'fas fa-plus-circle',
                        color: '#17a2b8'
                    });
                }
            });

            // Bekleyen sorular
            pendingQuestions.forEach(question => {
                if (question.submittedAt) {
                    activities.push({
                        type: 'question_pending',
                        data: question,
                        timestamp: new Date(question.submittedAt),
                        icon: 'fas fa-clock',
                        color: '#ffc107'
                    });
                }
            });

            // Local raporlar
            reports.forEach(report => {
                if (report.createdAt) {
                    activities.push({
                        type: 'report_submitted',
                        data: report,
                        timestamp: new Date(report.createdAt),
                        icon: 'fas fa-exclamation-triangle',
                        color: '#dc3545'
                    });
                }
            });

            // Son aktiviteleri sırala ve görüntüle
            activities = activities
                .sort((a, b) => b.timestamp - a.timestamp)
                .slice(0, 8);

            displayActivities(activities, activityList);
        }

        // Aktiviteleri görüntüle
        function displayActivities(activities, container) {
            if (activities.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <i class="fas fa-calendar-times" style="font-size: 48px; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>Henüz aktivite bulunmuyor.</p>
                        <p style="font-size: 14px;">Kullanıcı etkileşimleri burada görünecektir.</p>
                    </div>
                `;
                return;
            }

            let html = '';
            activities.forEach(activity => {
                const timeAgo = getTimeAgo(activity.timestamp);
                let message = '';

                switch (activity.type) {
                    case 'user_registered':
                        message = `<strong>Yeni kullanıcı:</strong> ${activity.data.displayName || activity.data.name || 'Anonim'} kayıt oldu`;
                        break;
                    case 'question_approved':
                        message = `<strong>Soru onaylandı:</strong> "${activity.data.question.substring(0, 50)}..."`;
                        break;
                    case 'question_added':
                        message = `<strong>Yeni soru eklendi:</strong> "${activity.data.question.substring(0, 50)}..."`;
                        break;
                    case 'question_pending':
                        message = `<strong>Soru bekliyor:</strong> "${activity.data.question.substring(0, 50)}..." onay bekliyor`;
                        break;
                    case 'report_submitted':
                        message = `<strong>Yeni şikayet:</strong> ${activity.data.type || 'Genel'} kategorisinde şikayet`;
                        break;
                }

                html += `
                    <div class="activity-item" style="padding: 12px 0; border-bottom: 1px solid #eee; display: flex; align-items: center;">
                        <div style="margin-right: 12px;">
                            <i class="${activity.icon}" style="color: ${activity.color}; font-size: 16px;"></i>
                        </div>
                        <div style="flex: 1;">
                            <div style="margin-bottom: 4px;">${message}</div>
                            <small style="color: #666; font-size: 12px;">
                                <i class="fas fa-clock" style="margin-right: 4px;"></i>${timeAgo}
                            </small>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // Zaman farkını hesaplama fonksiyonu
        function getTimeAgo(date) {
            const now = new Date();
            const diff = now - date;
            
            const minutes = Math.floor(diff / (1000 * 60));
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            
            if (minutes < 1) return 'Şimdi';
            if (minutes < 60) return `${minutes} dakika önce`;
            if (hours < 24) return `${hours} saat önce`;
            return `${days} gün önce`;
        }

        // Kullanıcı verilerini yükle
        function loadUsersData() {
            const usersList = document.getElementById('admin-users-list');
            if (!usersList) return;

            // Loading indicator göster
            usersList.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px;"><i class="fas fa-spinner fa-spin"></i> Kullanıcılar yükleniyor...</td></tr>';

            if (firebase.firestore) {
                // Firebase'den gerçek kullanıcı verilerini çek
                firebase.firestore().collection('users')
                    .orderBy('createdAt', 'desc')
                    .get()
                    .then((querySnapshot) => {
                        if (querySnapshot.empty) {
                            usersList.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px; color: #666;">Henüz kayıtlı kullanıcı yok.</td></tr>';
                return;
            }
            
                        let html = '';
                        let userIndex = 1;
                        
                        allUsers = [];
                        querySnapshot.forEach((doc) => {
                            const userData = doc.data();
                            const userId = doc.id;
                            
                            // Kullanıcıyı allUsers array'ine ekle
                            allUsers.push({
                                id: userId,
                                ...userData
                            });
                            
                            // Tarih formatla
                            let registrationDate = 'Bilinmiyor';
                            if (userData.createdAt) {
                                if (userData.createdAt.toDate) {
                                    registrationDate = userData.createdAt.toDate().toLocaleDateString('tr-TR');
                                } else if (typeof userData.createdAt === 'string') {
                                    registrationDate = new Date(userData.createdAt).toLocaleDateString('tr-TR');
                                }
                            }
                            
                            // Kullanıcı durumu
                            const status = userData.disabled ? 
                                '<span style="color: #dc3545; font-weight: bold;">Engelli</span>' : 
                                '<span style="color: #28a745; font-weight: bold;">Aktif</span>';
                            
                            // Kullanıcı adı ve e-posta güvenli gösterimi
                            const displayName = userData.displayName || userData.name || 'Anonim Kullanıcı';
                            const email = userData.email || 'E-posta yok';
                            
                            html += `
                                <tr>
                                    <td>U${String(userIndex).padStart(3, '0')}</td>
                                    <td>${displayName}</td>
                                    <td>${email}</td>
                                    <td>${registrationDate}</td>
                                    <td>${status}</td>
                                    <td>
                                        <button class="admin-btn-secondary edit-user-btn" data-user-id="${userId}" style="margin-right: 5px; background: #6c757d;">
                                            <i class="fas fa-edit"></i> Düzenle
                                        </button>
                                        <button class="admin-btn-secondary ${userData.disabled ? 'unblock' : 'block'}-user-btn" data-user-id="${userId}" data-disabled="${userData.disabled || false}" style="background: ${userData.disabled ? '#28a745' : '#dc3545'};">
                                            <i class="fas fa-${userData.disabled ? 'unlock' : 'ban'}"></i> ${userData.disabled ? 'Engeli Kaldır' : 'Engelle'}
                                        </button>
                                    </td>
                                </tr>
                            `;
                            userIndex++;
                        });

                        filteredUsers = allUsers;
                        renderUsersPage();
                    })
                    .catch((error) => {
                        console.error('Kullanıcılar yüklenemedi:', error);
                        usersList.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px; color: #dc3545;">Kullanıcılar yüklenirken hata oluştu.</td></tr>';
                    });
            } else {
                // Local storage'dan veya varsayılan verilerden kullanıcı listesi
                const localUsers = JSON.parse(localStorage.getItem('localUsers') || '[]');
                
                // Eğer local storage'da kullanıcı yoksa, örnek veri oluştur
                if (localUsers.length === 0) {
                    const currentUser = firebase.auth && firebase.auth().currentUser;
                    if (currentUser) {
                        localUsers.push({
                            id: currentUser.uid,
                            displayName: currentUser.displayName || 'Mevcut Kullanıcı',
                            email: currentUser.email,
                            createdAt: new Date().toISOString(),
                            disabled: false
                        });
                        localStorage.setItem('localUsers', JSON.stringify(localUsers));
                    } else {
                        // Örnek kullanıcılar
                        localUsers.push(
                            {
                                id: 'user1',
                                displayName: 'Test Kullanıcı 1',
                                email: 'test1@example.com',
                                createdAt: new Date(Date.now() - 86400000).toISOString(), // 1 gün önce
                                disabled: false
                            },
                            {
                                id: 'user2',
                                displayName: 'Test Kullanıcı 2',
                                email: 'test2@example.com',
                                createdAt: new Date(Date.now() - 172800000).toISOString(), // 2 gün önce
                                disabled: false
                            }
                        );
                        localStorage.setItem('localUsers', JSON.stringify(localUsers));
                    }
                }
                
                allUsers = localUsers;
                filteredUsers = allUsers;
                renderUsersPage();
            }
        }

        // Kullanıcı aksiyonları için olay dinleyiciler
        function attachUserActionEvents() {
            // Düzenle butonları
            document.querySelectorAll('.edit-user-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const userId = this.getAttribute('data-user-id');
                    editUser(userId);
                });
            });

            // Engelle/Engeli Kaldır butonları
            document.querySelectorAll('.block-user-btn, .unblock-user-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const userId = this.getAttribute('data-user-id');
                    const isDisabled = this.getAttribute('data-disabled') === 'true';
                    toggleUserStatus(userId, !isDisabled);
                });
            });
        }

        // Kullanıcı düzenleme fonksiyonu
        function editUser(userId) {
            if (firebase.firestore) {
                firebase.firestore().collection('users').doc(userId).get()
                    .then((doc) => {
                        if (!doc.exists) {
                            alert('Kullanıcı bulunamadı!');
                            return;
                        }
                        const userData = doc.data();
                        openEditUserModal(userId, userData);
                    })
                    .catch((error) => {
                        console.error('Kullanıcı verisi alınamadı:', error);
                        alert('Kullanıcı verisi alınırken hata oluştu.');
                    });
            } else {
                const localUsers = JSON.parse(localStorage.getItem('localUsers') || '[]');
                const user = localUsers.find(u => u.id === userId);
                if (user) {
                    openEditUserModal(userId, user);
                } else {
                    alert('Kullanıcı bulunamadı!');
                }
            }
        }

        // Kullanıcı durumu değiştirme fonksiyonu
        function toggleUserStatus(userId, disable) {
            const action = disable ? 'engelleme' : 'engeli kaldırma';
            if (!confirm(`Bu kullanıcıyı ${action} işlemini yapmak istediğinizden emin misiniz?`)) {
                return;
            }

            if (firebase.firestore) {
                firebase.firestore().collection('users').doc(userId).update({
                    disabled: disable,
                    lastModified: firebase.firestore.FieldValue.serverTimestamp(),
                    modifiedBy: firebase.auth()?.currentUser?.email || 'admin'
                })
                .then(() => {
                    showAdminActionSuccess(`Kullanıcı ${disable ? 'engellendi' : 'engeli kaldırıldı'}.`);
                    loadUsersData(); // Listeyi yenile
                })
                .catch((error) => {
                    console.error('Kullanıcı durumu güncellenemedi:', error);
                    alert('Kullanıcı durumu güncellenirken hata oluştu.');
                });
            } else {
                const localUsers = JSON.parse(localStorage.getItem('localUsers') || '[]');
                const userIndex = localUsers.findIndex(u => u.id === userId);
                
                if (userIndex !== -1) {
                    localUsers[userIndex].disabled = disable;
                    localStorage.setItem('localUsers', JSON.stringify(localUsers));
                    
                    showAdminActionSuccess(`Kullanıcı ${disable ? 'engellendi' : 'engeli kaldırıldı'}. (Local Storage)`);
                    loadUsersData(); // Listeyi yenile
                } else {
                    alert('Kullanıcı bulunamadı!');
                }
            }
        }

        // Kullanıcı düzenleme modalı
        function openEditUserModal(userId, userData) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                z-index: 10002;
                display: flex;
                align-items: center;
                justify-content: center;
            `;
            
            modal.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 10px; max-width: 500px; width: 90%;">
                    <h3 style="margin-top: 0;">Kullanıcı Düzenle</h3>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Kullanıcı Adı:</label>
                        <input type="text" id="edit-user-name" value="${userData.displayName || userData.name || ''}" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">E-posta:</label>
                        <input type="email" id="edit-user-email" value="${userData.email || ''}" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: flex; align-items: center;">
                            <input type="checkbox" id="edit-user-disabled" ${userData.disabled ? 'checked' : ''} style="margin-right: 8px;">
                            Kullanıcıyı engelle
                        </label>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button id="save-user-btn" style="background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-save"></i> Kaydet
                        </button>
                        <button id="cancel-user-edit-btn" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-times"></i> İptal
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Kaydet butonu
            document.getElementById('save-user-btn').addEventListener('click', function() {
                saveEditedUser(userId, modal);
            });
            
            // İptal butonu
            document.getElementById('cancel-user-edit-btn').addEventListener('click', function() {
                document.body.removeChild(modal);
            });
            
            // Modal dışına tıklayınca kapat
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
        }

        // Düzenlenmiş kullanıcıyı kaydet
        function saveEditedUser(userId, modal) {
            const updatedData = {
                displayName: document.getElementById('edit-user-name').value,
                email: document.getElementById('edit-user-email').value,
                disabled: document.getElementById('edit-user-disabled').checked,
                lastModified: new Date().toISOString(),
                modifiedBy: firebase.auth()?.currentUser?.email || 'admin'
            };

            if (firebase.firestore) {
                firebase.firestore().collection('users').doc(userId).update(updatedData)
                    .then(() => {
                        showAdminActionSuccess('Kullanıcı başarıyla güncellendi!');
                        loadUsersData();
                        document.body.removeChild(modal);
                    })
                    .catch((error) => {
                        console.error('Kullanıcı güncellenirken hata oluştu:', error);
                        alert('Kullanıcı güncellenirken bir hata oluştu.');
                    });
            } else {
                const localUsers = JSON.parse(localStorage.getItem('localUsers') || '[]');
                const userIndex = localUsers.findIndex(u => u.id === userId);
                
                if (userIndex !== -1) {
                    Object.assign(localUsers[userIndex], updatedData);
                    localStorage.setItem('localUsers', JSON.stringify(localUsers));
                    
                    showAdminActionSuccess('Kullanıcı başarıyla güncellendi! (Local Storage)');
                    loadUsersData();
                    document.body.removeChild(modal);
                } else {
                    alert('Kullanıcı bulunamadı!');
                }
            }
        }

        // Admin aksiyonu başarı mesajı
        function showAdminActionSuccess(message, type = 'success') {
            const bgColor = type === 'success' ? '#4CAF50' : type === 'warning' ? '#ff9800' : '#f44336';
            
            const successMsg = document.createElement('div');
            successMsg.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${bgColor};
                color: white;
                padding: 15px 20px;
                border-radius: 5px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 10003;
                font-family: Arial, sans-serif;
                max-width: 300px;
            `;
            successMsg.innerHTML = `
                <div style="display: flex; align-items: center;">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : 'times-circle'}" style="margin-right: 10px;"></i>
                    ${message}
                </div>
            `;
            
            document.body.appendChild(successMsg);
            
            setTimeout(() => {
                successMsg.style.opacity = '0';
                successMsg.style.transition = 'opacity 0.5s';
                setTimeout(() => document.body.removeChild(successMsg), 500);
            }, 3000);
        }

        // Bekleyen sorular verilerini yükle
        function loadPendingQuestionsData() {
            const pendingList = document.getElementById('admin-pending-questions-list');
            if (!pendingList) return;

            // Loading indicator göster
            pendingList.innerHTML = '<div style="text-align: center; padding: 20px;"><i class="fas fa-spinner fa-spin"></i> Bekleyen sorular yükleniyor...</div>';

            if (firebase.firestore) {
                // Firebase'den bekleyen soruları çek
                firebase.firestore().collection('pending-questions')
                    .where('status', '==', 'pending')
                    .orderBy('submittedTimestamp', 'desc')
                    .get()
                    .then((querySnapshot) => {
                        if (querySnapshot.empty) {
                            pendingList.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">Bekleyen soru bulunmuyor.</div>';
                            return;
                        }

                        let html = '';
                        querySnapshot.forEach((doc) => {
                            const question = doc.data();
                            const questionId = doc.id;
                            const submittedDate = question.submittedAt ? new Date(question.submittedAt).toLocaleString('tr-TR') : 'Bilinmiyor';
                            
                            html += `
                                <div class="pending-question-item" data-question-id="${questionId}" style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #ffc107; margin-bottom: 15px;">
                                    <div class="question-header" style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                                        <div>
                                            <h4 style="margin: 0 0 5px 0; color: #333;">${question.question}</h4>
                                            <div style="font-size: 14px; color: #666;">
                                                <strong>Kategori:</strong> ${question.category} | 
                                                <strong>Zorluk:</strong> ${getDifficultyText(question.difficulty)} |
                                                <strong>Gönderen:</strong> ${question.submittedBy}
                                            </div>
                                            <div style="font-size: 12px; color: #888; margin-top: 5px;">
                                                <strong>Gönderilme Tarihi:</strong> ${submittedDate}
                                            </div>
                                        </div>
                                        <div style="font-size: 12px; color: #666;">
                                            ID: ${questionId.substring(0, 8)}...
                                        </div>
                                    </div>
                                    
                                    <div class="question-options" style="margin-bottom: 15px;">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                            <div><strong>A)</strong> ${question.options[0]}</div>
                                            <div><strong>B)</strong> ${question.options[1]}</div>
                                            <div><strong>C)</strong> ${question.options[2]}</div>
                                            <div><strong>D)</strong> ${question.options[3]}</div>
                                        </div>
                                        <div style="margin-top: 10px; padding: 8px; background: #e8f5e8; border-radius: 4px; font-size: 14px;">
                                            <strong>Doğru Cevap:</strong> ${String.fromCharCode(65 + question.correctAnswer)}) ${question.options[question.correctAnswer]}
                                        </div>
                                    </div>
                                    
                                    <div class="question-actions" style="display: flex; gap: 10px; justify-content: flex-end;">
                                        <button class="admin-btn-primary approve-question-btn" data-question-id="${questionId}" style="margin-right: 10px;">
                                            <i class="fas fa-check"></i> Onayla
                                        </button>
                                        <button class="admin-btn-secondary reject-question-btn" data-question-id="${questionId}" style="background: #dc3545;">
                                            <i class="fas fa-times"></i> Reddet
                                        </button>
                                        <button class="admin-btn-secondary edit-question-btn" data-question-id="${questionId}" style="background: #6c757d;">
                                            <i class="fas fa-edit"></i> Düzenle
                                        </button>
                                    </div>
                                </div>
                            `;
                        });

                        pendingList.innerHTML = html;
                        attachPendingQuestionEvents();
                    })
                    .catch((error) => {
                        console.error('Bekleyen sorular yüklenemedi:', error);
                        pendingList.innerHTML = '<div style="text-align: center; padding: 20px; color: #dc3545;">Bekleyen sorular yüklenirken hata oluştu.</div>';
                    });
            } else {
                // Local storage'dan bekleyen soruları çek
                const localPendingQuestions = JSON.parse(localStorage.getItem('localPendingQuestions') || '[]');
                const pendingQuestions = localPendingQuestions.filter(q => q.status === 'pending');
                
                if (pendingQuestions.length === 0) {
                    pendingList.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">Bekleyen soru bulunmuyor.</div>';
                    return;
                }

                let html = '';
                pendingQuestions.forEach((question) => {
                    const submittedDate = new Date(question.submittedAt).toLocaleString('tr-TR');
                    
                    html += `
                        <div class="pending-question-item" data-question-id="${question.id}" style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #ffc107; margin-bottom: 15px;">
                            <div class="question-header" style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                                <div>
                                    <h4 style="margin: 0 0 5px 0; color: #333;">${question.question}</h4>
                                    <div style="font-size: 14px; color: #666;">
                                        <strong>Kategori:</strong> ${question.category} | 
                                        <strong>Zorluk:</strong> ${getDifficultyText(question.difficulty)} |
                                        <strong>Gönderen:</strong> ${question.submittedBy}
                                    </div>
                                    <div style="font-size: 12px; color: #888; margin-top: 5px;">
                                        <strong>Gönderilme Tarihi:</strong> ${submittedDate}
                                    </div>
                                </div>
                                <div style="font-size: 12px; color: #666;">
                                    ID: ${question.id}
                                </div>
                            </div>
                            
                            <div class="question-options" style="margin-bottom: 15px;">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                    <div><strong>A)</strong> ${question.options[0]}</div>
                                    <div><strong>B)</strong> ${question.options[1]}</div>
                                    <div><strong>C)</strong> ${question.options[2]}</div>
                                    <div><strong>D)</strong> ${question.options[3]}</div>
                                </div>
                                <div style="margin-top: 10px; padding: 8px; background: #e8f5e8; border-radius: 4px; font-size: 14px;">
                                    <strong>Doğru Cevap:</strong> ${String.fromCharCode(65 + question.correctAnswer)}) ${question.options[question.correctAnswer]}
                                </div>
                            </div>
                            
                            <div class="question-actions" style="display: flex; gap: 10px; justify-content: flex-end;">
                                <button class="admin-btn-primary approve-question-btn" data-question-id="${question.id}" style="margin-right: 10px;">
                                    <i class="fas fa-check"></i> Onayla
                                </button>
                                <button class="admin-btn-secondary reject-question-btn" data-question-id="${question.id}" style="background: #dc3545;">
                                    <i class="fas fa-times"></i> Reddet
                                </button>
                            </div>
                        </div>
                    `;
                });

                pendingList.innerHTML = html;
                attachPendingQuestionEvents();
            }
        }

        // Zorluk seviyesi metni döndür
        function getDifficultyText(difficulty) {
            const difficultyMap = {
                1: 'Kolay',
                2: 'Orta', 
                3: 'Zor'
            };
            return difficultyMap[difficulty] || 'Bilinmiyor';
        }

        // Bekleyen soru butonlarına olay dinleyiciler ekle
        function attachPendingQuestionEvents() {
            // Onay butonları
            document.querySelectorAll('.approve-question-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const questionId = this.getAttribute('data-question-id');
                    approveQuestion(questionId);
                });
            });

            // Red butonları
            document.querySelectorAll('.reject-question-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const questionId = this.getAttribute('data-question-id');
                    rejectQuestion(questionId);
                });
            });

            // Düzenle butonları
            document.querySelectorAll('.edit-question-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const questionId = this.getAttribute('data-question-id');
                    editPendingQuestion(questionId);
                });
            });
        }

        // Admin panel değişkenleri
        let currentUserPage = 1;
        let currentQuestionPage = 1;
        let usersPerPage = 10;
        let questionsPerPage = 10;
        let allUsers = [];
        let allQuestions = [];
        let filteredUsers = [];
        let filteredQuestions = [];

        // Sorular verilerini yükle
        function loadQuestionsData() {
            const questionsList = document.getElementById('admin-questions-list');
            if (!questionsList) return;

            // Loading indicator göster
            questionsList.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px;"><i class="fas fa-spinner fa-spin"></i> Sorular yükleniyor...</td></tr>';

            // Kategori seçeneklerini yükle
            populateQuestionCategorySelect();

            if (firebase.firestore) {
                // Firebase'den gerçek soru verilerini çek
                Promise.all([
                    firebase.firestore().collection('questions').get(),
                    firebase.firestore().collection('adminQuestions').get()
                ]).then(([questionsSnapshot, adminQuestionsSnapshot]) => {
                    allQuestions = [];
                    
                    // Normal soruları ekle
                    questionsSnapshot.forEach((doc) => {
                        const questionData = doc.data();
                        allQuestions.push({
                            id: doc.id,
                            ...questionData,
                            source: 'questions'
                        });
                    });
                    
                    // Admin sorularını ekle
                    adminQuestionsSnapshot.forEach((doc) => {
                        const questionData = doc.data();
                        allQuestions.push({
                            id: doc.id,
                            ...questionData,
                            source: 'adminQuestions'
                        });
                    });
                    
                    filteredQuestions = allQuestions;
                    currentQuestionPage = 1;
                    renderQuestionsPage();
                    
                }).catch((error) => {
                    console.error('Sorular yüklenemedi:', error);
                    loadLocalQuestionsData();
                });
            } else {
                loadLocalQuestionsData();
            }
        }

        // Local sorular verilerini yükle
        function loadLocalQuestionsData() {
            const localQuestions = JSON.parse(localStorage.getItem('adminQuestions') || '[]');
            
            // Eğer local storage'da soru yoksa, örnek sorular oluştur
            if (localQuestions.length === 0) {
                const sampleQuestions = [
                    {
                        id: 'local_q1',
                        question: 'JavaScript hangi amaçla kullanılır?',
                        category: 'Teknoloji',
                        difficulty: 'medium',
                        options: ['Web geliştirme', 'Fotoğraf düzenleme', 'Video oynatma', 'Müzik dinleme'],
                        correctAnswer: 0,
                        addedBy: 'admin',
                        addedAt: new Date().toISOString()
                    },
                    {
                        id: 'local_q2',
                        question: 'Türkiye\'nin başkenti neresidir?',
                        category: 'Genel Kültür',
                        difficulty: 'easy',
                        options: ['İstanbul', 'Ankara', 'İzmir', 'Bursa'],
                        correctAnswer: 1,
                        addedBy: 'admin',
                        addedAt: new Date().toISOString()
                    },
                    {
                        id: 'local_q3',
                        question: 'En büyük okyanusun adı nedir?',
                        category: 'Coğrafya',
                        difficulty: 'easy',
                        options: ['Atlantik Okyanusu', 'Pasifik Okyanusu', 'Hint Okyanusu', 'Kuzey Buz Denizi'],
                        correctAnswer: 1,
                        addedBy: 'sistem',
                        addedAt: new Date().toISOString()
                    }
                ];
                localStorage.setItem('adminQuestions', JSON.stringify(sampleQuestions));
                allQuestions = sampleQuestions;
            } else {
                allQuestions = localQuestions;
            }
            
            filteredQuestions = allQuestions;
            currentQuestionPage = 1;
            renderQuestionsPage();
        }

        // Kategori seçeneklerini doldur
        function populateQuestionCategorySelect() {
            const categorySelect = document.getElementById('admin-question-category');
            if (!categorySelect) return;
            
            const categories = ['Genel Kültür', 'Tarih', 'Coğrafya', 'Fen Bilgisi', 'Teknoloji', 'Spor', 'Sanat', 'Müzik', 'Edebiyat', 'Matematik'];
            
            categorySelect.innerHTML = '<option value="all">Tüm Kategoriler</option>';
            categories.forEach(category => {
                categorySelect.innerHTML += `<option value="${category}">${category}</option>`;
            });
        }

        // Kullanıcı arama fonksiyonu
        function searchUsers() {
            const searchInput = document.getElementById('admin-user-search');
            const searchTerm = searchInput ? searchInput.value.toLowerCase().trim() : '';
            
            if (!searchTerm) {
                filteredUsers = allUsers;
            } else {
                filteredUsers = allUsers.filter(user => 
                    (user.displayName && user.displayName.toLowerCase().includes(searchTerm)) ||
                    (user.email && user.email.toLowerCase().includes(searchTerm)) ||
                    (user.name && user.name.toLowerCase().includes(searchTerm))
                );
            }
            
            currentUserPage = 1;
            renderUsersPage();
        }
        
        // Soru arama fonksiyonu
        function searchQuestions() {
            const searchInput = document.getElementById('admin-question-search');
            const categorySelect = document.getElementById('admin-question-category');
            
            const searchTerm = searchInput ? searchInput.value.toLowerCase().trim() : '';
            const category = categorySelect ? categorySelect.value : 'all';
            
            let filtered = allQuestions;
            
            // Kategori filtresi
            if (category && category !== 'all') {
                filtered = filtered.filter(q => q.category === category);
            }
            
            // Arama terimi filtresi
            if (searchTerm) {
                filtered = filtered.filter(q => 
                    (q.question && q.question.toLowerCase().includes(searchTerm)) ||
                    (q.category && q.category.toLowerCase().includes(searchTerm)) ||
                    (q.addedBy && q.addedBy.toLowerCase().includes(searchTerm))
                );
            }
            
            filteredQuestions = filtered;
            currentQuestionPage = 1;
            renderQuestionsPage();
        }

        // Kullanıcıları sayfa saya göster
        function renderUsersPage() {
            const usersList = document.getElementById('admin-users-list');
            if (!usersList) return;
            
            const startIndex = (currentUserPage - 1) * usersPerPage;
            const endIndex = startIndex + usersPerPage;
            const usersToShow = filteredUsers.slice(startIndex, endIndex);
            
            if (usersToShow.length === 0) {
                usersList.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px; color: #666;">Kullanıcı bulunamadı.</td></tr>';
                return;
            }
            
            let html = '';
            usersToShow.forEach((user, index) => {
                const actualIndex = startIndex + index + 1;
                const registrationDate = user.createdAt ? 
                    (user.createdAt.toDate ? user.createdAt.toDate().toLocaleDateString('tr-TR') : new Date(user.createdAt).toLocaleDateString('tr-TR')) : 
                    'Bilinmiyor';
                
                const status = user.disabled ? 
                    '<span style="color: #dc3545; font-weight: bold;">Engelli</span>' : 
                    '<span style="color: #28a745; font-weight: bold;">Aktif</span>';
                
                const displayName = user.displayName || user.name || 'Anonim';
                const email = user.email || 'E-posta yok';
                
                html += `
                    <tr>
                        <td>U${String(actualIndex).padStart(3, '0')}</td>
                        <td>${displayName}</td>
                        <td>${email}</td>
                        <td>${registrationDate}</td>
                        <td>${status}</td>
                        <td>
                            <button class="admin-btn-secondary edit-user-btn" data-user-id="${user.id}" style="margin-right: 5px; background: #6c757d;">
                                <i class="fas fa-edit"></i> Düzenle
                            </button>
                            <button class="admin-btn-secondary ${user.disabled ? 'unblock' : 'block'}-user-btn" data-user-id="${user.id}" data-disabled="${user.disabled || false}" style="background: ${user.disabled ? '#28a745' : '#dc3545'};">
                                <i class="fas fa-${user.disabled ? 'unlock' : 'ban'}"></i> ${user.disabled ? 'Engeli Kaldır' : 'Engelle'}
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            usersList.innerHTML = html;
            attachUserActionEvents();
            updateUserPagination();
        }
        
        // Kullanıcı sayfalama güncelle
        function updateUserPagination() {
            const totalPages = Math.ceil(filteredUsers.length / usersPerPage);
            const currentPageSpan = document.getElementById('admin-current-page');
            const prevBtn = document.getElementById('admin-prev-page');
            const nextBtn = document.getElementById('admin-next-page');
            
            if (currentPageSpan) {
                currentPageSpan.textContent = `Sayfa ${currentUserPage} / ${totalPages} (${filteredUsers.length} kullanıcı)`;
            }
            
            if (prevBtn) {
                prevBtn.disabled = currentUserPage === 1;
                prevBtn.style.opacity = currentUserPage === 1 ? '0.5' : '1';
            }
            
            if (nextBtn) {
                nextBtn.disabled = currentUserPage >= totalPages;
                nextBtn.style.opacity = currentUserPage >= totalPages ? '0.5' : '1';
            }
        }

        // Soruları sayfa saya göster
        function renderQuestionsPage() {
            const questionsList = document.getElementById('admin-questions-list');
            if (!questionsList) return;
            
            const startIndex = (currentQuestionPage - 1) * questionsPerPage;
            const endIndex = startIndex + questionsPerPage;
            const questionsToShow = filteredQuestions.slice(startIndex, endIndex);
            
            if (questionsToShow.length === 0) {
                questionsList.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px; color: #666;">Soru bulunamadı.</td></tr>';
                return;
            }
            
            let html = '';
            questionsToShow.forEach((question, index) => {
                const actualIndex = startIndex + index + 1;
                const difficulty = getDifficultyText(question.difficulty);
                const addedBy = question.addedBy || question.createdBy || 'Sistem';
                
                html += `
                    <tr>
                        <td>Q${String(actualIndex).padStart(3, '0')}</td>
                        <td style="max-width: 300px; overflow: hidden; text-overflow: ellipsis;">${question.question}</td>
                        <td>${question.category}</td>
                        <td>${difficulty}</td>
                        <td>${addedBy}</td>
                        <td>
                            <button class="admin-btn-secondary edit-question-btn" data-question-id="${question.id}" style="margin-right: 5px; background: #6c757d;">
                                <i class="fas fa-edit"></i> Düzenle
                            </button>
                            <button class="admin-btn-secondary delete-question-btn" data-question-id="${question.id}" style="background: #dc3545;">
                                <i class="fas fa-trash"></i> Sil
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            questionsList.innerHTML = html;
            attachQuestionActionEvents();
            updateQuestionPagination();
        }
        
        // Soru sayfalama güncelle
        function updateQuestionPagination() {
            const totalPages = Math.ceil(filteredQuestions.length / questionsPerPage);
            const currentPageSpan = document.getElementById('admin-current-question-page');
            const prevBtn = document.getElementById('admin-prev-question-page');
            const nextBtn = document.getElementById('admin-next-question-page');
            
            if (currentPageSpan) {
                currentPageSpan.textContent = `Sayfa ${currentQuestionPage} / ${totalPages} (${filteredQuestions.length} soru)`;
            }
            
            if (prevBtn) {
                prevBtn.disabled = currentQuestionPage === 1;
                prevBtn.style.opacity = currentQuestionPage === 1 ? '0.5' : '1';
            }
            
            if (nextBtn) {
                nextBtn.disabled = currentQuestionPage >= totalPages;
                nextBtn.style.opacity = currentQuestionPage >= totalPages ? '0.5' : '1';
            }
        }

        // Soru aksiyon event listeners
        function attachQuestionActionEvents() {
            // Düzenle butonları
            document.querySelectorAll('.edit-question-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const questionId = this.getAttribute('data-question-id');
                    editQuestion(questionId);
                });
            });

            // Sil butonları
            document.querySelectorAll('.delete-question-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const questionId = this.getAttribute('data-question-id');
                    deleteQuestion(questionId);
                });
            });
        }

        // Soru düzenleme
        function editQuestion(questionId) {
            const question = filteredQuestions.find(q => q.id === questionId);
            if (!question) {
                alert('Soru bulunamadı!');
                return;
            }
            
            openEditQuestionModal(question);
        }

        // Soru silme
        function deleteQuestion(questionId) {
            if (!confirm('Bu soruyu silmek istediğinizden emin misiniz?')) {
                return;
            }
            
            if (firebase.firestore) {
                // Firebase'den sil
                const collections = ['questions', 'adminQuestions'];
                Promise.all(collections.map(collection => 
                    firebase.firestore().collection(collection).doc(questionId).delete()
                )).then(() => {
                    showAdminActionSuccess('Soru başarıyla silindi!');
                    loadQuestionsData();
                }).catch(error => {
                    console.error('Soru silinirken hata:', error);
                    showAdminActionSuccess('Soru silinirken hata oluştu!', 'error');
                });
            } else {
                // Local storage'dan sil
                const localQuestions = JSON.parse(localStorage.getItem('adminQuestions') || '[]');
                const questionIndex = localQuestions.findIndex(q => q.id === questionId);
                
                if (questionIndex !== -1) {
                    localQuestions.splice(questionIndex, 1);
                    localStorage.setItem('adminQuestions', JSON.stringify(localQuestions));
                    showAdminActionSuccess('Soru başarıyla silindi! (Local Storage)');
                    loadQuestionsData();
                } else {
                    alert('Soru bulunamadı!');
                }
            }
        }

        // Zorluk seviyesi metni
        function getDifficultyText(difficulty) {
            switch(difficulty) {
                case 'easy': return 'Kolay';
                case 'medium': return 'Orta';
                case 'hard': return 'Zor';
                default: return difficulty || 'Belirsiz';
            }
        }

        // Soru ekleme modalı
        function showAddQuestionModal() {
            const modal = document.createElement('div');
            modal.className = 'admin-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.7);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;
            
            modal.innerHTML = `
                <div class="admin-modal-content" style="background: white; padding: 30px; border-radius: 10px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto;">
                    <div class="admin-modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #ddd; padding-bottom: 15px;">
                        <h3 style="margin: 0;">Yeni Soru Ekle</h3>
                        <button class="close-modal" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">&times;</button>
                    </div>
                    
                    <form id="add-question-form" style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Soru:</label>
                            <textarea name="question" required style="width: 100%; min-height: 80px; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" placeholder="Sorunuzu buraya yazın..."></textarea>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Kategori:</label>
                                <select name="category" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="">Kategori Seçin</option>
                                    <option value="Genel Kültür">Genel Kültür</option>
                                    <option value="Tarih">Tarih</option>
                                    <option value="Coğrafya">Coğrafya</option>
                                    <option value="Fen Bilgisi">Fen Bilgisi</option>
                                    <option value="Teknoloji">Teknoloji</option>
                                    <option value="Spor">Spor</option>
                                    <option value="Sanat">Sanat</option>
                                    <option value="Müzik">Müzik</option>
                                    <option value="Edebiyat">Edebiyat</option>
                                    <option value="Matematik">Matematik</option>
                                </select>
                            </div>
                            
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Zorluk:</label>
                                <select name="difficulty" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="">Zorluk Seçin</option>
                                    <option value="easy">Kolay</option>
                                    <option value="medium">Orta</option>
                                    <option value="hard">Zor</option>
                                </select>
                            </div>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 10px; font-weight: bold;">Seçenekler:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <input type="text" name="option1" required placeholder="A) Seçenek" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <input type="text" name="option2" required placeholder="B) Seçenek" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <input type="text" name="option3" required placeholder="C) Seçenek" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <input type="text" name="option4" required placeholder="D) Seçenek" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                            </div>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Doğru Cevap:</label>
                            <select name="correctAnswer" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <option value="">Doğru cevabı seçin</option>
                                <option value="0">A</option>
                                <option value="1">B</option>
                                <option value="2">C</option>
                                <option value="3">D</option>
                            </select>
                        </div>
                        
                        <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                            <button type="button" class="cancel-modal admin-btn-secondary">İptal</button>
                            <button type="submit" class="admin-btn-primary" style="background: #28a745;">
                                <i class="fas fa-plus"></i> Soru Ekle
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Modal olayları
            modal.querySelector('.close-modal').addEventListener('click', () => {
                document.body.removeChild(modal);
            });
            
            modal.querySelector('.cancel-modal').addEventListener('click', () => {
                document.body.removeChild(modal);
            });
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
            
            // Form gönderimi
            modal.querySelector('#add-question-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                const questionData = {
                    id: 'admin_' + Date.now(),
                    question: formData.get('question'),
                    category: formData.get('category'),
                    difficulty: formData.get('difficulty'),
                    options: [
                        formData.get('option1'),
                        formData.get('option2'),
                        formData.get('option3'),
                        formData.get('option4')
                    ],
                    correctAnswer: parseInt(formData.get('correctAnswer')),
                    addedBy: firebase.auth()?.currentUser?.email || 'admin',
                    addedAt: new Date().toISOString(),
                    type: 'admin-created'
                };
                
                // Soruyu kaydet
                if (firebase.firestore) {
                    firebase.firestore().collection('adminQuestions').doc(questionData.id).set(questionData)
                        .then(() => {
                            showAdminActionSuccess('Soru başarıyla eklendi!');
                            loadQuestionsData();
                            document.body.removeChild(modal);
                        })
                        .catch((error) => {
                            console.error('Soru eklenirken hata:', error);
                            showAdminActionSuccess('Soru eklenirken hata oluştu!', 'error');
                        });
                } else {
                    const localQuestions = JSON.parse(localStorage.getItem('adminQuestions') || '[]');
                    localQuestions.push(questionData);
                    localStorage.setItem('adminQuestions', JSON.stringify(localQuestions));
                    showAdminActionSuccess('Soru başarıyla eklendi! (Local Storage)');
                    loadQuestionsData();
                    document.body.removeChild(modal);
                }
            });
        }

        // Soru düzenleme modalı
        function openEditQuestionModal(question) {
            const modal = document.createElement('div');
            modal.className = 'admin-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.7);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;
            
            modal.innerHTML = `
                <div class="admin-modal-content" style="background: white; padding: 30px; border-radius: 10px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto;">
                    <div class="admin-modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #ddd; padding-bottom: 15px;">
                        <h3 style="margin: 0;">Soru Düzenle</h3>
                        <button class="close-modal" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">&times;</button>
                    </div>
                    
                    <form id="edit-question-form" style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Soru:</label>
                            <textarea name="question" required style="width: 100%; min-height: 80px; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">${question.question}</textarea>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Kategori:</label>
                                <select name="category" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="Genel Kültür" ${question.category === 'Genel Kültür' ? 'selected' : ''}>Genel Kültür</option>
                                    <option value="Tarih" ${question.category === 'Tarih' ? 'selected' : ''}>Tarih</option>
                                    <option value="Coğrafya" ${question.category === 'Coğrafya' ? 'selected' : ''}>Coğrafya</option>
                                    <option value="Fen Bilgisi" ${question.category === 'Fen Bilgisi' ? 'selected' : ''}>Fen Bilgisi</option>
                                    <option value="Teknoloji" ${question.category === 'Teknoloji' ? 'selected' : ''}>Teknoloji</option>
                                    <option value="Spor" ${question.category === 'Spor' ? 'selected' : ''}>Spor</option>
                                    <option value="Sanat" ${question.category === 'Sanat' ? 'selected' : ''}>Sanat</option>
                                    <option value="Müzik" ${question.category === 'Müzik' ? 'selected' : ''}>Müzik</option>
                                    <option value="Edebiyat" ${question.category === 'Edebiyat' ? 'selected' : ''}>Edebiyat</option>
                                    <option value="Matematik" ${question.category === 'Matematik' ? 'selected' : ''}>Matematik</option>
                                </select>
                            </div>
                            
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Zorluk:</label>
                                <select name="difficulty" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="easy" ${question.difficulty === 'easy' ? 'selected' : ''}>Kolay</option>
                                    <option value="medium" ${question.difficulty === 'medium' ? 'selected' : ''}>Orta</option>
                                    <option value="hard" ${question.difficulty === 'hard' ? 'selected' : ''}>Zor</option>
                                </select>
                            </div>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 10px; font-weight: bold;">Seçenekler:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <input type="text" name="option1" required value="${question.options && question.options[0] || ''}" placeholder="A) Seçenek" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <input type="text" name="option2" required value="${question.options && question.options[1] || ''}" placeholder="B) Seçenek" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <input type="text" name="option3" required value="${question.options && question.options[2] || ''}" placeholder="C) Seçenek" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <input type="text" name="option4" required value="${question.options && question.options[3] || ''}" placeholder="D) Seçenek" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                            </div>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Doğru Cevap:</label>
                            <select name="correctAnswer" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <option value="0" ${question.correctAnswer === 0 ? 'selected' : ''}>A</option>
                                <option value="1" ${question.correctAnswer === 1 ? 'selected' : ''}>B</option>
                                <option value="2" ${question.correctAnswer === 2 ? 'selected' : ''}>C</option>
                                <option value="3" ${question.correctAnswer === 3 ? 'selected' : ''}>D</option>
                            </select>
                        </div>
                        
                        <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                            <button type="button" class="cancel-modal admin-btn-secondary">İptal</button>
                            <button type="submit" class="admin-btn-primary" style="background: #28a745;">
                                <i class="fas fa-save"></i> Kaydet
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Modal olayları
            modal.querySelector('.close-modal').addEventListener('click', () => {
                document.body.removeChild(modal);
            });
            
            modal.querySelector('.cancel-modal').addEventListener('click', () => {
                document.body.removeChild(modal);
            });
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
            
            // Form gönderimi
            modal.querySelector('#edit-question-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                const updatedQuestion = {
                    ...question,
                    question: formData.get('question'),
                    category: formData.get('category'),
                    difficulty: formData.get('difficulty'),
                    options: [
                        formData.get('option1'),
                        formData.get('option2'),
                        formData.get('option3'),
                        formData.get('option4')
                    ],
                    correctAnswer: parseInt(formData.get('correctAnswer')),
                    lastModified: new Date().toISOString(),
                    modifiedBy: firebase.auth()?.currentUser?.email || 'admin'
                };
                
                // Soruyu güncelle
                if (firebase.firestore) {
                    const collections = ['questions', 'adminQuestions'];
                    Promise.all(collections.map(collection => 
                        firebase.firestore().collection(collection).doc(question.id).set(updatedQuestion, { merge: true })
                    )).then(() => {
                        showAdminActionSuccess('Soru başarıyla güncellendi!');
                        loadQuestionsData();
                        document.body.removeChild(modal);
                    }).catch((error) => {
                        console.error('Soru güncellenirken hata:', error);
                        showAdminActionSuccess('Soru güncellenirken hata oluştu!', 'error');
                    });
                } else {
                    const localQuestions = JSON.parse(localStorage.getItem('adminQuestions') || '[]');
                    const questionIndex = localQuestions.findIndex(q => q.id === question.id);
                    
                    if (questionIndex !== -1) {
                        localQuestions[questionIndex] = updatedQuestion;
                        localStorage.setItem('adminQuestions', JSON.stringify(localQuestions));
                        showAdminActionSuccess('Soru başarıyla güncellendi! (Local Storage)');
                        loadQuestionsData();
                        document.body.removeChild(modal);
                    } else {
                        showAdminActionSuccess('Soru bulunamadı!', 'error');
                    }
                }
            });
        }

        // Soruları içe aktar
        function importQuestions() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const questions = JSON.parse(e.target.result);
                        if (!Array.isArray(questions)) {
                            throw new Error('Geçersiz dosya formatı');
                        }
                        
                        // Soruları ekle
                        if (firebase.firestore) {
                            const batch = firebase.firestore().batch();
                            questions.forEach(question => {
                                const docRef = firebase.firestore().collection('adminQuestions').doc();
                                batch.set(docRef, {
                                    ...question,
                                    id: docRef.id,
                                    importedAt: new Date().toISOString(),
                                    importedBy: firebase.auth()?.currentUser?.email || 'admin'
                                });
                            });
                            
                            batch.commit().then(() => {
                                showAdminActionSuccess(`${questions.length} soru başarıyla içe aktarıldı!`);
                                loadQuestionsData();
                            }).catch(error => {
                                console.error('İçe aktarma hatası:', error);
                                showAdminActionSuccess('İçe aktarma sırasında hata oluştu!', 'error');
                            });
                        } else {
                            const localQuestions = JSON.parse(localStorage.getItem('adminQuestions') || '[]');
                            questions.forEach(question => {
                                localQuestions.push({
                                    ...question,
                                    id: 'imported_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                                    importedAt: new Date().toISOString(),
                                    importedBy: 'admin'
                                });
                            });
                            localStorage.setItem('adminQuestions', JSON.stringify(localQuestions));
                            showAdminActionSuccess(`${questions.length} soru başarıyla içe aktarıldı! (Local Storage)`);
                            loadQuestionsData();
                        }
                    } catch (error) {
                        console.error('Dosya okuma hatası:', error);
                        alert('Dosya okunamadı. Lütfen geçerli bir JSON dosyası seçin.');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        // Soruları dışa aktar
        function exportQuestions() {
            if (filteredQuestions.length === 0) {
                alert('Dışa aktarılacak soru bulunamadı!');
                return;
            }
            
            const dataStr = JSON.stringify(filteredQuestions, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `sorular_${new Date().toISOString().slice(0, 10)}.json`;
            link.click();
            
            showAdminActionSuccess(`${filteredQuestions.length} soru başarıyla dışa aktarıldı!`);
        }

        // Şikayetler verilerini yükle
        function loadReportsData() {
            const reportsList = document.getElementById('admin-reports-list');
            if (!reportsList) return;

            // Loading indicator göster
            reportsList.innerHTML = '<div style="text-align: center; padding: 20px;"><i class="fas fa-spinner fa-spin"></i> Şikayetler yükleniyor...</div>';

            // Filtreleme seçenekleri
            const filterValue = document.getElementById('admin-report-filter')?.value || 'all';
            
            if (firebase.firestore) {
                // Firebase'den şikayetleri çek
                let query = firebase.firestore().collection('reports');
                
                // Filtre uygula
                if (filterValue !== 'all') {
                    query = query.where('status', '==', filterValue);
                }
                
                query.orderBy('reportedAt', 'desc')
                    .get()
                    .then((querySnapshot) => {
                        if (querySnapshot.empty) {
                            reportsList.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">Şikayet bulunmuyor.</div>';
                            return;
                        }

                        let html = '';
                        querySnapshot.forEach((doc) => {
                            const report = doc.data();
                            const reportId = doc.id;
                            html += generateReportHTML(reportId, report);
                        });

                        reportsList.innerHTML = html;
                        attachReportActionEvents();
                    })
                    .catch((error) => {
                        console.error('Şikayetler yüklenemedi:', error);
                        reportsList.innerHTML = '<div style="text-align: center; padding: 20px; color: #dc3545;">Şikayetler yüklenirken hata oluştu.</div>';
                });
            } else {
                // Local storage'dan şikayetleri çek
                const localReports = JSON.parse(localStorage.getItem('localReports') || '[]');
                
                // Örnek şikayet verisi oluştur (eğer yoksa)
                if (localReports.length === 0) {
                    const sampleReports = [
                        {
                            id: 'report_1',
                            type: 'inappropriate_content',
                            reportedBy: 'kullanici456',
                            reportedByEmail: 'user456@example.com',
                            targetType: 'question',
                            targetId: 'Q123',
                            targetContent: 'Bu soru yanlış bilgi içeriyor',
                            reason: 'Uygunsuz İçerik',
                            description: 'Bu soru yanlış bilgi içeriyor ve yanıltıcı.',
                            status: 'pending',
                            reportedAt: new Date(Date.now() - 86400000).toISOString(), // 1 gün önce
                            reviewedBy: null,
                            reviewedAt: null,
                            adminNotes: ''
                        },
                        {
                            id: 'report_2',
                            type: 'harassment',
                            reportedBy: 'kullanici789',
                            reportedByEmail: 'user789@example.com',
                            targetType: 'user',
                            targetId: 'baduser123',
                            targetContent: 'Kullanıcı sohbette küfür ediyor',
                            reason: 'Taciz/Hakaret',
                            description: 'Bu kullanıcı oyun sohbetinde sürekli küfür ediyor.',
                            status: 'resolved',
                            reportedAt: new Date(Date.now() - 172800000).toISOString(), // 2 gün önce
                            reviewedBy: 'admin@example.com',
                            reviewedAt: new Date(Date.now() - 86400000).toISOString(),
                            adminNotes: 'Kullanıcı 7 gün engellenmiştir.'
                        }
                    ];
                    localStorage.setItem('localReports', JSON.stringify(sampleReports));
                    localReports.push(...sampleReports);
                }
                
                // Filtreleme uygula
                let filteredReports = localReports;
                if (filterValue !== 'all') {
                    filteredReports = localReports.filter(report => report.status === filterValue);
                }
                
                if (filteredReports.length === 0) {
                    reportsList.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">Bu filtre için şikayet bulunmuyor.</div>';
                return;
            }

                let html = '';
                filteredReports.forEach((report) => {
                    html += generateReportHTML(report.id, report);
                });

                reportsList.innerHTML = html;
                attachReportActionEvents();
            }
        }

        // Şikayet HTML'i oluştur
        function generateReportHTML(reportId, report) {
            const reportedDate = new Date(report.reportedAt).toLocaleString('tr-TR');
            const reviewedDate = report.reviewedAt ? new Date(report.reviewedAt).toLocaleString('tr-TR') : null;
            
            // Durum rengi
            let statusColor = '#ffc107'; // pending - sarı
            let statusText = 'Bekliyor';
            
            if (report.status === 'resolved') {
                statusColor = '#28a745'; // çözülmüş - yeşil
                statusText = 'Çözülmüş';
            } else if (report.status === 'rejected') {
                statusColor = '#dc3545'; // reddedilmiş - kırmızı
                statusText = 'Reddedilmiş';
            }
            
            // Şikayet türü ikonu
            let typeIcon = 'fas fa-exclamation-triangle';
            if (report.type === 'harassment') typeIcon = 'fas fa-user-slash';
            else if (report.type === 'spam') typeIcon = 'fas fa-ban';
            else if (report.type === 'inappropriate_content') typeIcon = 'fas fa-flag';
            
            return `
                <div class="report-item" data-report-id="${reportId}" style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid ${statusColor}; margin-bottom: 15px;">
                    <div class="report-header" style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                        <div>
                            <h4 style="margin: 0 0 5px 0; color: #333; display: flex; align-items: center;">
                                <i class="${typeIcon}" style="margin-right: 8px; color: ${statusColor};"></i>
                                ${report.reason}
                            </h4>
                            <div style="font-size: 14px; color: #666;">
                                <strong>Şikayet Eden:</strong> ${report.reportedBy} (${report.reportedByEmail || 'E-posta yok'}) |
                                <strong>Hedef:</strong> ${report.targetType === 'question' ? 'Soru' : 'Kullanıcı'} (${report.targetId})
                        </div>
                            <div style="font-size: 12px; color: #888; margin-top: 5px;">
                                <strong>Tarih:</strong> ${reportedDate}
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <span style="background: ${statusColor}; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">
                                ${statusText}
                        </span>
                            <div style="font-size: 10px; color: #666; margin-top: 5px;">
                                ID: ${reportId.substring(0, 8)}...
                            </div>
                        </div>
                    </div>
                    
                    <div class="report-content" style="margin-bottom: 15px;">
                        <div style="margin-bottom: 10px;">
                            <strong>İçerik:</strong> "${report.targetContent}"
                        </div>
                        <div style="margin-bottom: 10px;">
                            <strong>Açıklama:</strong> ${report.description}
                        </div>
                        ${report.adminNotes ? `
                            <div style="background: #e8f5e8; padding: 10px; border-radius: 4px; margin-top: 10px;">
                                <strong>Admin Notları:</strong> ${report.adminNotes}
                                <br><small><strong>İncelendi:</strong> ${reviewedDate} - ${report.reviewedBy}</small>
                            </div>
                        ` : ''}
                    </div>
                    
                    ${report.status === 'pending' ? `
                        <div class="report-actions" style="display: flex; gap: 10px; justify-content: flex-end;">
                            <button class="admin-btn-primary resolve-report-btn" data-report-id="${reportId}" style="background: #28a745;">
                                <i class="fas fa-check"></i> Çözümlendi
                            </button>
                            <button class="admin-btn-secondary reject-report-btn" data-report-id="${reportId}" style="background: #dc3545;">
                                <i class="fas fa-times"></i> Reddet
                            </button>
                            <button class="admin-btn-secondary view-report-btn" data-report-id="${reportId}" style="background: #17a2b8;">
                                <i class="fas fa-eye"></i> Detay
                            </button>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // Şikayet aksiyonları için olay dinleyiciler
        function attachReportActionEvents() {
            // Çözümlendi butonları
            document.querySelectorAll('.resolve-report-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const reportId = this.getAttribute('data-report-id');
                    resolveReport(reportId);
                });
            });

            // Reddet butonları
            document.querySelectorAll('.reject-report-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const reportId = this.getAttribute('data-report-id');
                    rejectReport(reportId);
                });
            });

            // Detay butonları
            document.querySelectorAll('.view-report-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const reportId = this.getAttribute('data-report-id');
                    viewReportDetails(reportId);
                });
            });
        }

        // Şikayeti çözümle
        function resolveReport(reportId) {
            const adminNote = prompt('Çözüm notunuzu girin (opsiyonel):');
            if (adminNote === null) return; // İptal edildi
            
            const resolvedData = {
                status: 'resolved',
                reviewedBy: firebase.auth()?.currentUser?.email || 'admin',
                reviewedAt: new Date().toISOString(),
                adminNotes: adminNote || 'Şikayet çözümlendi.'
            };
            
            if (firebase.firestore) {
                firebase.firestore().collection('reports').doc(reportId).update(resolvedData)
                    .then(() => {
                        showAdminActionSuccess('Şikayet başarıyla çözümlendi!');
                        loadReportsData();
                    })
                    .catch((error) => {
                        console.error('Şikayet çözümlenirken hata:', error);
                        showAdminActionSuccess('Şikayet çözümlenirken hata oluştu!', 'error');
                    });
            } else {
                const localReports = JSON.parse(localStorage.getItem('localReports') || '[]');
                const reportIndex = localReports.findIndex(r => r.id === reportId);
                
                if (reportIndex !== -1) {
                    Object.assign(localReports[reportIndex], resolvedData);
                    localStorage.setItem('localReports', JSON.stringify(localReports));
                    showAdminActionSuccess('Şikayet başarıyla çözümlendi! (Local Storage)');
                    loadReportsData();
                } else {
                    alert('Şikayet bulunamadı!');
                }
            }
        }

        // Şikayeti reddet
        function rejectReport(reportId) {
            const rejectReason = prompt('Reddetme nedeninizi girin:');
            if (!rejectReason) return;
            
            const rejectedData = {
                status: 'rejected',
                reviewedBy: firebase.auth()?.currentUser?.email || 'admin',
                reviewedAt: new Date().toISOString(),
                adminNotes: `Reddedildi: ${rejectReason}`
            };
            
            if (firebase.firestore) {
                firebase.firestore().collection('reports').doc(reportId).update(rejectedData)
                    .then(() => {
                        showAdminActionSuccess('Şikayet reddedildi!');
                        loadReportsData();
                    })
                    .catch((error) => {
                        console.error('Şikayet reddedilirken hata:', error);
                        showAdminActionSuccess('Şikayet reddedilirken hata oluştu!', 'error');
                    });
            } else {
                const localReports = JSON.parse(localStorage.getItem('localReports') || '[]');
                const reportIndex = localReports.findIndex(r => r.id === reportId);
                
                if (reportIndex !== -1) {
                    Object.assign(localReports[reportIndex], rejectedData);
                    localStorage.setItem('localReports', JSON.stringify(localReports));
                    showAdminActionSuccess('Şikayet reddedildi! (Local Storage)');
                    loadReportsData();
                } else {
                    alert('Şikayet bulunamadı!');
                }
            }
        }

        // Şikayet detaylarını görüntüle
        function viewReportDetails(reportId) {
            // Report'u bul
            let report = null;
            if (firebase.firestore) {
                firebase.firestore().collection('reports').doc(reportId).get()
                    .then((doc) => {
                        if (doc.exists) {
                            report = doc.data();
                            showReportDetailModal(reportId, report);
                        } else {
                            alert('Şikayet bulunamadı!');
                        }
                    })
                    .catch((error) => {
                        console.error('Şikayet detayları alınamadı:', error);
                        alert('Şikayet detayları alınırken hata oluştu.');
                    });
            } else {
                const localReports = JSON.parse(localStorage.getItem('localReports') || '[]');
                report = localReports.find(r => r.id === reportId);
                if (report) {
                    showReportDetailModal(reportId, report);
                } else {
                    alert('Şikayet bulunamadı!');
                }
            }
        }

        // Şikayet detay modalı
        function showReportDetailModal(reportId, report) {
            const modal = document.createElement('div');
            modal.className = 'admin-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.7);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;
            
            const reportedDate = new Date(report.reportedAt).toLocaleString('tr-TR');
            const reviewedDate = report.reviewedAt ? new Date(report.reviewedAt).toLocaleString('tr-TR') : 'Henüz incelenmedi';
            
            modal.innerHTML = `
                <div class="admin-modal-content" style="background: white; padding: 30px; border-radius: 10px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto;">
                    <div class="admin-modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #ddd; padding-bottom: 15px;">
                        <h3 style="margin: 0;">Şikayet Detayları</h3>
                        <button class="close-modal" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">&times;</button>
                    </div>
                    
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <strong>Şikayet ID:</strong><br>
                                ${reportId}
                            </div>
                            <div>
                                <strong>Durum:</strong><br>
                                <span style="background: ${report.status === 'pending' ? '#ffc107' : report.status === 'resolved' ? '#28a745' : '#dc3545'}; color: white; padding: 2px 6px; border-radius: 3px; font-size: 12px;">
                                    ${report.status === 'pending' ? 'Bekliyor' : report.status === 'resolved' ? 'Çözülmüş' : 'Reddedilmiş'}
                                </span>
                            </div>
                        </div>
                        
                        <div>
                            <strong>Şikayet Türü:</strong><br>
                            ${report.reason}
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <strong>Şikayet Eden:</strong><br>
                                ${report.reportedBy}
                            </div>
                            <div>
                                <strong>E-posta:</strong><br>
                                ${report.reportedByEmail || 'Belirtilmemiş'}
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <strong>Hedef Türü:</strong><br>
                                ${report.targetType === 'question' ? 'Soru' : 'Kullanıcı'}
                            </div>
                            <div>
                                <strong>Hedef ID:</strong><br>
                                ${report.targetId}
                            </div>
                        </div>
                        
                        <div>
                            <strong>Şikayet Edilen İçerik:</strong><br>
                            <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; border-left: 3px solid #dc3545;">
                                "${report.targetContent}"
                            </div>
                        </div>
                        
                        <div>
                            <strong>Şikayet Açıklaması:</strong><br>
                            <div style="background: #f8f9fa; padding: 10px; border-radius: 4px;">
                                ${report.description}
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <strong>Şikayet Tarihi:</strong><br>
                                ${reportedDate}
                            </div>
                            <div>
                                <strong>İncelenme Tarihi:</strong><br>
                                ${reviewedDate}
                            </div>
                        </div>
                        
                        ${report.reviewedBy ? `
                            <div>
                                <strong>İnceleyen Admin:</strong><br>
                                ${report.reviewedBy}
                            </div>
                        ` : ''}
                        
                        ${report.adminNotes ? `
                            <div>
                                <strong>Admin Notları:</strong><br>
                                <div style="background: #e8f5e8; padding: 10px; border-radius: 4px; border-left: 3px solid #28a745;">
                                    ${report.adminNotes}
                                </div>
                            </div>
                        ` : ''}
                        
                        ${report.status === 'pending' ? `
                            <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px; padding-top: 20px; border-top: 1px solid #ddd;">
                                <button class="admin-btn-primary" onclick="resolveReport('${reportId}'); document.body.removeChild(this.closest('.admin-modal'));" style="background: #28a745;">
                                    <i class="fas fa-check"></i> Çözümlendi
                                </button>
                                <button class="admin-btn-secondary" onclick="rejectReport('${reportId}'); document.body.removeChild(this.closest('.admin-modal'));" style="background: #dc3545;">
                                    <i class="fas fa-times"></i> Reddet
                                </button>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Modal olayları
            modal.querySelector('.close-modal').addEventListener('click', () => {
                document.body.removeChild(modal);
            });
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
        }

        // Ayar değişikliklerini takip etme
        function setupSettingsChangeTracking() {
            const settingsInputs = document.querySelectorAll('#admin-settings input, #admin-settings select');
            settingsInputs.forEach(input => {
                input.addEventListener('change', function() {
                    markSettingsAsChanged();
                });
            });
        }

        // Ayarların değiştiğini işaretle
        function markSettingsAsChanged() {
            const saveBtn = document.getElementById('admin-save-settings');
            if (saveBtn) {
                saveBtn.style.background = '#ff9800';
                saveBtn.innerHTML = '<i class="fas fa-save"></i> Değişiklikleri Kaydet';
            }
        }

        // Ayarların kaydedildiğini işaretle
        function markSettingsAsSaved() {
            const saveBtn = document.getElementById('admin-save-settings');
            if (saveBtn) {
                saveBtn.style.background = '#28a745';
                saveBtn.innerHTML = '<i class="fas fa-check"></i> Kaydedildi';
                
                setTimeout(() => {
                    saveBtn.style.background = '#007bff';
                    saveBtn.innerHTML = '<i class="fas fa-save"></i> Ayarları Kaydet';
                }, 2000);
            }
        }

        // Ayarları dışa aktar
        function exportSettings() {
            const settings = {
                maintenanceMode: document.getElementById('admin-maintenance-mode')?.checked || false,
                allowRegistrations: document.getElementById('admin-allow-registrations')?.checked || false,
                questionApprovalRequired: document.getElementById('admin-question-approval')?.checked || false,
                maxFailedLogins: parseInt(document.getElementById('admin-max-failed-login')?.value) || 5,
                emailNewUser: document.getElementById('admin-email-new-user')?.checked || false,
                emailNewReport: document.getElementById('admin-email-new-report')?.checked || false,
                exportedAt: new Date().toISOString(),
                exportedBy: firebase.auth()?.currentUser?.email || 'admin'
            };
            
            const dataStr = JSON.stringify(settings, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `admin_ayarlari_${new Date().toISOString().slice(0, 10)}.json`;
            link.click();
            
            showAdminActionSuccess('Ayarlar başarıyla dışa aktarıldı!');
        }

        // Ayarları içe aktar
        function importSettings() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const settings = JSON.parse(e.target.result);
                        
                        // Ayarları form elementlerine uygula
                        if (settings.maintenanceMode !== undefined) document.getElementById('admin-maintenance-mode').checked = settings.maintenanceMode;
                        if (settings.allowRegistrations !== undefined) document.getElementById('admin-allow-registrations').checked = settings.allowRegistrations;
                        if (settings.questionApprovalRequired !== undefined) document.getElementById('admin-question-approval').checked = settings.questionApprovalRequired;
                        if (settings.maxFailedLogins !== undefined) document.getElementById('admin-max-failed-login').value = settings.maxFailedLogins;
                        if (settings.emailNewUser !== undefined) document.getElementById('admin-email-new-user').checked = settings.emailNewUser;
                        if (settings.emailNewReport !== undefined) document.getElementById('admin-email-new-report').checked = settings.emailNewReport;
                        
                        showAdminActionSuccess('Ayarlar başarıyla içe aktarıldı!');
                        markSettingsAsChanged();
                        
                    } catch (error) {
                        console.error('Ayarlar dosyası okuma hatası:', error);
                        alert('Dosya okunamadı. Lütfen geçerli bir ayarlar dosyası seçin.');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        // Şikayet HTML'i oluştur
        function generateReportHTML(reportId, report) {
            const reportedDate = new Date(report.reportedAt).toLocaleString('tr-TR');
            const reviewedDate = report.reviewedAt ? new Date(report.reviewedAt).toLocaleString('tr-TR') : null;
            
            // Durum rengi
            let statusColor = '#ffc107'; // pending - sarı
            let statusText = 'Bekliyor';
            
            if (report.status === 'resolved') {
                statusColor = '#28a745'; // çözülmüş - yeşil
                statusText = 'Çözülmüş';
            } else if (report.status === 'rejected') {
                statusColor = '#dc3545'; // reddedilmiş - kırmızı
                statusText = 'Reddedilmiş';
            }
            
            // Şikayet türü ikonu
            let typeIcon = 'fas fa-exclamation-triangle';
            if (report.type === 'harassment') typeIcon = 'fas fa-user-slash';
            else if (report.type === 'spam') typeIcon = 'fas fa-ban';
            else if (report.type === 'inappropriate_content') typeIcon = 'fas fa-flag';
            
            return `
                <div class="report-item" data-report-id="${reportId}" style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid ${statusColor}; margin-bottom: 15px;">
                    <div class="report-header" style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                        <div>
                            <h4 style="margin: 0 0 5px 0; color: #333; display: flex; align-items: center;">
                                <i class="${typeIcon}" style="margin-right: 8px; color: ${statusColor};"></i>
                                ${report.reason}
                            </h4>
                            <div style="font-size: 14px; color: #666;">
                                <strong>Şikayet Eden:</strong> ${report.reportedBy} (${report.reportedByEmail || 'E-posta yok'}) |
                                <strong>Hedef:</strong> ${report.targetType === 'question' ? 'Soru' : 'Kullanıcı'} (${report.targetId})
                        </div>
                            <div style="font-size: 12px; color: #888; margin-top: 5px;">
                                <strong>Tarih:</strong> ${reportedDate}
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <span style="background: ${statusColor}; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">
                                ${statusText}
                        </span>
                            <div style="font-size: 10px; color: #666; margin-top: 5px;">
                                ID: ${reportId.substring(0, 8)}...
                            </div>
                        </div>
                    </div>
                    
                    <div class="report-content" style="margin-bottom: 15px;">
                        <div style="margin-bottom: 10px;">
                            <strong>İçerik:</strong> "${report.targetContent}"
                        </div>
                        <div style="margin-bottom: 10px;">
                            <strong>Açıklama:</strong> ${report.description}
                        </div>
                        ${report.adminNotes ? `
                            <div style="background: #e8f5e8; padding: 10px; border-radius: 4px; margin-top: 10px;">
                                <strong>Admin Notları:</strong> ${report.adminNotes}
                                <br><small><strong>İncelendi:</strong> ${reviewedDate} - ${report.reviewedBy}</small>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="report-actions" style="display: flex; gap: 10px; justify-content: flex-end;">
                        ${report.status === 'pending' ? `
                            <button class="admin-btn-primary resolve-report-btn" data-report-id="${reportId}" style="margin-right: 10px;">
                                <i class="fas fa-check"></i> Çöz
                            </button>
                            <button class="admin-btn-secondary reject-report-btn" data-report-id="${reportId}" style="background: #dc3545;">
                                <i class="fas fa-times"></i> Reddet
                            </button>
                        ` : ''}
                        <button class="admin-btn-secondary view-report-details-btn" data-report-id="${reportId}" style="background: #6c757d;">
                            <i class="fas fa-eye"></i> Detayları Gör
                        </button>
                    </div>
                </div>
            `;
        }

        // Şikayet aksiyonları için olay dinleyiciler
        function attachReportActionEvents() {
            // Çöz butonları
            document.querySelectorAll('.resolve-report-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const reportId = this.getAttribute('data-report-id');
                    resolveReport(reportId);
                });
            });

            // Reddet butonları
            document.querySelectorAll('.reject-report-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const reportId = this.getAttribute('data-report-id');
                    rejectReport(reportId);
                });
            });

            // Detayları gör butonları
            document.querySelectorAll('.view-report-details-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const reportId = this.getAttribute('data-report-id');
                    viewReportDetails(reportId);
                });
            });
        }

        // Şikayeti çöz
        function resolveReport(reportId) {
            const adminNotes = prompt('Çözüm notları (opsiyonel):');
            if (adminNotes === null) return; // İptal edildi

            const updateData = {
                status: 'resolved',
                reviewedBy: firebase.auth()?.currentUser?.email || 'admin',
                reviewedAt: new Date().toISOString(),
                adminNotes: adminNotes || 'Şikayet incelendi ve çözüldü.'
            };

            if (firebase.firestore) {
                firebase.firestore().collection('reports').doc(reportId).update(updateData)
                    .then(() => {
                        showAdminActionSuccess('Şikayet çözüldü olarak işaretlendi!');
                        loadReportsData();
                    })
                    .catch((error) => {
                        console.error('Şikayet güncellenirken hata:', error);
                        alert('Şikayet güncellenirken hata oluştu.');
                    });
            } else {
                const localReports = JSON.parse(localStorage.getItem('localReports') || '[]');
                const reportIndex = localReports.findIndex(r => r.id === reportId);
                
                if (reportIndex !== -1) {
                    Object.assign(localReports[reportIndex], updateData);
                    localStorage.setItem('localReports', JSON.stringify(localReports));
                    
                    showAdminActionSuccess('Şikayet çözüldü! (Local Storage)');
                    loadReportsData();
                } else {
                    alert('Şikayet bulunamadı!');
                }
            }
        }

        // Şikayeti reddet
        function rejectReport(reportId) {
            const reason = prompt('Ret sebebi:');
            if (!reason) return;

            const updateData = {
                status: 'rejected',
                reviewedBy: firebase.auth()?.currentUser?.email || 'admin',
                reviewedAt: new Date().toISOString(),
                adminNotes: `Reddedildi: ${reason}`
            };

            if (firebase.firestore) {
                firebase.firestore().collection('reports').doc(reportId).update(updateData)
                    .then(() => {
                        showAdminActionSuccess('Şikayet reddedildi!');
                        loadReportsData();
                    })
                    .catch((error) => {
                        console.error('Şikayet güncellenirken hata:', error);
                        alert('Şikayet güncellenirken hata oluştu.');
                    });
            } else {
                const localReports = JSON.parse(localStorage.getItem('localReports') || '[]');
                const reportIndex = localReports.findIndex(r => r.id === reportId);
                
                if (reportIndex !== -1) {
                    Object.assign(localReports[reportIndex], updateData);
                    localStorage.setItem('localReports', JSON.stringify(localReports));
                    
                    showAdminActionSuccess('Şikayet reddedildi! (Local Storage)');
                    loadReportsData();
                } else {
                    alert('Şikayet bulunamadı!');
                }
            }
        }

        // Şikayet detaylarını görüntüle
        function viewReportDetails(reportId) {
            let reportData = null;

            if (firebase.firestore) {
                firebase.firestore().collection('reports').doc(reportId).get()
                    .then((doc) => {
                        if (doc.exists) {
                            reportData = doc.data();
                            showReportDetailsModal(reportId, reportData);
                        } else {
                            alert('Şikayet bulunamadı!');
                        }
                    })
                    .catch((error) => {
                        console.error('Şikayet detayları alınamadı:', error);
                        alert('Şikayet detayları alınırken hata oluştu.');
                    });
            } else {
                const localReports = JSON.parse(localStorage.getItem('localReports') || '[]');
                reportData = localReports.find(r => r.id === reportId);
                
                if (reportData) {
                    showReportDetailsModal(reportId, reportData);
                } else {
                    alert('Şikayet bulunamadı!');
                }
            }
        }

        // Şikayet detayları modalı
        function showReportDetailsModal(reportId, reportData) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                z-index: 10002;
                display: flex;
                align-items: center;
                justify-content: center;
            `;
            
            const reportedDate = new Date(reportData.reportedAt).toLocaleString('tr-TR');
            const reviewedDate = reportData.reviewedAt ? new Date(reportData.reviewedAt).toLocaleString('tr-TR') : 'Henüz incelenmedi';
            
            modal.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 10px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto;">
                    <h3 style="margin-top: 0; border-bottom: 2px solid #eee; padding-bottom: 10px;">Şikayet Detayları</h3>
                    
                    <div style="margin-bottom: 20px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <strong>Şikayet ID:</strong><br>
                                <code style="background: #f8f9fa; padding: 2px 4px; border-radius: 3px;">${reportId}</code>
                            </div>
                            <div>
                                <strong>Durum:</strong><br>
                                <span style="background: ${reportData.status === 'pending' ? '#ffc107' : reportData.status === 'resolved' ? '#28a745' : '#dc3545'}; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">
                                    ${reportData.status === 'pending' ? 'Bekliyor' : reportData.status === 'resolved' ? 'Çözülmüş' : 'Reddedilmiş'}
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <strong>Şikayet Türü:</strong><br>
                        ${reportData.reason}
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <strong>Şikayet Eden:</strong><br>
                        ${reportData.reportedBy} (${reportData.reportedByEmail || 'E-posta yok'})
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <strong>Hedef:</strong><br>
                        ${reportData.targetType === 'question' ? 'Soru' : 'Kullanıcı'} - ${reportData.targetId}
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <strong>Şikayet Edilen İçerik:</strong><br>
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; border-left: 4px solid #dc3545;">
                            "${reportData.targetContent}"
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <strong>Açıklama:</strong><br>
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 4px;">
                            ${reportData.description}
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <strong>Tarih:</strong><br>
                        ${reportedDate}
                    </div>
                    
                    ${reportData.adminNotes ? `
                        <div style="margin-bottom: 20px;">
                            <strong>Admin Notları:</strong><br>
                            <div style="background: #e8f5e8; padding: 10px; border-radius: 4px; border-left: 4px solid #28a745;">
                                ${reportData.adminNotes}
                                <br><small><strong>İncelendi:</strong> ${reviewedDate} - ${reportData.reviewedBy}</small>
                            </div>
                        </div>
                    ` : ''}
                    
                    <div style="display: flex; gap: 10px; justify-content: flex-end; border-top: 1px solid #eee; padding-top: 20px; margin-top: 20px;">
                        <button id="close-report-details" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-times"></i> Kapat
                            </button>
                        </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Kapat butonu
            document.getElementById('close-report-details').addEventListener('click', function() {
                document.body.removeChild(modal);
            });
            
            // Modal dışına tıklayınca kapat
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
        }

        // Ayarlar verilerini yükle
        function loadSettingsData() {
            console.log('Ayarlar yükleniyor...');
            
            if (firebase.firestore) {
                // Firebase'den ayarları yükle
                firebase.firestore().collection('admin-settings').doc('app-settings').get()
                    .then((doc) => {
                        let settings = {};
                        
                        if (doc.exists) {
                            settings = doc.data();
                        } else {
                            // Varsayılan ayarlar
                            settings = getDefaultSettings();
                            // Firebase'e varsayılan ayarları kaydet
                            firebase.firestore().collection('admin-settings').doc('app-settings').set(settings);
                        }
                        
                        applySettingsToUI(settings);
                    })
                    .catch((error) => {
                        console.error('Ayarlar yüklenirken hata:', error);
                        // Hata durumunda varsayılan ayarları kullan
                        const defaultSettings = getDefaultSettings();
                        applySettingsToUI(defaultSettings);
                    });
            } else {
                // Local storage'dan ayarları yükle
                const localSettings = JSON.parse(localStorage.getItem('adminSettings') || 'null');
                
                if (localSettings) {
                    applySettingsToUI(localSettings);
                } else {
                    // Varsayılan ayarları oluştur ve kaydet
                    const defaultSettings = getDefaultSettings();
                    localStorage.setItem('adminSettings', JSON.stringify(defaultSettings));
                    applySettingsToUI(defaultSettings);
                }
            }
        }

        // Varsayılan ayarları döndür
        function getDefaultSettings() {
            return {
                // Genel Ayarlar
                maintenanceMode: false,
                allowRegistrations: true,
                questionApprovalRequired: true,
                maxFailedLogins: 5,
                
                // E-posta Bildirimleri
                emailNewUser: true,
                emailNewReport: true,
                
                // Diğer ayarlar
                lastUpdated: new Date().toISOString(),
                updatedBy: firebase.auth()?.currentUser?.email || 'admin'
            };
        }

        // Ayarları UI'ya uygula
        function applySettingsToUI(settings) {
            // Genel Ayarlar
            const maintenanceModeToggle = document.getElementById('admin-maintenance-mode');
            const allowRegistrationsToggle = document.getElementById('admin-allow-registrations');
            const questionApprovalToggle = document.getElementById('admin-question-approval');
            const maxFailedLoginsInput = document.getElementById('admin-max-failed-login');
            
            // E-posta Bildirimleri
            const emailNewUserToggle = document.getElementById('admin-email-new-user');
            const emailNewReportToggle = document.getElementById('admin-email-new-report');
            
            // Ayarları form elementlerine uygula
            if (maintenanceModeToggle) maintenanceModeToggle.checked = settings.maintenanceMode || false;
            if (allowRegistrationsToggle) allowRegistrationsToggle.checked = settings.allowRegistrations !== false;
            if (questionApprovalToggle) questionApprovalToggle.checked = settings.questionApprovalRequired !== false;
            if (maxFailedLoginsInput) maxFailedLoginsInput.value = settings.maxFailedLogins || 5;
            
            if (emailNewUserToggle) emailNewUserToggle.checked = settings.emailNewUser !== false;
            if (emailNewReportToggle) emailNewReportToggle.checked = settings.emailNewReport !== false;
            
            console.log('Ayarlar UI\'ya uygulandı:', settings);
            
            // Bakım modu uyarısı göster
            if (settings.maintenanceMode) {
                showMaintenanceModeWarning();
            }
        }

        // Ayarları kaydet
        function saveAdminSettings() {
            // Form verilerini topla
            const settings = {
                // Genel Ayarlar
                maintenanceMode: document.getElementById('admin-maintenance-mode')?.checked || false,
                allowRegistrations: document.getElementById('admin-allow-registrations')?.checked || false,
                questionApprovalRequired: document.getElementById('admin-question-approval')?.checked || false,
                maxFailedLogins: parseInt(document.getElementById('admin-max-failed-login')?.value) || 5,
                
                // E-posta Bildirimleri
                emailNewUser: document.getElementById('admin-email-new-user')?.checked || false,
                emailNewReport: document.getElementById('admin-email-new-report')?.checked || false,
                
                // Meta bilgiler
                lastUpdated: new Date().toISOString(),
                updatedBy: firebase.auth()?.currentUser?.email || 'admin'
            };

            if (firebase.firestore) {
                // Firebase'e kaydet
                firebase.firestore().collection('admin-settings').doc('app-settings').set(settings)
                    .then(() => {
                        showAdminActionSuccess('Ayarlar başarıyla kaydedildi!');
                        console.log('Ayarlar Firebase\'e kaydedildi:', settings);
                        markSettingsAsSaved(); // Kaydet butonunu normale döndür
                        
                        // Bakım modu uyarısı
                        if (settings.maintenanceMode) {
                            showMaintenanceModeWarning();
                        }
                    })
                    .catch((error) => {
                        console.error('Ayarlar kaydedilirken hata:', error);
                        showAdminActionSuccess('Ayarlar kaydedilirken hata oluştu!', 'error');
                    });
            } else {
                // Local storage'a kaydet
                localStorage.setItem('adminSettings', JSON.stringify(settings));
                showAdminActionSuccess('Ayarlar başarıyla kaydedildi! (Local Storage)');
                console.log('Ayarlar Local Storage\'a kaydedildi:', settings);
                markSettingsAsSaved(); // Kaydet butonunu normale döndür
                
                // Bakım modu uyarısı
                if (settings.maintenanceMode) {
                    showMaintenanceModeWarning();
                }
            }
        }

        // Ayarları varsayılana sıfırla
        function resetAdminSettings() {
            if (!confirm('Tüm ayarları varsayılan değerlere sıfırlamak istediğinizden emin misiniz?\n\nBu işlem geri alınamaz.')) {
                return;
            }

            const defaultSettings = getDefaultSettings();

            if (firebase.firestore) {
                // Firebase'de sıfırla
                firebase.firestore().collection('admin-settings').doc('app-settings').set(defaultSettings)
                    .then(() => {
                        showAdminActionSuccess('Ayarlar varsayılana sıfırlandı!');
                        applySettingsToUI(defaultSettings);
                        console.log('Ayarlar varsayılana sıfırlandı');
                    })
                    .catch((error) => {
                        console.error('Ayarlar sıfırlanırken hata:', error);
                        showAdminActionSuccess('Ayarlar sıfırlanırken hata oluştu!', 'error');
                    });
            } else {
                // Local storage'da sıfırla
                localStorage.setItem('adminSettings', JSON.stringify(defaultSettings));
                showAdminActionSuccess('Ayarlar varsayılana sıfırlandı! (Local Storage)');
                applySettingsToUI(defaultSettings);
                console.log('Ayarlar varsayılana sıfırlandı (Local Storage)');
            }
        }

        // Bakım modu uyarısı
        function showMaintenanceModeWarning() {
            const warningMsg = document.createElement('div');
            warningMsg.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #ff9800, #f57c00);
                color: white;
                padding: 15px 25px;
                border-radius: 8px;
                box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
                z-index: 10003;
                font-family: Arial, sans-serif;
                text-align: center;
                max-width: 400px;
                animation: slideDown 0.5s ease;
            `;
            warningMsg.innerHTML = `
                <div style="display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-exclamation-triangle" style="margin-right: 10px; font-size: 18px;"></i>
                    <div>
                        <strong>Bakım Modu Aktif!</strong><br>
                        <small>Uygulama kullanıcılar için kapalı.</small>
                        </div>
                    </div>
                `;
            
            document.body.appendChild(warningMsg);
            
            setTimeout(() => {
                warningMsg.style.opacity = '0';
                warningMsg.style.transition = 'opacity 0.5s';
                setTimeout(() => {
                    if (warningMsg.parentNode) {
                        document.body.removeChild(warningMsg);
                    }
                }, 500);
            }, 5000);
        }

        // Yeni soru modalı oluştur
        function createAddQuestionModal() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.6); z-index: 10000; display: flex;
                justify-content: center; align-items: center; padding: 20px;
                backdrop-filter: blur(5px); animation: fadeIn 0.3s ease-out;
            `;

            // Çeviri fonksiyonunu kullan
            const getTranslation = window.QuizGame ? window.QuizGame.getTranslation.bind(window.QuizGame) : (key) => key;

            modal.innerHTML = `
                <style>
                    @keyframes fadeIn {
                        from { opacity: 0; }
                        to { opacity: 1; }
                    }
                    
                    @keyframes fadeOut {
                        from { opacity: 1; }
                        to { opacity: 0; }
                    }
                    
                    @keyframes slideIn {
                        from { transform: translateY(-20px) scale(0.95); opacity: 0; }
                        to { transform: translateY(0) scale(1); opacity: 1; }
                    }
                </style>
                <div style="
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    border-radius: 20px; padding: 2px; max-width: 650px; width: 100%; 
                    max-height: 90vh; overflow-y: auto; box-shadow: 0 25px 50px rgba(0,0,0,0.3);
                    animation: slideIn 0.3s ease-out;
                ">
                    <div style="
                        background: white; border-radius: 18px; padding: 30px;
                        box-shadow: inset 0 1px 0 rgba(255,255,255,0.1);
                    ">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                            <h3 style="
                                color: #2d3748; font-size: 24px; font-weight: 700; margin: 0;
                                background: linear-gradient(135deg, #667eea, #764ba2);
                                -webkit-background-clip: text; -webkit-text-fill-color: transparent;
                                background-clip: text;
                            ">
                                <i class="fas fa-plus" style="margin-right: 10px;"></i> ${getTranslation('addQuestionModal')}
                            </h3>
                            <button class="close-modal" style="
                                background: #f7fafc; border: none; width: 40px; height: 40px;
                                border-radius: 50%; cursor: pointer; display: flex; align-items: center;
                                justify-content: center; font-size: 18px; color: #a0aec0;
                                transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                            " onmouseover="this.style.background='#fed7d7'; this.style.color='#e53e3e'; this.style.transform='scale(1.1)'"
                               onmouseout="this.style.background='#f7fafc'; this.style.color='#a0aec0'; this.style.transform='scale(1)'">&times;</button>
                    </div>
                    
                    <form id="add-question-form">
                            <div style="margin-bottom: 20px;">
                                <label style="
                                    display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;
                                    font-size: 14px; text-transform: uppercase; letter-spacing: 0.5px;
                                ">📚 ${getTranslation('questionCategory')}</label>
                                <select id="new-question-category" required style="
                                    width: 100%; padding: 12px 15px; border: 2px solid #e2e8f0;
                                    border-radius: 12px; font-size: 16px; background: white;
                                    transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                                " onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 3px rgba(102,126,234,0.1)'"
                                   onblur="this.style.borderColor='#e2e8f0'; this.style.boxShadow='0 2px 4px rgba(0,0,0,0.05)'">
                                    <option value="">🎯 ${getTranslation('selectCategory')}</option>
                                    <option value="Genel Kültür">🌍 ${getTranslation('categoryGeneral')}</option>
                                    <option value="Teknoloji">💻 ${getTranslation('categoryTechnology')}</option>
                                    <option value="Tarih">🏛️ ${getTranslation('categoryHistory')}</option>
                                    <option value="Spor">⚽ ${getTranslation('categorySports')}</option>
                                    <option value="Bilim">🔬 ${getTranslation('categoryScience')}</option>
                                    <option value="Sanat">🎨 ${getTranslation('categoryArt')}</option>
                                    <option value="Edebiyat">📖 ${getTranslation('categoryLiterature')}</option>
                                    <option value="Coğrafya">🗺️ ${getTranslation('categoryGeography')}</option>
                                    <option value="Matematik">🔢 ${getTranslation('categoryMath')}</option>
                                    <option value="Müzik">🎵 ${getTranslation('categoryMusic')}</option>
                            </select>
                    </div>
                        
                            <div style="margin-bottom: 20px;">
                                <label style="
                                    display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;
                                    font-size: 14px; text-transform: uppercase; letter-spacing: 0.5px;
                                ">❓ ${getTranslation('questionText')}</label>
                                <textarea id="new-question-text" required style="
                                    width: 100%; padding: 15px; border: 2px solid #e2e8f0;
                                    border-radius: 12px; height: 100px; resize: vertical; font-size: 16px;
                                    font-family: inherit; line-height: 1.5; background: white;
                                    transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                                " placeholder="${getTranslation('questionPlaceholder')}" 
                                   onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 3px rgba(102,126,234,0.1)'"
                                   onblur="this.style.borderColor='#e2e8f0'; this.style.boxShadow='0 2px 4px rgba(0,0,0,0.05)'"></textarea>
                        </div>
                        
                            <div style="margin-bottom: 20px;">
                                <label style="
                                    display: block; margin-bottom: 12px; font-weight: 600; color: #2d3748;
                                    font-size: 14px; text-transform: uppercase; letter-spacing: 0.5px;
                                ">📝 Seçenekler</label>
                                <div style="display: grid; gap: 12px;">
                                    <input type="text" id="new-option-a" placeholder="🅰️ A seçeneği" required style="
                                        width: 100%; padding: 12px 15px; border: 2px solid #e2e8f0;
                                        border-radius: 12px; font-size: 16px; background: white;
                                        transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                                    " onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 3px rgba(102,126,234,0.1)'"
                                       onblur="this.style.borderColor='#e2e8f0'; this.style.boxShadow='0 2px 4px rgba(0,0,0,0.05)'">
                                    <input type="text" id="new-option-b" placeholder="🅱️ B seçeneği" required style="
                                        width: 100%; padding: 12px 15px; border: 2px solid #e2e8f0;
                                        border-radius: 12px; font-size: 16px; background: white;
                                        transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                                    " onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 3px rgba(102,126,234,0.1)'"
                                       onblur="this.style.borderColor='#e2e8f0'; this.style.boxShadow='0 2px 4px rgba(0,0,0,0.05)'">
                                    <input type="text" id="new-option-c" placeholder="🅾️ C seçeneği" required style="
                                        width: 100%; padding: 12px 15px; border: 2px solid #e2e8f0;
                                        border-radius: 12px; font-size: 16px; background: white;
                                        transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                                    " onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 3px rgba(102,126,234,0.1)'"
                                       onblur="this.style.borderColor='#e2e8f0'; this.style.boxShadow='0 2px 4px rgba(0,0,0,0.05)'">
                                    <input type="text" id="new-option-d" placeholder="🔴 D seçeneği" required style="
                                        width: 100%; padding: 12px 15px; border: 2px solid #e2e8f0;
                                        border-radius: 12px; font-size: 16px; background: white;
                                        transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                                    " onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 3px rgba(102,126,234,0.1)'"
                                       onblur="this.style.borderColor='#e2e8f0'; this.style.boxShadow='0 2px 4px rgba(0,0,0,0.05)'">
                                </div>
                        </div>
                        
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
                                <div>
                                    <label style="
                                        display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;
                                        font-size: 14px; text-transform: uppercase; letter-spacing: 0.5px;
                                    ">✅ Doğru Cevap</label>
                                    <select id="new-correct-answer" required style="
                                        width: 100%; padding: 12px 15px; border: 2px solid #e2e8f0;
                                        border-radius: 12px; font-size: 16px; background: white;
                                        transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                                    " onfocus="this.style.borderColor='#48bb78'; this.style.boxShadow='0 0 0 3px rgba(72,187,120,0.1)'"
                                       onblur="this.style.borderColor='#e2e8f0'; this.style.boxShadow='0 2px 4px rgba(0,0,0,0.05)'">
                                        <option value="">Doğru cevap</option>
                                        <option value="0">🅰️ A Seçeneği</option>
                                        <option value="1">🅱️ B Seçeneği</option>
                                        <option value="2">🅾️ C Seçeneği</option>
                                        <option value="3">🔴 D Seçeneği</option>
                            </select>
                        </div>
                        
                                <div>
                                    <label style="
                                        display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;
                                        font-size: 14px; text-transform: uppercase; letter-spacing: 0.5px;
                                    ">⚡ Zorluk</label>
                                    <select id="new-question-difficulty" required style="
                                        width: 100%; padding: 12px 15px; border: 2px solid #e2e8f0;
                                        border-radius: 12px; font-size: 16px; background: white;
                                        transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                                    " onfocus="this.style.borderColor='#ed8936'; this.style.boxShadow='0 0 0 3px rgba(237,137,54,0.1)'"
                                       onblur="this.style.borderColor='#e2e8f0'; this.style.boxShadow='0 2px 4px rgba(0,0,0,0.05)'">
                                <option value="">Zorluk seçin</option>
                                        <option value="Kolay">🟢 Kolay</option>
                                        <option value="Orta">🟡 Orta</option>
                                        <option value="Zor">🔴 Zor</option>
                            </select>
                                </div>
                        </div>
                        
                            <div style="display: flex; gap: 15px; justify-content: flex-end; padding-top: 20px; border-top: 1px solid #e2e8f0;">
                                <button type="button" class="close-modal" style="
                                    padding: 12px 24px; background: linear-gradient(135deg, #a0aec0, #718096);
                                    color: white; border: none; border-radius: 12px; cursor: pointer;
                                    font-weight: 600; font-size: 16px; transition: all 0.3s ease;
                                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                                " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 20px rgba(0,0,0,0.2)'"
                                   onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)'">
                                    ❌ İptal
                                </button>
                                <button type="submit" style="
                                    padding: 12px 24px; background: linear-gradient(135deg, #48bb78, #38a169);
                                    color: white; border: none; border-radius: 12px; cursor: pointer;
                                    font-weight: 600; font-size: 16px; transition: all 0.3s ease;
                                    box-shadow: 0 4px 12px rgba(72,187,120,0.3);
                                " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 20px rgba(72,187,120,0.4)'"
                                   onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(72,187,120,0.3)'">
                                    ✅ Soru Ekle
                                </button>
                        </div>
                    </form>
                    </div>
                    </div>
                `;

            // Modalı kapatma
            modal.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', () => modal.remove());
            });

            // Modal dışına tıklayınca kapat
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.remove();
            });

            // Form submit
            modal.querySelector('#add-question-form').addEventListener('submit', (e) => {
                e.preventDefault();
                addNewQuestion(modal);
            });

            return modal;
        }

        // Yeni soru ekle
        function addNewQuestion(modal) {
            const newQuestion = {
                id: 'Q' + Date.now(),
                category: modal.querySelector('#new-question-category').value,
                question: modal.querySelector('#new-question-text').value,
                options: [
                    modal.querySelector('#new-option-a').value,
                    modal.querySelector('#new-option-b').value,
                    modal.querySelector('#new-option-c').value,
                    modal.querySelector('#new-option-d').value
                ],
                correctAnswer: parseInt(modal.querySelector('#new-correct-answer').value),
                difficulty: modal.querySelector('#new-question-difficulty').value,
                addedBy: firebase.auth()?.currentUser?.email || 'admin',
                addedAt: new Date().toISOString(),
                status: 'active'
            };

            if (firebase.firestore) {
                firebase.firestore().collection('questions').doc(newQuestion.id).set(newQuestion)
                    .then(() => {
                        showAdminActionSuccess('Soru başarıyla eklendi!');
                        modal.style.animation = 'fadeOut 0.3s ease-out';
                        setTimeout(() => {
                        modal.remove();
                        loadQuestionsData();
                        }, 300);
                    })
                    .catch((error) => {
                        console.error('Soru eklenirken hata:', error);
                        showAdminActionSuccess('Soru eklenirken hata oluştu!', 'error');
                    });
            } else {
                allQuestions.push(newQuestion);
                localStorage.setItem('adminQuestions', JSON.stringify(allQuestions));
                showAdminActionSuccess('Soru başarıyla eklendi! (Local Storage)');
                modal.style.animation = 'fadeOut 0.3s ease-out';
                setTimeout(() => {
                modal.remove();
                loadQuestionsData();
                }, 300);
            }
        }

        // Soruları dışa aktar
        function exportQuestions() {
            const dataToExport = {
                exportDate: new Date().toISOString(),
                exportedBy: firebase.auth()?.currentUser?.email || 'admin',
                source: 'Bilgoo Admin Panel',
                totalQuestions: allQuestions.length,
                questions: allQuestions
            };

            const dataStr = JSON.stringify(dataToExport, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `bilgoo-sorular-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showAdminActionSuccess('Sorular dosyası indirildi!');
        }

        // Soruları içe aktar
        function importQuestions() {
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.json';
            fileInput.addEventListener('change', handleQuestionsImport);
            fileInput.click();
        }

        // Soru dosyası içe aktarma işlemi
        function handleQuestionsImport(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importData = JSON.parse(e.target.result);
                    
                    if (!importData.questions || !Array.isArray(importData.questions)) {
                        alert('Geçersiz soru dosyası formatı!');
                        return;
                    }

                    const questionsToImport = importData.questions;
                    
                    // Onay iste
                    if (!confirm(`${questionsToImport.length} soru içe aktarılacak:\n\nKaynak: ${importData.source || 'Bilinmiyor'}\nTarih: ${importData.exportDate || 'Bilinmiyor'}\n\nDevam edilsin mi?`)) {
                        return;
                    }

                    // Soruları ekle
                if (firebase.firestore) {
                        const batch = firebase.firestore().batch();
                        questionsToImport.forEach((question) => {
                            // ID yoksa oluştur
                            if (!question.id) {
                                question.id = 'Q' + Date.now() + Math.random().toString(36).substr(2, 9);
                            }
                            
                            // İçe aktarma bilgilerini ekle
                            question.importedAt = new Date().toISOString();
                            question.importedBy = firebase.auth()?.currentUser?.email || 'admin';
                            
                            const docRef = firebase.firestore().collection('questions').doc(question.id);
                            batch.set(docRef, question);
                        });

                        batch.commit().then(() => {
                            showAdminActionSuccess(`${questionsToImport.length} soru başarıyla içe aktarıldı!`);
                            loadQuestionsData();
                }).catch((error) => {
                            console.error('Sorular içe aktarılırken hata:', error);
                            showAdminActionSuccess('Sorular içe aktarılırken hata oluştu!', 'error');
                });
            } else {
                        // Local storage'a ekle
                        questionsToImport.forEach((question) => {
                            if (!question.id) {
                                question.id = 'Q' + Date.now() + Math.random().toString(36).substr(2, 9);
                            }
                            question.importedAt = new Date().toISOString();
                            question.importedBy = 'admin';
                        });
                        
                        allQuestions = [...allQuestions, ...questionsToImport];
                        localStorage.setItem('adminQuestions', JSON.stringify(allQuestions));
                        showAdminActionSuccess(`${questionsToImport.length} soru başarıyla içe aktarıldı! (Local Storage)`);
                        loadQuestionsData();
                    }

                } catch (error) {
                    console.error('Dosya okuma hatası:', error);
                    alert('Dosya okunamadı! Geçerli bir JSON dosyası seçin.');
                }
            };
            reader.readAsText(file);
        }
    </script>

    <!-- Yeni soru ekleme fonksiyonu -->
    <script>
        function submitNewQuestion() {
            const form = document.getElementById('question-form');
            const submitBtn = form.querySelector('.submit-button');
            const modal = document.getElementById('add-question-form');
            
            // Loading animasyonu başlat
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;

            // Form verilerini al
            const questionData = {
                id: 'Q' + Date.now() + Math.random().toString(36).substr(2, 9),
                category: document.getElementById('question-category').value,
                question: document.getElementById('question-text').value,
                options: [
                    document.getElementById('option-a').value,
                    document.getElementById('option-b').value,
                    document.getElementById('option-c').value,
                    document.getElementById('option-d').value
                ],
                correctAnswer: parseInt(document.getElementById('correct-answer').value),
                difficulty: parseInt(document.getElementById('question-difficulty').value),
                addedBy: firebase.auth()?.currentUser?.email || 'user',
                addedAt: new Date().toISOString(),
                status: 'pending' // Bekleyen durumda
            };

            // Verileri doğrula
            if (!questionData.category || !questionData.question || 
                questionData.options.some(opt => !opt.trim()) || 
                isNaN(questionData.correctAnswer) || isNaN(questionData.difficulty)) {
                alert('Lütfen tüm alanları doldurun!');
                submitBtn.classList.remove('loading');
                submitBtn.disabled = false;
                return;
            }

            // Firebase bağlantısını kontrol et ve timeout ile LocalStorage'a fallback yap
            let timeoutId;
            let completed = false;

            // 3 saniye timeout
            timeoutId = setTimeout(() => {
                if (!completed) {
                    completed = true;
                    console.log('Firebase timeout - LocalStorage kullanılıyor');
                    saveToLocalStorage();
                }
            }, 3000);

            // Firebase'e kaydet (varsa ve online ise)
            if (firebase.firestore) {
                firebase.firestore().collection('pendingQuestions').doc(questionData.id).set(questionData)
                    .then(() => {
                        if (!completed) {
                            completed = true;
                            clearTimeout(timeoutId);
                            showSuccessMessage('✅ Soru başarıyla eklendi! Onay sürecine alınmıştır.');
                            resetFormAndCloseModal(form, modal, submitBtn);
                        }
                    })
                    .catch((error) => {
                        if (!completed) {
                            completed = true;
                            clearTimeout(timeoutId);
                            console.error('Firebase hatası:', error);
                            console.log('Firebase hatası nedeniyle LocalStorage kullanılıyor');
                            saveToLocalStorage();
                        }
                    });
            } else {
                // Firebase yoksa direkt LocalStorage
                clearTimeout(timeoutId);
                saveToLocalStorage();
            }

            // LocalStorage'a kaydetme fonksiyonu
            function saveToLocalStorage() {
                try {
                    const storedQuestions = JSON.parse(localStorage.getItem('pendingQuestions') || '[]');
                    storedQuestions.push(questionData);
                    localStorage.setItem('pendingQuestions', JSON.stringify(storedQuestions));
                    
                    showSuccessMessage('✅ Soru başarıyla eklendi! (Yerel olarak kaydedildi)');
                    resetFormAndCloseModal(form, modal, submitBtn);
                } catch (error) {
                    console.error('LocalStorage hatası:', error);
                    alert('❌ Soru kaydedilemedi. Lütfen tekrar deneyin.');
                    submitBtn.classList.remove('loading');
                    submitBtn.disabled = false;
                }
            }
        }

        // Form sıfırlama ve modal kapatma
        function resetFormAndCloseModal(form, modal, submitBtn) {
            // Form temizle
            form.reset();
            
            // Loading animasyonunu kaldır
            submitBtn.classList.remove('loading');
            submitBtn.disabled = false;
            
            // Modal'ı kapat (animasyonla)
            modal.style.animation = 'fadeOut 0.3s ease-out';
            setTimeout(() => {
                modal.style.display = 'none';
                modal.style.animation = '';
            }, 300);
        }

        // Başarı mesajı göster
        function showSuccessMessage(message) {
            // Eğer zaten bir mesaj varsa kaldır
            const existingMsg = document.querySelector('.success-message');
            if (existingMsg) {
                existingMsg.remove();
            }

            // Yeni mesaj oluştur
            const successDiv = document.createElement('div');
            successDiv.className = 'success-message';
            successDiv.innerHTML = message;
            successDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #48bb78, #38a169);
                color: white;
                padding: 15px 25px;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(72,187,120,0.3);
                z-index: 10001;
                font-weight: 600;
                font-size: 16px;
                animation: slideInRight 0.5s ease-out;
            `;

            document.body.appendChild(successDiv);

            // 3 saniye sonra kaldır
            setTimeout(() => {
                successDiv.style.animation = 'slideOutRight 0.5s ease-out';
                setTimeout(() => {
                    if (successDiv.parentNode) {
                        successDiv.parentNode.removeChild(successDiv);
                    }
                }, 500);
            }, 3000);
        }
    </script>

    <!-- Ayar değişiklik takibi fonksiyonu -->
    <script>
     function setupSettingsChangeTracking() {
        console.log('Ayarlar değişiklik takibi başlatılıyor...');
        
        // Tüm admin toggle switch'lerini bul
        const adminToggles = document.querySelectorAll('.admin-toggle input[type="checkbox"]');
        
        adminToggles.forEach(toggle => {
            toggle.addEventListener('change', function() {
                console.log(`Ayar değişti: ${this.id} = ${this.checked}`);
                // Değişiklik olduğunu işaretle
                markSettingsAsChanged();
            });
        });

        // Admin input alanlarını izle
        const adminInputs = document.querySelectorAll('.admin-settings-section input, .admin-settings-section select');
        
        adminInputs.forEach(input => {
            input.addEventListener('change', function() {
                console.log(`Ayar değişti: ${this.id} = ${this.value}`);
                markSettingsAsChanged();
            });
        });
    }

    // Ayarların değiştiğini işaretle
    function markSettingsAsChanged() {
        const saveBtn = document.getElementById('admin-save-settings');
        if (saveBtn) {
            saveBtn.style.background = '#ff6b6b';
            saveBtn.textContent = '💾 Değişiklikleri Kaydet';
            saveBtn.classList.add('changes-pending');
        }
    }

    // Admin ayarlarını kaydet
    function saveAdminSettings() {
        console.log('Admin ayarları kaydediliyor...');
        
        const settings = {
            userRegistration: document.getElementById('admin-user-registration')?.checked || false,
            questionSubmission: document.getElementById('admin-question-submission')?.checked || false,
            autoQuestionApproval: document.getElementById('admin-auto-approval')?.checked || false,
            maintenanceMode: document.getElementById('admin-maintenance-mode')?.checked || false,
            enableNotifications: document.getElementById('admin-notifications')?.checked || false,
            enableLeaderboard: document.getElementById('admin-leaderboard')?.checked || false,
            maxQuestionsPerUser: document.getElementById('admin-max-questions')?.value || 10,
            sessionTimeout: document.getElementById('admin-session-timeout')?.value || 30,
            lastUpdated: new Date().toISOString(),
            updatedBy: firebase.auth()?.currentUser?.email || 'admin'
        };

        if (firebase.firestore) {
            firebase.firestore().collection('adminSettings').doc('globalSettings').set(settings)
                .then(() => {
                    showAdminActionSuccess('✅ Ayarlar başarıyla kaydedildi!');
                    resetSaveButton();
                })
                .catch((error) => {
                    console.error('Ayarlar kaydedilirken hata:', error);
                    showAdminActionSuccess('❌ Ayarlar kaydedilemedi!', 'error');
                });
        } else {
            localStorage.setItem('adminSettings', JSON.stringify(settings));
            showAdminActionSuccess('✅ Ayarlar başarıyla kaydedildi! (Local Storage)');
            resetSaveButton();
        }
    }

    // Ayarları sıfırla
    function resetAdminSettings() {
        if (!confirm('⚠️ Tüm ayarlar varsayılan değerlere sıfırlanacak. Emin misiniz?')) {
            return;
        }

        console.log('Admin ayarları sıfırlanıyor...');
        
        const defaultSettings = {
            userRegistration: true,
            questionSubmission: true,
            autoQuestionApproval: false,
            maintenanceMode: false,
            enableNotifications: true,
            enableLeaderboard: true,
            maxQuestionsPerUser: 10,
            sessionTimeout: 30
        };

        // UI'ı güncelle
        Object.keys(defaultSettings).forEach(key => {
            const element = document.getElementById(`admin-${key.replace(/[A-Z]/g, '-$&').toLowerCase()}`);
            if (element) {
                if (element.type === 'checkbox') {
                    element.checked = defaultSettings[key];
                } else {
                    element.value = defaultSettings[key];
                }
            }
        });

        if (firebase.firestore) {
            firebase.firestore().collection('adminSettings').doc('globalSettings').set({
                ...defaultSettings,
                lastUpdated: new Date().toISOString(),
                updatedBy: firebase.auth()?.currentUser?.email || 'admin'
            })
                .then(() => {
                    showAdminActionSuccess('✅ Ayarlar varsayılan değerlere sıfırlandı!');
                    resetSaveButton();
                })
                .catch((error) => {
                    console.error('Ayarlar sıfırlanırken hata:', error);
                    showAdminActionSuccess('❌ Ayarlar sıfırlanamadı!', 'error');
                });
        } else {
            localStorage.setItem('adminSettings', JSON.stringify(defaultSettings));
            showAdminActionSuccess('✅ Ayarlar varsayılan değerlere sıfırlandı! (Local Storage)');
            resetSaveButton();
        }
    }

    // Kaydet butonunu sıfırla
    function resetSaveButton() {
        const saveBtn = document.getElementById('admin-save-settings');
        if (saveBtn) {
            saveBtn.style.background = '';
            saveBtn.textContent = '💾 Ayarları Kaydet';
            saveBtn.classList.remove('changes-pending');
        }
    }

    // Admin işlem sonucu mesajı göster
    function showAdminActionSuccess(message, type = 'success') {
        const existingMsg = document.querySelector('.admin-action-message');
        if (existingMsg) {
            existingMsg.remove();
        }

        const messageDiv = document.createElement('div');
        messageDiv.className = 'admin-action-message';
        messageDiv.innerHTML = message;
        
        const bgColor = type === 'error' ? 'linear-gradient(135deg, #e53e3e, #c53030)' : 'linear-gradient(135deg, #48bb78, #38a169)';
        
        messageDiv.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: ${bgColor};
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 10001;
            font-weight: 600;
            font-size: 16px;
            animation: slideInRight 0.5s ease-out;
            max-width: 300px;
        `;

        document.body.appendChild(messageDiv);

        setTimeout(() => {
            messageDiv.style.animation = 'slideOutRight 0.5s ease-out';
            setTimeout(() => {
                if (messageDiv.parentNode) {
                    messageDiv.parentNode.removeChild(messageDiv);
                }
            }, 500);
        }, 3000);
    }
    </script>

    <!-- PWA Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            // Service Worker'ı hemen kaydet
            navigator.serviceWorker.register('/sw.js', { scope: '/' })
                .then((registration) => {
                    console.log('SW registered: ', registration);
                    
                    // Background sync kaydet
                    if ('sync' in window.ServiceWorkerRegistration.prototype) {
                        console.log('Background sync destekleniyor');
                    }
                    
                    // Periodic sync kaydet
                    if ('periodicSync' in window.ServiceWorkerRegistration.prototype) {
                        registration.periodicSync.register('content-sync', {
                            minInterval: 24 * 60 * 60 * 1000, // 24 saat
                        });
                    }
                    
                    // Update check
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                // Yeni versiyon mevcut - kullanıcıyı bilgilendir
                                showUpdateAvailable();
                            }
                        });
                    });
                })
                .catch((registrationError) => {
                    console.log('SW registration failed: ', registrationError);
                });

            // PWA yükleme prompt'u
            let deferredPrompt;
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                showInstallPrompt();
            });

            // PWA yükleme prompt göster
            function showInstallPrompt() {
                const installBanner = document.createElement('div');
                installBanner.innerHTML = `
                    <div style="
                        position: fixed;
                        bottom: 20px;
                        left: 20px;
                        right: 20px;
                        background: linear-gradient(135deg, #3b82f6, #1d4ed8);
                        color: white;
                        padding: 15px;
                        border-radius: 12px;
                        box-shadow: 0 4px 20px rgba(59, 130, 246, 0.3);
                        z-index: 10000;
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        font-family: 'Poppins', sans-serif;
                        animation: slideInUp 0.5s ease-out;
                    ">
                        <div>
                            <i class="fas fa-mobile-alt" style="margin-right: 10px;"></i>
                            <strong>Ana ekrana ekle</strong><br>
                            <small>Hızlı erişim için uygulamayı yükle</small>
                        </div>
                        <div>
                            <button onclick="installPWA()" style="
                                background: rgba(255,255,255,0.2);
                                border: 1px solid rgba(255,255,255,0.3);
                                color: white;
                                padding: 8px 16px;
                                border-radius: 8px;
                                margin-right: 10px;
                                cursor: pointer;
                                font-weight: 600;
                            ">Yükle</button>
                            <button onclick="dismissInstallPrompt()" style="
                                background: transparent;
                                border: none;
                                color: white;
                                font-size: 18px;
                                cursor: pointer;
                            ">×</button>
                        </div>
                    </div>
                `;
                installBanner.id = 'install-banner';
                document.body.appendChild(installBanner);
            }

            window.installPWA = function() {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            console.log('User accepted the install prompt');
                        }
                        deferredPrompt = null;
                        dismissInstallPrompt();
                    });
                }
            };

            window.dismissInstallPrompt = function() {
                const banner = document.getElementById('install-banner');
                if (banner) {
                    banner.style.animation = 'slideOutDown 0.5s ease-out';
                    setTimeout(() => banner.remove(), 500);
                }
            };

            // Güncelleme mevcut bildirim
            function showUpdateAvailable() {
                const updateBanner = document.createElement('div');
                updateBanner.innerHTML = `
                    <div style="
                        position: fixed;
                        top: 20px;
                        left: 20px;
                        right: 20px;
                        background: linear-gradient(135deg, #059669, #047857);
                        color: white;
                        padding: 15px;
                        border-radius: 12px;
                        box-shadow: 0 4px 20px rgba(5, 150, 105, 0.3);
                        z-index: 10000;
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        font-family: 'Poppins', sans-serif;
                        animation: slideInDown 0.5s ease-out;
                    ">
                        <div>
                            <i class="fas fa-sync-alt" style="margin-right: 10px;"></i>
                            <strong>Güncelleme mevcut!</strong><br>
                            <small>Yeni özellikler için sayfayı yenile</small>
                        </div>
                        <button onclick="window.location.reload()" style="
                            background: rgba(255,255,255,0.2);
                            border: 1px solid rgba(255,255,255,0.3);
                            color: white;
                            padding: 8px 16px;
                            border-radius: 8px;
                            cursor: pointer;
                            font-weight: 600;
                        ">Yenile</button>
                    </div>
                `;
                updateBanner.id = 'update-banner';
                document.body.appendChild(updateBanner);
                
                setTimeout(() => {
                    const banner = document.getElementById('update-banner');
                    if (banner) {
                        banner.style.animation = 'slideOutUp 0.5s ease-out';
                        setTimeout(() => banner.remove(), 500);
                    }
                }, 10000);
            }
        }

        // PWA animasyonları
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInUp {
                from { transform: translateY(100%); opacity: 0; }
                to { transform: translateY(0); opacity: 1; }
            }
            @keyframes slideOutDown {
                from { transform: translateY(0); opacity: 1; }
                to { transform: translateY(100%); opacity: 0; }
            }
            @keyframes slideInDown {
                from { transform: translateY(-100%); opacity: 0; }
                to { transform: translateY(0); opacity: 1; }
            }
            @keyframes slideOutUp {
                from { transform: translateY(0); opacity: 1; }
                to { transform: translateY(-100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>