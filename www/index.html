<!DOCTYPE html>
<html lang="tr" data-theme="light" data-language="tr" id="html-root">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="Bilgoo - Bilginizi test edin!">
    <meta name="theme-color" content="#4a148c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Bilgoo">
    <title>Bilgoo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../style.css">
    <!-- Font Awesome İkonları -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <!-- Favicon -->
    <link rel="icon" href="../bilgoo-logo.svg" type="image/svg+xml">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 400 120%22><text y=%22.9em%22 font-size=%2280%22 fill=%22%234285f4%22>B</text><text x=%2265%22 y=%22.9em%22 font-size=%2280%22 fill=%22%23ea4335%22>i</text><text x=%2290%22 y=%22.9em%22 font-size=%2280%22 fill=%22%23fbbc04%22>l</text><text x=%22115%22 y=%22.9em%22 font-size=%2280%22 fill=%22%234285f4%22>g</text><text x=%22175%22 y=%22.9em%22 font-size=%2280%22 fill=%22%2334a853%22>o</text><text x=%22235%22 y=%22.9em%22 font-size=%2280%22 fill=%22%23ea4335%22>o</text></svg>" sizes="any">
    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="icons/avatars/avatar1.svg">
    <!-- Görsel içeren sorular ve Doğru/Yanlış soruları için stil -->
    <link rel="stylesheet" href="../custom-question-styles.css">
    <!-- Manifest linki direkt olarak ekle -->
    <link rel="manifest" href="manifest.json">
    <!-- Capacitor için gerekli entegrasyon -->
    <script type="module" src="https://unpkg.com/@ionic/pwa-elements@latest/dist/ionicpwaelements/ionicpwaelements.esm.js"></script>
    <script nomodule src="https://unpkg.com/@ionic/pwa-elements@latest/dist/ionicpwaelements/ionicpwaelements.js"></script>
    <!-- Capacitor Uygulama Entegrasyonu -->
    <script src="../capacitor-app.js"></script>
    <style>
        /* Genel stil */
        :root {
            --primary-color: #4a148c;
            --secondary-color: #e91e63;
            --accent-color: #ff9800;
            --text-color: #333;
            --bg-color: #f9f9f9;
            --error-color: #e53935;
            --success-color: #43a047;
            --border-radius: 8px;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            --header-bg: #333;
            --header-text: #fff;
        }

        [data-theme="dark"] {
            --primary-color: #9c27b0;
            --secondary-color: #ff4081;
            --accent-color: #ffb74d;
            --text-color: #f5f5f5;
            --bg-color: #212121;
            --error-color: #e57373;
            --success-color: #81c784;
            --header-bg: #121212;
            --header-text: #f5f5f5;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ... existing styles ... */
        
        /* Profil sayfası stilleri */
        .profile-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .profile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }

        .profile-card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
        }

        .profile-avatar {
            font-size: 48px;
            color: var(--primary-color);
            margin-right: 20px;
            flex: 0 0 80px;
            text-align: center;
        }

        .profile-details {
            flex: 1;
            min-width: 200px;
        }

        .profile-details h2 {
            margin-top: 0;
            color: var(--primary-color);
        }

        .profile-actions-secondary {
            flex: 1 0 100%;
            margin-top: 15px;
            text-align: right;
        }

        .stats-card, .high-scores-card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
        }

        .stat-item {
            text-align: center;
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
            display: block;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
        }

        .high-scores-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .high-scores-table th, .high-scores-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .high-scores-table th {
            background-color: #f5f5f5;
        }

        .profile-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        /* Yükleniyor göstergesi */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-spinner {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .loading-spinner i {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        /* Hata mesajı konteyner */
        .error-container {
            max-width: 500px;
            margin: 100px auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .error-container h3 {
            color: var(--error-color);
            margin-top: 0;
        }

        .error-container i {
            font-size: 28px;
            margin-right: 10px;
        }

        .error-container p {
            margin-bottom: 20px;
        }

        .error-container button {
            margin: 5px;
            min-width: 120px;
        }

        /* Buton stilleri */
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .btn-primary:hover {
            background-color: #7b1fa2;
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .btn-secondary:hover {
            background-color: #c2185b;
        }

        .btn-danger {
            background-color: var(--error-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .btn-danger:hover {
            background-color: #c62828;
        }

        /* Üst bilgi çubuğu (Kullanıcı bilgisi) */
        .user-info-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #333;
            color: white;
            padding: 10px 20px;
            margin-bottom: 20px;
        }

        .user-info {
            display: flex;
            align-items: center;
        }

        .user-info i {
            margin-right: 10px;
            font-size: 18px;
        }

        .user-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            background-color: transparent;
            border: 1px solid white;
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .btn-small:hover {
            background-color: white;
            color: #333;
        }

        /* Karanlık mod ayarları */
        [data-theme="dark"] .profile-card,
        [data-theme="dark"] .stats-card,
        [data-theme="dark"] .high-scores-card,
        [data-theme="dark"] .loading-spinner,
        [data-theme="dark"] .error-container {
            background-color: #333;
            color: #f5f5f5;
        }

        [data-theme="dark"] .stat-item {
            background-color: #444;
        }

        [data-theme="dark"] .high-scores-table th {
            background-color: #444;
        }

        [data-theme="dark"] .high-scores-table td {
            border-bottom: 1px solid #444;
        }

        /* Responsivite için medya sorguları */
        @media (max-width: 600px) {
            .profile-card {
                flex-direction: column;
                text-align: center;
            }

            .profile-avatar {
                margin-right: 0;
                margin-bottom: 15px;
            }

            .user-info-bar {
                flex-direction: column;
                gap: 10px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* ... other existing styles ... */

        /* Hamburger menü stilleri */
        .hamburger-menu {
            position: fixed;
            top: 0;
            right: -300px; /* Başlangıçta gizli */
            width: 300px;
            height: 100%;
            background-color: var(--header-bg);
            color: var(--header-text);
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transition: right 0.3s ease;
            overflow-y: auto;
            padding: 20px 0;
        }

        .hamburger-menu.active {
            right: 0; /* Menü açıldığında görünür */
        }

        .hamburger-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background-color: var(--primary-color);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            cursor: pointer;
            z-index: 1001;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .hamburger-toggle:hover {
            background-color: #7b1fa2;
        }

        .menu-section {
            padding: 15px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .menu-section h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            color: var(--header-text);
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .menu-item {
            padding: 10px 0;
            display: flex;
            align-items: center;
            cursor: pointer;
            color: var(--header-text);
            text-decoration: none;
        }

        .menu-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .menu-item:hover {
            color: var(--secondary-color);
        }

        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
        }

        .menu-overlay.active {
            display: block;
        }

        /* Düzen ayarlamaları */
        body {
            padding-top: 20px; /* Hamburger toggle için alan */
        }

        /* Dil seçimi için stil güncellemesi */
        .hamburger-menu .language-select-wrapper {
            width: 100%;
            margin: 10px 0;
        }

        .hamburger-menu .language-select-wrapper select {
            width: 100%;
            background-color: transparent;
            color: var(--header-text);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            padding: 8px;
        }

        .hamburger-menu .toggle-switch {
            margin-left: auto;
        }

        .user-profile-section {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background-color: rgba(255, 255, 255, 0.05);
        }

        .user-avatar {
            font-size: 24px;
            margin-right: 10px;
        }

        .user-info-menu {
            flex: 1;
        }

        .user-info-menu p {
            margin: 0;
            font-size: 14px;
        }

        .user-info-menu .user-name {
            font-weight: bold;
            font-size: 16px;
        }

        /* Responsive ayarlamalar */
        @media (max-width: 600px) {
            .hamburger-menu {
                width: 80%;
                max-width: 300px;
            }
        }

        /* Boşluk doldurma harfleri görünürlük düzeltmesi */
        .blank-filling-container .letters-container {
            display: flex !important;
            flex-wrap: wrap !important;
            justify-content: center !important;
            visibility: visible !important;
            opacity: 1 !important;
            position: relative !important;
            z-index: 10 !important;
        }

        .tab-button.active {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            background: rgba(0,0,0,0.01);
        }

        /* Toggle switch stillerini güncelleme */
        input:checked + .slider {
            background-color: var(--primary-color);
        }

        /* Dil değiştirici için stiller */
        .language-selector {
            display: flex;
            align-items: center;
            margin-left: auto;
            margin-right: 15px;
        }
        
        .language-selector label {
            margin-right: 5px;
            color: var(--header-text);
            font-size: 14px;
        }
        
        .language-selector select {
            background-color: transparent;
            border: 1px solid rgba(255,255,255,0.3);
            color: var(--header-text);
            padding: 3px 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .language-selector select:hover {
            background-color: rgba(255,255,255,0.1);
        }
        
        .language-selector select option {
            background-color: var(--bg-color);
            color: var(--text-color);
        }
    </style>
</head>
<body>
    <!-- Ana İçerik -->
    <!-- Ses efektleri için audio elementleri -->
    <audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/951/951.wav" preload="auto"></audio>
    <audio id="sound-wrong" src="https://assets.mixkit.co/active_storage/sfx/1021/1021.wav" preload="auto"></audio>
    <audio id="sound-timer" src="https://assets.mixkit.co/active_storage/sfx/3005/3005.wav" preload="auto"></audio>
    <audio id="sound-gameover" src="https://assets.mixkit.co/active_storage/sfx/3006/3006.wav" preload="auto"></audio>
    <audio id="sound-victory" src="https://assets.mixkit.co/active_storage/sfx/2018/2018.wav" preload="auto"></audio>
    
    <!-- Hamburger Menü Toggle -->
    <div class="hamburger-toggle" id="hamburger-toggle">
        <i class="fas fa-bars"></i>
    </div>
    
    <!-- Menü Overlay (Arka plan kapatıcı) -->
    <div class="menu-overlay" id="menu-overlay"></div>
    
    <!-- Hamburger Menü -->
    <div class="hamburger-menu" id="hamburger-menu">
        <!-- Kullanıcı Profil Bilgisi (Oturum açıksa görünür) -->
        <div class="user-profile-section" id="user-profile-section" style="display: none;">
            <div class="user-avatar">
                <i class="fas fa-user-circle"></i>
            </div>
            <div class="user-info-menu">
                <p class="user-name" id="menu-user-name">Kullanıcı</p>
                <p class="user-email" id="menu-user-email">kullanici@email.com</p>
            </div>
        </div>
        
        <!-- Menü Öğeleri -->
        <div class="menu-section">
            <h3 id="menu-app-title">Uygulama</h3>
            <div class="menu-item" id="menu-home">
                <i class="fas fa-home"></i> <span id="menu-home-text">Ana Sayfa</span>
            </div>
            <div class="menu-item" id="menu-profile">
                <i class="fas fa-user"></i> <span id="menu-profile-text">Profilim</span>
            </div>
            <div class="menu-item" id="menu-friends">
                <i class="fas fa-user-friends"></i> <span id="menu-friends-text">Arkadaşlarım</span>
            </div>
            <div class="menu-item" id="menu-leaderboard">
                <i class="fas fa-trophy"></i> <span id="menu-leaderboard-text">Lider Tablosu</span>
            </div>
        </div>
        
        <!-- Ayarlar Bölümü -->
        <div class="menu-section">
            <h3 id="menu-settings-title">Ayarlar</h3>
            <!-- Dil Seçimi -->
            <div class="menu-item">
                <i class="fas fa-language"></i> <span id="menu-language-text">Dil</span>
                <div class="language-select-wrapper">
                    <select id="language-select" onchange="quizApp.switchLanguage(this.value)">
                        <option value="tr">Türkçe</option>
                        <option value="en">English</option>
                        <option value="de">Deutsch</option>
                    </select>
                </div>
            </div>
            
            <!-- Zorluk Seviyesi -->
            <div class="menu-item">
                <i class="fas fa-sliders-h"></i> <span id="menu-difficulty-text">Zorluk</span>
                <select id="difficulty-level" style="margin-left: auto; background: transparent; color: var(--header-text); border: 1px solid rgba(255,255,255,0.3); padding: 5px; border-radius: 4px;">
                    <option value="easy">Kolay</option>
                    <option value="medium" selected>Orta</option>
                    <option value="hard">Zor</option>
                </select>
            </div>
            
            <!-- Ses Ayarları -->
            <div class="menu-item">
                <i class="fas fa-volume-up"></i> <span id="menu-sound-text">Ses</span>
                <div class="toggle-switch">
                    <input type="checkbox" id="sound-toggle" checked />
                    <label for="sound-toggle" class="switch-label"></label>
                </div>
            </div>
            
            <!-- Tema Ayarları -->
            <div class="menu-item">
                <i class="fas fa-moon"></i> <span id="menu-theme-text">Karanlık Tema</span>
                <div class="theme-switch-wrapper">
                    <label class="theme-switch" for="checkbox">
                        <input type="checkbox" id="checkbox" />
                        <div class="slider round">
                            <i class="fas fa-sun"></i>
                            <i class="fas fa-moon"></i>
                        </div>
                    </label>
                </div>
            </div>
        </div>
        
        <!-- Çıkış Bölümü -->
        <div class="menu-section">
            <div class="menu-item" id="menu-logout">
                <i class="fas fa-sign-out-alt"></i> <span id="menu-logout-text">Çıkış Yap</span>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="main-logo-container" style="text-align: center; margin-bottom: 10px;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 140" width="400" height="112" style="max-width: 100%; height: auto;">
                <defs>
                    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
                        <feDropShadow dx="2" dy="4" stdDeviation="3" flood-color="rgba(0,0,0,0.2)"/>
                    </filter>
                    <linearGradient id="blueGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#4285f4;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#1a73e8;stop-opacity:1" />
                    </linearGradient>
                    <linearGradient id="redGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#ea4335;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#d93025;stop-opacity:1" />
                    </linearGradient>
                    <linearGradient id="yellowGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#fbbc04;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#f9ab00;stop-opacity:1" />
                    </linearGradient>
                    <linearGradient id="greenGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#34a853;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#137333;stop-opacity:1" />
                    </linearGradient>
                </defs>
                <text x="60" y="100" font-family="Arial, sans-serif" font-size="100" font-weight="bold" 
                      fill="url(#blueGrad)" filter="url(#shadow)">B</text>
                <text x="135" y="100" font-family="Arial, sans-serif" font-size="100" font-weight="bold" 
                      fill="url(#redGrad)" filter="url(#shadow)">i</text>
                <text x="170" y="100" font-family="Arial, sans-serif" font-size="100" font-weight="bold" 
                      fill="url(#yellowGrad)" filter="url(#shadow)">l</text>
                <text x="205" y="100" font-family="Arial, sans-serif" font-size="100" font-weight="bold" 
                      fill="url(#blueGrad)" filter="url(#shadow)">g</text>
                <text x="275" y="100" font-family="Arial, sans-serif" font-size="100" font-weight="bold" 
                      fill="url(#greenGrad)" filter="url(#shadow)">o</text>
                <text x="345" y="100" font-family="Arial, sans-serif" font-size="100" font-weight="bold" 
                      fill="url(#redGrad)" filter="url(#shadow)">o</text>
            </svg>
        </div>

        <!-- Çevrimiçi oyun bölümü -->
        <div id="online-game-options" style="display: none;">
            <h2><i class="fas fa-globe"></i> <span data-i18n="online_mode">Çevrimiçi Mod</span></h2>
            <div class="online-options">
                <button id="create-room" class="online-btn"><i class="fas fa-plus-circle"></i> <span data-i18n="create_room">Oda Oluştur</span></button>
                <button id="join-room" class="online-btn"><i class="fas fa-sign-in-alt"></i> <span data-i18n="join_room">Odaya Katıl</span></button>
                <button id="back-to-main" class="online-btn"><i class="fas fa-arrow-left"></i> <span data-i18n="back">Geri</span></button>
            </div>
            <div id="room-creation" style="display: none;">
                <input type="text" id="room-name" placeholder="Oda adı" maxlength="20">
                <div class="room-capacity-container">
                    <label for="room-capacity">Oda Kapasitesi:</label>
                    <select id="room-capacity">
                        <option value="2">2 Oyuncu</option>
                        <option value="3">3 Oyuncu</option>
                        <option value="4">4 Oyuncu</option>
                        <option value="5">5 Oyuncu</option>
                        <option value="6">6 Oyuncu</option>
                    </select>
                </div>
                <button id="create-room-submit" class="btn-primary"><i class="fas fa-check-circle"></i> <span data-i18n="create">Oluştur</span></button>
            </div>
            <div id="room-join" style="display: none;">
                <input type="text" id="room-code" placeholder="Oda kodu" maxlength="6">
                <button id="join-room-submit" class="btn-primary"><i class="fas fa-sign-in-alt"></i> <span data-i18n="join">Katıl</span></button>
            </div>
        </div>
        
        <!-- Bekleme odası - çoklu oyun başlığı dışında -->
        <div id="waiting-room" style="display: none;">
            <h3><i class="fas fa-users"></i> <span data-i18n="waiting_players">Oyuncular Bekleniyor</span></h3>
            <div class="room-code-display">
                <p><span data-i18n="room_code">Oda Kodu</span>:</p>
                <div id="display-room-code" class="room-code">XXXXXX</div>
                <button class="copy-code-btn" onclick="navigator.clipboard.writeText(document.getElementById('display-room-code').textContent)"><i class="fas fa-copy"></i></button>
            </div>
            <div class="waiting-room-container">
                <div class="player-list-container">
                    <h4><i class="fas fa-user-friends"></i> <span data-i18n="players">Oyuncular</span></h4>
                    <div id="player-list">
                        <!-- Oyuncular buraya eklenecek -->
                    </div>
                </div>
                
                <div class="chat-container">
                    <div class="chat-header">
                        <h4><i class="fas fa-comments"></i> Sohbet</h4>
                        <button id="chat-rules-btn" class="chat-rules-btn" title="Sohbet kuralları"><i class="fas fa-info-circle"></i></button>
                    </div>
                    <div class="chat-consent-notice" id="chat-consent-notice">
                        <p>Bu sohbetteki mesajlar KVKK/GDPR kapsamında korunmaktadır. Mesajlar süresiz olarak saklanabilir. Kişisel bilgilerinizi paylaşmayınız.</p>
                        <button id="accept-chat-terms" class="accept-btn">Kabul Ediyorum</button>
                        <a href="#" id="chat-policy-link">Gizlilik Politikası</a>
                    </div>
                    <div id="chat-messages" class="chat-messages">
                        <!-- Mesajlar buraya eklenecek -->
                        <div class="system-message">Oda oluşturuldu. Oyuncular bekleniyor...</div>
                    </div>
                    <div class="chat-controls">
                        <div class="chat-input-container">
                            <input type="text" id="chat-input" placeholder="Bir mesaj yazın..." maxlength="100" disabled>
                            <button id="send-message-btn" disabled><i class="fas fa-paper-plane"></i></button>
                        </div>
                        <div class="chat-actions">
                            <button id="report-message-btn" class="action-btn" title="Mesajı bildir"><i class="fas fa-flag"></i></button>
                            <button id="block-user-btn" class="action-btn" title="Kullanıcıyı engelle"><i class="fas fa-ban"></i></button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="waiting-room-actions">
                <button id="start-game" class="btn-success" disabled><i class="fas fa-play"></i> <span data-i18n="start_game">Oyunu Başlat</span></button>
                <button id="leave-room" class="btn-danger"><i class="fas fa-sign-out-alt"></i> <span data-i18n="leave_room">Odadan Ayrıl</span></button>
            </div>
        </div>

        <div id="main-menu" class="main-menu" style="display: none;">
            <div class="menu-buttons">
                <button id="single-player-btn" class="menu-button">Tekli Oyun</button>
                <button id="online-game-button" class="menu-button">Çok Oyunculu</button>
                <button id="view-global-leaderboard" class="menu-button">Küresel Skor Tablosu</button>
                <button id="show-stats" class="menu-button">İstatistikler</button>
                <button id="show-settings" class="menu-button">Ayarlar</button>
                <button id="add-question-button" class="menu-button">Soru Ekle</button>
            </div>
        </div>

        <!-- Kategori seçimi -->
        <div id="category-selection" style="display: none;">
            <h2><i class="fas fa-th-list"></i> <span data-i18n="select_category">Kategori Seçin</span></h2>
            <div id="categories"></div>
        </div>

        <div id="quiz" style="display: none;"> <!-- Başlangıçta gizli -->
            
            <div class="quiz-container">
                <div class="quiz-main">
                    <h2 id="question">Soru burada görünecek</h2>
                    <div id="timer" class="timer-display"><i class="fas fa-hourglass-half"></i> <span data-i18n="time_left">Kalan Süre</span>: <span id="time-left">--</span>sn</div> <!-- Zamanlayıcı Eklendi -->
                    
                    <!-- Can gösterimi -->
                    <div id="lives-container" class="lives-container">
                        <!-- Canlar JavaScript ile dinamik olarak eklenecek -->
                    </div>
                    
                    <!-- Çevrimiçi oyun göstergeleri -->
                    <div id="online-indicators" style="display: none;">
                        <div id="player-scores">
                            <!-- Oyuncu skorları burada gösterilecek -->
                        </div>
                    </div>
                    
                    <!-- Joker butonları -->
                    <div id="jokers">
                        <button id="joker-fifty" class="joker-btn" title="50:50 - İki yanlış cevabı ele"><i class="fas fa-star-half-alt"></i></button>
                        <button id="joker-hint" class="joker-btn" title="İpucu - Doğru cevap hakkında ipucu verir"><i class="fas fa-lightbulb"></i></button>
                        <button id="joker-time" class="joker-btn" title="Süre Uzatma - Sorunun süresini 15 saniye uzatır"><i class="fas fa-clock"></i></button>
                        <button id="joker-skip" class="joker-btn" title="Pas - Bu soruyu atlayın ve puan kaybetmeyin"><i class="fas fa-forward"></i></button>
                        <button id="joker-store" class="joker-store-btn" title="Joker Mağazası - Puanlarınızla joker satın alın"><i class="fas fa-shopping-cart"></i></button>
                    </div>
                    
                    <div id="options">
                        <!-- Seçenekler buraya JavaScript ile eklenecek -->
                    </div>
                    <button id="next-question" style="display: none;"><i class="fas fa-arrow-right"></i> <span data-i18n="next_question">Sonraki Soru</span></button> <!-- Sonraki soru butonu eklendi -->
                </div>
                
                <!-- Oyun sırasında görünecek chat paneli -->
                <div id="game-chat-container" class="game-chat-container">
                    <div class="chat-header">
                        <h4><i class="fas fa-comments"></i> Sohbet</h4>
                        <button id="game-chat-rules-btn" class="chat-rules-btn" title="Sohbet kuralları"><i class="fas fa-info-circle"></i></button>
                    </div>
                    <div class="chat-consent-notice" id="game-chat-consent-notice">
                        <p>Bu sohbetteki mesajlar KVKK/GDPR kapsamında korunmaktadır. Mesajlar süresiz olarak saklanabilir. Kişisel bilgilerinizi paylaşmayınız.</p>
                        <button id="game-accept-chat-terms" class="accept-btn">Kabul Ediyorum</button>
                        <a href="#" id="game-chat-policy-link">Gizlilik Politikası</a>
                    </div>
                    <div id="game-chat-messages" class="chat-messages">
                        <!-- Mesajlar buraya eklenecek -->
                        <div class="system-message">Oyun başladı. İyi şanslar!</div>
                    </div>
                    <div class="chat-controls">
                        <div class="chat-input-container">
                            <input type="text" id="game-chat-input" placeholder="Bir mesaj yazın..." maxlength="100" disabled>
                            <button id="game-send-message-btn" disabled><i class="fas fa-paper-plane"></i></button>
                        </div>
                        <div class="chat-actions">
                            <button id="game-report-message-btn" class="action-btn" title="Mesajı bildir"><i class="fas fa-flag"></i></button>
                            <button id="game-block-user-btn" class="action-btn" title="Kullanıcıyı engelle"><i class="fas fa-ban"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Kazanan ekranı -->
        <div id="winner-screen" style="display: none;" class="winner-container">
            <div class="winner-content">
                <h2><i class="fas fa-trophy"></i> <span data-i18n="winner">Kazanan</span></h2>
                <div class="winner-info">
                    <div id="winner-name" class="winner-name">Oyuncu Adı</div>
                    <div id="winner-score" class="winner-score">Skor: 0/10</div>
                </div>
                <div class="winner-medal">🏆</div>
                <div id="all-player-results" class="all-player-results">
                    <!-- Diğer oyuncuların sonuçları burada listelenecek -->
                </div>
                <div class="winner-actions">
                    <button id="play-again-btn" class="btn-primary"><i class="fas fa-redo"></i> <span data-i18n="play_again">Tekrar Oyna</span></button>
                    <button id="back-to-menu-btn" class="btn-secondary"><i class="fas fa-home"></i> <span data-i18n="main_menu">Ana Menü</span></button>
                </div>
            </div>
        </div>

        <!-- Lider tablosu -->
        <div id="global-leaderboard" style="display: none;">
            <h2><i class="fas fa-trophy"></i> <span data-i18n="leaderboard_title">Küresel Lider Tablosu</span></h2>
            
            <div class="leaderboard-filters">
                <select id="leaderboard-category">
                    <option value="all" data-i18n="leaderboard_all">Tüm Kategoriler</option>
                    <option value="Genel Kültür" data-i18n="categoryGeneral">Genel Kültür</option>
                    <option value="Bilim" data-i18n="categoryScience">Bilim</option>
                    <option value="Teknoloji" data-i18n="categoryTechnology">Teknoloji</option>
                    <option value="Spor" data-i18n="categorySports">Spor</option>
                    <option value="Müzik" data-i18n="categoryMusic">Müzik</option>
                    <option value="Edebiyat" data-i18n="categoryLiterature">Edebiyat</option>
                    <option value="Tarih" data-i18n="categoryHistory">Tarih</option>
                </select>
                <select id="leaderboard-time">
                    <option value="weekly" data-i18n="leaderboard_weekly">Haftalık</option>
                    <option value="monthly" data-i18n="leaderboard_monthly">Aylık</option>
                    <option value="alltime" data-i18n="leaderboard_alltime">Tüm Zamanlar</option>
                </select>
                <button id="refresh-leaderboard" class="refresh-btn"><i class="fas fa-sync-alt"></i> <span data-i18n="leaderboard_refresh">Yenile</span></button>
            </div>
            
            <div id="leaderboard-list" class="leaderboard-list">
                <!-- Lider tablosu burada gösterilecek -->
            </div>
            
            <div class="leaderboard-info">
                <p><i class="fas fa-info-circle"></i> <span data-i18n="leaderboard_info">Yüksek skorlar, her kategorideki doğru cevap oranına göre sıralanır.</span></p>
                <p><span data-i18n="leaderboard_filter_info">Filtreleri kullanarak farklı kategorilerdeki ve zaman dilimlerindeki skorları görebilirsiniz.</span></p>
            </div>
            
            <button id="back-from-leaderboard" class="back-btn"><i class="fas fa-arrow-left"></i> <span data-i18n="back_to_menu">Ana Menüye Dön</span></button>
        </div>

        <!-- Profil Sayfası -->
        <div id="profile-page" style="display: none;">
            <h2><i class="fas fa-user"></i> Profil Sayfası</h2>
            
            <div class="profile-container">
                <div class="profile-card">
                    <div class="profile-avatar">
                        <i class="fas fa-user-circle fa-4x"></i>
                    </div>
                    <div class="profile-details">
                        <h2 id="profile-name">Kullanıcı Adı</h2>
                        <p id="profile-email">kullanici@email.com</p>
                        <p class="profile-since">Üyelik: <span id="profile-join-date">01.01.2025</span></p>
                    </div>
                    <div class="profile-actions-secondary">
                        <button class="btn-secondary" id="edit-profile-btn"><i class="fas fa-edit"></i> Profili Düzenle</button>
                    </div>
                </div>
                
                <div class="stats-card">
                    <h3><i class="fas fa-chart-line"></i> İstatistikler</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-value" id="stats-total-games">0</span>
                            <span class="stat-label">Toplam Oyun</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="stats-total-questions">0</span>
                            <span class="stat-label">Toplam Soru</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="stats-correct-answers">0</span>
                            <span class="stat-label">Doğru Cevap</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="stats-accuracy">%0</span>
                            <span class="stat-label">Doğruluk Oranı</span>
                        </div>
                    </div>
                </div>
                
                <div class="badges-showcase">
                    <h3><i class="fas fa-award"></i> Rozetler</h3>
                    <div class="badges-grid" id="profile-badges-container">
                        <!-- Rozetler burada gösterilecek -->
                        <div class="badge-placeholder">Henüz rozet kazanılmadı</div>
                    </div>
                </div>
                
                <div class="high-scores-card">
                    <h3><i class="fas fa-trophy"></i> En Yüksek Skorlar</h3>
                    <table class="high-scores-table">
                        <thead>
                            <tr>
                                <th>Kategori</th>
                                <th>Skor</th>
                                <th>Tarih</th>
                            </tr>
                        </thead>
                        <tbody id="profile-high-scores">
                            <!-- Yüksek skorlar burada gösterilecek -->
                            <tr><td colspan="3" class="no-data">Henüz kaydedilen skor yok</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="recent-activities">
                    <h3><i class="fas fa-history"></i> Son Aktiviteler</h3>
                    <div class="activity-list" id="recent-activities-list">
                        <!-- Aktiviteler burada gösterilecek -->
                        <div class="activity-item">
                            <div class="activity-icon"><i class="fas fa-gamepad"></i></div>
                            <div class="activity-details">
                                <div class="activity-title">Genel Kültür kategorisinde bir oyun oynandı</div>
                                <div class="activity-time">4 saat önce</div>
                            </div>
                            <div class="activity-score">Skor: 75</div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon"><i class="fas fa-award"></i></div>
                            <div class="activity-details">
                                <div class="activity-title">"Bilgi Ustası" rozeti kazanıldı</div>
                                <div class="activity-time">2 gün önce</div>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon"><i class="fas fa-tasks"></i></div>
                            <div class="activity-details">
                                <div class="activity-title">3 günlük görev tamamlandı</div>
                                <div class="activity-time">3 gün önce</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="profile-actions">
                    <button class="btn-primary" id="back-from-profile"><i class="fas fa-arrow-left"></i> Ana Menüye Dön</button>
                    <button class="btn-danger" id="logout-from-profile"><i class="fas fa-sign-out-alt"></i> Çıkış Yap</button>
                </div>
            </div>
        </div>

        <div id="result" style="display: none;">
            <h2><i class="fas fa-trophy"></i> <span data-i18n="result">Sonuç</span></h2>
            <div id="confetti-container"></div> <!-- Konfeti için container -->
            <p id="score"></p>
            
            <!-- Başarı rozetleri -->
            <div id="badges" class="badges-container">
                <!-- Rozetler JavaScript ile eklenecek -->
            </div>
            
            <!-- İstatistikler -->
            <div id="stats" class="stats-container">
                <h3><i class="fas fa-chart-bar"></i> <span data-i18n="statistics">İstatistikler</span></h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-value" id="total-questions">0</span>
                        <span class="stat-label" data-i18n="total_questions">Toplam Soru</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="correct-answers">0</span>
                        <span class="stat-label" data-i18n="correct_answers">Doğru Cevap</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="average-time">0s</span>
                        <span class="stat-label" data-i18n="average_time">Ort. Süre</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="best-category">-</span>
                        <span class="stat-label" data-i18n="best_category">En İyi Kategori</span>
                    </div>
                </div>
            </div>
            
            <button id="restart"><i class="fas fa-redo"></i> <span data-i18n="back_to_categories">Kategori Seçimine Dön</span></button>
            <button id="share-score"><i class="fas fa-share-alt"></i> <span data-i18n="share_score">Skoru Paylaş</span></button>
            <button id="report-question" class="report-question" style="display: none;"><i class="fas fa-flag"></i> <span data-i18n="report_question">Soruyu Bildir</span></button>
            
            <!-- Yeni sekme sistemi -->
            <div class="result-tabs">
                <div class="tab-nav">
                    <button class="tab-button active" data-tab="high-scores"><i class="fas fa-trophy"></i> Yüksek Skorlar</button>
                    <button class="tab-button" data-tab="daily-tasks"><i class="fas fa-tasks"></i> Günlük Görevler</button>
                    <button class="tab-button" data-tab="achievements"><i class="fas fa-award"></i> Başarımlar</button>
                    <button class="tab-button" data-tab="progress" id="progress-tab"><i class="fas fa-chart-line"></i> İlerleme</button>
                    <button class="tab-button" data-tab="feedbacks"><i class="fas fa-comment-alt"></i> Bildirimler</button>
                </div>
                
                <div class="tab-content">
                    <!-- Yüksek Skorlar Sekmesi -->
                    <div class="tab-pane active" id="high-scores-tab">
                        <div id="high-scores">
                            <h3><i class="fas fa-medal"></i> <span data-i18n="high_scores">En Yüksek Skorlar</span></h3>
                            <ul id="high-scores-list">
                                <!-- Skorlar buraya eklenecek -->
                            </ul>
                        </div>
                    </div>
                    
                    <!-- Günlük Görevler Sekmesi -->
                    <div class="tab-pane" id="daily-tasks-tab">
                        <div id="daily-tasks-container">
                            <!-- Günlük görevler buraya JavaScript ile eklenecek -->
                        </div>
                    </div>
                    
                    <!-- Başarımlar Sekmesi -->
                    <div class="tab-pane" id="achievements-tab">
                        <div id="achievements-container">
                            <!-- Başarımlar buraya JavaScript ile eklenecek -->
                        </div>
                    </div>
                    
                    <!-- İlerleme Sekmesi -->
                    <div class="tab-pane" id="progress-tab">
                        <div class="charts-container">
                            <div class="chart-section">
                                <h3><i class="fas fa-chart-bar"></i> Kategori Başarısı</h3>
                                <div class="chart-wrapper">
                                    <canvas id="category-chart"></canvas>
                                </div>
                            </div>
                            
                            <div class="chart-section">
                                <h3><i class="fas fa-chart-line"></i> Zaman İçindeki Performans</h3>
                                <div class="chart-wrapper">
                                    <canvas id="time-chart"></canvas>
                                </div>
                            </div>
                            
                            <button id="update-charts" class="update-btn"><i class="fas fa-sync"></i> Grafikleri Güncelle</button>
                        </div>
                    </div>
                    
                    <!-- Bildirimler Sekmesi -->
                    <div class="tab-pane" id="feedbacks-tab">
                        <div class="feedbacks-container">
                            <h3><i class="fas fa-comment-alt"></i> Soru Bildirimleri</h3>
                            <div id="feedback-list">
                                <!-- Bildirimler buraya JavaScript ile eklenecek -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Soru Ekleme Formu -->
        <div id="add-question-form" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Yeni Soru Ekle</h2>
                <form id="question-form">
                    <div class="form-group">
                        <label for="question-category">Kategori:</label>
                        <select id="question-category" required>
                            <!-- Kategoriler JavaScript ile doldurulacak -->
                        </select>
                        <button type="button" id="new-category-button">Yeni Kategori</button>
                    </div>
                    <div id="new-category-input" style="display: none;">
                        <input type="text" id="new-category-name" placeholder="Yeni kategori adı">
                        <button type="button" id="save-category-button">Kaydet</button>
                        <button type="button" id="cancel-category-button">İptal</button>
                    </div>
                    <div class="form-group">
                        <label for="question-text">Soru:</label>
                        <textarea id="question-text" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Şıklar:</label>
                        <input type="text" id="option-a" placeholder="A Şıkkı" required>
                        <input type="text" id="option-b" placeholder="B Şıkkı" required>
                        <input type="text" id="option-c" placeholder="C Şıkkı" required>
                        <input type="text" id="option-d" placeholder="D Şıkkı" required>
                    </div>
                    <div class="form-group">
                        <label for="correct-answer">Doğru Cevap:</label>
                        <select id="correct-answer" required>
                            <option value="">Doğru cevabı seçin</option>
                            <option value="0">A Şıkkı</option>
                            <option value="1">B Şıkkı</option>
                            <option value="2">C Şıkkı</option>
                            <option value="3">D Şıkkı</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="question-difficulty">Zorluk Seviyesi:</label>
                        <select id="question-difficulty" required>
                            <option value="1">Kolay</option>
                            <option value="2">Orta</option>
                            <option value="3">Zor</option>
                        </select>
                    </div>
                    <button type="submit" class="submit-button">Soruyu Ekle</button>
                </form>
            </div>
        </div>

        <footer>
            <div class="company-info">
                <div class="logo">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="32" height="32">
                        <!-- Yaprak şekli -->
                        <path d="M25,2 C22,5 12,12 8,18 C4,24 5,36 12,40 C19,44 28,45 35,40 C42,35 43,28 42,22 C41,16 35,10 30,6 C27,4 25,2 25,2 Z" fill="#4CAF50"/>
                        
                        <!-- Devre yolları olarak yaprak damarları -->
                        <path d="M25,2 C25,15 25,28 25,40" stroke="white" stroke-width="1.2" fill="none"/>
                        <circle cx="25" cy="2" r="1" fill="white"/>
                        <circle cx="25" cy="15" r="1" fill="white"/>
                        <circle cx="25" cy="28" r="1" fill="white"/>
                        <circle cx="25" cy="40" r="1" fill="white"/>
                        
                        <path d="M10,18 C20,20 30,18 40,20" stroke="white" stroke-width="1.2" fill="none"/>
                        <circle cx="10" cy="18" r="1" fill="white"/>
                        <circle cx="20" cy="20" r="1" fill="white"/>
                        <circle cx="30" cy="18" r="1" fill="white"/>
                        <circle cx="40" cy="20" r="1" fill="white"/>
                        
                        <path d="M12,32 C20,34 30,32 38,30" stroke="white" stroke-width="1.2" fill="none"/>
                        <circle cx="12" cy="32" r="1" fill="white"/>
                        <circle cx="20" cy="34" r="1" fill="white"/>
                        <circle cx="30" cy="32" r="1" fill="white"/>
                        <circle cx="38" cy="30" r="1" fill="white"/>
                        
                        <!-- Diğer devre yolları -->
                        <path d="M15,10 L35,10 L35,20 L30,20 L30,25 L35,25 L35,30 L25,30 L25,35 L15,35 L15,25 L20,25 L20,20 L15,20 Z" 
                              stroke="white" stroke-width="1.2" fill="none"/>
                        <circle cx="15" cy="10" r="1" fill="white"/>
                        <circle cx="35" cy="10" r="1" fill="white"/>
                        <circle cx="35" cy="20" r="1" fill="white"/>
                        <circle cx="30" cy="20" r="1" fill="white"/>
                        <circle cx="30" cy="25" r="1" fill="white"/>
                        <circle cx="35" cy="25" r="1" fill="white"/>
                        <circle cx="35" cy="30" r="1" fill="white"/>
                        <circle cx="25" cy="30" r="1" fill="white"/>
                        <circle cx="25" cy="35" r="1" fill="white"/>
                        <circle cx="15" cy="35" r="1" fill="white"/>
                        <circle cx="15" cy="25" r="1" fill="white"/>
                        <circle cx="20" cy="25" r="1" fill="white"/>
                        <circle cx="20" cy="20" r="1" fill="white"/>
                        <circle cx="15" cy="20" r="1" fill="white"/>
                    </svg>
                </div>
                <p>&copy; 2025 TEKNOVA BİLİŞİM</p>
            </div>
        </footer>
    </div>

    <!-- Konfeti library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <!-- Chart.js için CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Firebase için CDN -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="../firebase-config.js"></script>
    <!-- Diğer JS dosyaları -->
    <!-- Dil dosyası -->
    <script src="../languages.js"></script>
    <script src="../script.js"></script>
    <script src="../online-game.js"></script>
    <script src="../friends.js"></script>
    <script src="../daily-tasks.js"></script>
    <script src="../achievements.js"></script>
    <script src="../progress-chart.js"></script>
    <script src="../feedback.js"></script>
    
    <!-- Service Worker kaydı -->
    <script>
        // Service Worker kaydı
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('../service-worker.js')
                    .then(registration => {
                        console.log('Service Worker başarıyla kaydedildi:', registration);
                        
                        // Önbelleği temizleme işlemi
                        if (navigator.serviceWorker.controller) {
                            console.log('Önbellek temizleme isteği gönderiliyor...');
                            navigator.serviceWorker.controller.postMessage({
                                action: 'clearCache'
                            });
                        } else {
                            console.log('Service Worker henüz aktif değil, önbellek temizlenemiyor');
                            // Service Worker'ın aktifleşmesini bekleyelim
                            navigator.serviceWorker.addEventListener('controllerchange', () => {
                                console.log('Service Worker aktifleşti, önbellek temizleniyor...');
                                navigator.serviceWorker.controller.postMessage({
                                    action: 'clearCache'
                                });
                            });
                        }
                    })
                    .catch(error => {
                        console.log('Service Worker kaydı başarısız:', error);
                    });
            });
        }
    </script>

    <script>
        // Hamburger menü işlevleri
        document.addEventListener('DOMContentLoaded', function() {
            const hamburgerToggle = document.getElementById('hamburger-toggle');
            const hamburgerMenu = document.getElementById('hamburger-menu');
            const menuOverlay = document.getElementById('menu-overlay');
            
            // Menüyü aç/kapat
            hamburgerToggle.addEventListener('click', function() {
                hamburgerMenu.classList.toggle('active');
                menuOverlay.classList.toggle('active');
                
                // Toggle ikonunu değiştir
                const icon = hamburgerToggle.querySelector('i');
                if (hamburgerMenu.classList.contains('active')) {
                    icon.classList.remove('fa-bars');
                    icon.classList.add('fa-times');
                } else {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            });
            
            // Overlay'e tıklayınca menüyü kapat
            menuOverlay.addEventListener('click', function() {
                hamburgerMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
                
                // İkonu bars'a geri çevir
                const icon = hamburgerToggle.querySelector('i');
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            });
            
            // Menü öğelerine olay dinleyiciler ekle
            document.getElementById('menu-home').addEventListener('click', function() {
                hamburgerMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
                
                // Ana sayfaya yönlendir
                const mainMenu = document.getElementById('main-menu');
                const categorySelectionElement = document.getElementById('category-selection');
                const quizElement = document.getElementById('quiz');
                const resultElement = document.getElementById('result');
                
                if (mainMenu) {
                    mainMenu.style.display = 'block';
                    if (categorySelectionElement) categorySelectionElement.style.display = 'none';
                    if (quizElement) quizElement.style.display = 'none';
                    if (resultElement) resultElement.style.display = 'none';
                }
            });
            
            document.getElementById('menu-profile').addEventListener('click', function() {
                hamburgerMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
                
                // Profil sayfasını göster
                if (typeof quizApp !== 'undefined' && typeof quizApp.showProfilePage === 'function') {
                    quizApp.showProfilePage();
                } else {
                    // quizApp veya fonksiyon yoksa uyarı göster
                    alert('Profil sayfası şu anda kullanılamıyor.');
                }
            });
            
            document.getElementById('menu-friends').addEventListener('click', function() {
                hamburgerMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
                
                // Arkadaşlar sayfasını göster
                if (window.friendsModule && window.friendsModule.showFriendsPage) {
                    window.friendsModule.showFriendsPage();
                }
            });
            
            document.getElementById('menu-leaderboard').addEventListener('click', function() {
                hamburgerMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
                
                // Lider tablosunu göster
                if (typeof quizApp !== 'undefined' && typeof quizApp.showGlobalLeaderboard === 'function') {
                    quizApp.showGlobalLeaderboard();
                } else {
                    // quizApp veya fonksiyon yoksa
                    const globalLeaderboard = document.getElementById('global-leaderboard');
                    if (globalLeaderboard) {
                        // Önce diğer alanları gizle
                        const elementsToHide = ['main-menu', 'quiz', 'category-selection', 'result', 'profile-page', 'online-game-options'];
                        elementsToHide.forEach(id => {
                            const element = document.getElementById(id);
                            if (element) element.style.display = 'none';
                        });
                        
                        // Lider tablosunu göster
                        globalLeaderboard.style.display = 'block';
                    } else {
                        alert('Lider tablosu şu anda kullanılamıyor.');
                    }
                }
            });
            
            document.getElementById('menu-logout').addEventListener('click', function() {
                hamburgerMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
                
                // Çıkış yap
                if (firebase.auth) {
                    firebase.auth().signOut().then(() => {
                        window.location.href = '../login.html';
                    });
                }
            });
            
            // Firebase auth state change dinleyicisi
            if (firebase.auth) {
                firebase.auth().onAuthStateChanged(function(user) {
                    const userProfileSection = document.getElementById('user-profile-section');
                    
                    if (user && !user.isAnonymous) {
                        // Kullanıcı bilgilerini menüde göster
                        userProfileSection.style.display = 'flex';
                        document.getElementById('menu-user-name').textContent = user.displayName || 'Kullanıcı';
                        document.getElementById('menu-user-email').textContent = user.email || '';
                        
                        // Çıkış öğesini göster
                        document.getElementById('menu-logout').style.display = 'flex';
                        document.getElementById('menu-profile').style.display = 'flex';
                    } else {
                        // Kullanıcı bilgilerini gizle
                        userProfileSection.style.display = 'none';
                        
                        // Çıkış öğesini gizle (giriş yapmamış kullanıcı için)
                        document.getElementById('menu-logout').style.display = 'none';
                        document.getElementById('menu-profile').style.display = 'none';
                    }
                });
            }
            
            // Ana menüye dön butonu için olay dinleyici
            const backFromProfileBtn = document.getElementById('back-from-profile');
            if (backFromProfileBtn) {
                backFromProfileBtn.addEventListener('click', function() {
                    // Profil sayfasını gizle
                    const profilePage = document.getElementById('profile-page');
                    if (profilePage) profilePage.style.display = 'none';
                    
                    // Ana menüyü göster
                    const mainMenu = document.getElementById('main-menu');
                    if (mainMenu) mainMenu.style.display = 'block';
                });
            }
            
            // Lider tablosundan ana menüye dön butonu için olay dinleyici
            const backFromLeaderboardBtn = document.getElementById('back-from-leaderboard');
            if (backFromLeaderboardBtn) {
                backFromLeaderboardBtn.addEventListener('click', function() {
                    // Lider tablosunu gizle
                    const leaderboard = document.getElementById('global-leaderboard');
                    if (leaderboard) leaderboard.style.display = 'none';
                    
                    // Ana menüyü göster
                    const mainMenu = document.getElementById('main-menu');
                    if (mainMenu) mainMenu.style.display = 'block';
                });
            }
            
            // Profilden çıkış yapma butonu için olay dinleyici
            const logoutFromProfileBtn = document.getElementById('logout-from-profile');
            if (logoutFromProfileBtn) {
                logoutFromProfileBtn.addEventListener('click', function() {
                    // Firebase ile çıkış yap
                    if (firebase.auth) {
                        firebase.auth().signOut().then(() => {
                            window.location.href = '../login.html';
                        }).catch(error => {
                            console.error("Çıkış yapılırken hata oluştu:", error);
                            alert("Çıkış yapılırken bir hata oluştu");
                        });
                    }
                });
            }
            
            // Çıkış butonu kaldırıldı
            
            // Profil düzenleme butonu için olay dinleyici
            const editProfileBtn = document.getElementById('edit-profile-btn');
            if (editProfileBtn) {
                editProfileBtn.addEventListener('click', function() {
                    alert("Profil düzenleme özelliği yakında eklenecek!");
                });
            }
        });
    </script>

    <script>
        // Sayfa yüklendiğinde, localStorage'da kayıtlı dili kontrol et ve ayarla
        document.addEventListener('DOMContentLoaded', function() {
            // Dil seçimi işleminin quizApp yüklendikten sonra yapılmasını sağla
            setTimeout(function() {
                if (window.quizApp && window.quizApp.currentLanguage) {
                    // Dil seçim dropdownunu mevcut dile göre ayarla
                    const languageSelect = document.getElementById('language-select');
                    if (languageSelect) {
                        for (let i = 0; i < languageSelect.options.length; i++) {
                            if (languageSelect.options[i].value === window.quizApp.currentLanguage) {
                                languageSelect.selectedIndex = i;
                                break;
                            }
                        }
                    }
                    
                    // HTML lang özelliğini güncelle
                    document.documentElement.setAttribute('lang', window.quizApp.currentLanguage);
                    document.documentElement.setAttribute('data-language', window.quizApp.currentLanguage);
                    
                    // UI'ı güncelle
                    if (typeof window.quizApp.updateUITexts === 'function') {
                        window.quizApp.updateUITexts();
                    }
                }
            }, 500); // quizApp'in yüklenmesi için biraz bekle
        });
    </script>

    <!-- Joker Mağazası Modal -->
    <div id="joker-store-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-store"></i> Joker Mağazası</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="joker-store-points">
                    <i class="fas fa-coins"></i> Puanınız: <span id="joker-store-points-display">0</span>
                </div>
                <div class="joker-store-items">
                    <div class="joker-store-item" data-joker="fifty" data-price="10">
                        <div class="joker-icon"><i class="fas fa-star-half-alt"></i></div>
                        <div class="joker-info">
                            <h3>50:50 Joker</h3>
                            <p>İki yanlış şıkkı eleme</p>
                            <div class="joker-price">10 <i class="fas fa-coins"></i></div>
                        </div>
                        <div class="joker-count">Sahip olduğunuz: <span class="joker-owned-count">0</span></div>
                        <button class="joker-buy-btn">Satın Al</button>
                    </div>
                    <div class="joker-store-item" data-joker="hint" data-price="15">
                        <div class="joker-icon"><i class="fas fa-lightbulb"></i></div>
                        <div class="joker-info">
                            <h3>İpucu Joker</h3>
                            <p>Doğru cevap hakkında ipucu al</p>
                            <div class="joker-price">15 <i class="fas fa-coins"></i></div>
                        </div>
                        <div class="joker-count">Sahip olduğunuz: <span class="joker-owned-count">0</span></div>
                        <button class="joker-buy-btn">Satın Al</button>
                    </div>
                    <div class="joker-store-item" data-joker="time" data-price="20">
                        <div class="joker-icon"><i class="fas fa-clock"></i></div>
                        <div class="joker-info">
                            <h3>Süre Joker</h3>
                            <p>Bu soru için 15 saniye ekle</p>
                            <div class="joker-price">20 <i class="fas fa-coins"></i></div>
                        </div>
                        <div class="joker-count">Sahip olduğunuz: <span class="joker-owned-count">0</span></div>
                        <button class="joker-buy-btn">Satın Al</button>
                    </div>
                    <div class="joker-store-item" data-joker="skip" data-price="25">
                        <div class="joker-icon"><i class="fas fa-forward"></i></div>
                        <div class="joker-info">
                            <h3>Pas Joker</h3>
                            <p>Bu soruyu pas geç ve can kaybetme</p>
                            <div class="joker-price">25 <i class="fas fa-coins"></i></div>
                        </div>
                        <div class="joker-count">Sahip olduğunuz: <span class="joker-owned-count">0</span></div>
                        <button class="joker-buy-btn">Satın Al</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Kuralları Modal -->
    <div id="chat-rules-modal" class="chat-rules-modal">
        <div class="chat-rules-content">
            <div class="chat-rules-header">
                <h3><i class="fas fa-comments"></i> Sohbet Kuralları ve Gizlilik Bildirimi</h3>
                <button id="close-chat-rules" class="chat-rules-close">&times;</button>
            </div>
            <div class="chat-rules-body">
                <h4>Kişisel Veri ve KVKK/GDPR Bildirimi</h4>
                <p>Bu uygulamada gönderdiğiniz mesajlar, 6698 sayılı Kişisel Verilerin Korunması Kanunu (KVKK) ve AB Genel Veri Koruma Yönetmeliği (GDPR) kapsamında kişisel veri olarak değerlendirilmektedir.</p>
                
                <h4>Veri Saklama Politikası</h4>
                <ul>
                    <li>Mesajlarınız, oyun tamamlandıktan sonra en fazla 30 gün süreyle saklanabilir.</li>
                    <li>Mesajlarınız, güvenli sunucularda şifrelenmiş olarak saklanmaktadır.</li>
                    <li>Mesajların içeriği, yalnızca yasal zorunluluklar olması halinde yetkili mercilerle paylaşılabilir.</li>
                </ul>
                
                <h4>Uyulması Gereken Kurallar</h4>
                <ul>
                    <li>Kişisel bilgilerinizi (isim, adres, telefon, e-posta vb.) sohbet kısmında paylaşmayınız.</li>
                    <li>Hakaret, küfür ve uygunsuz içerikler paylaşılması yasaktır.</li>
                    <li>Irkçı, cinsiyetçi, ayrımcı ve nefret söylemi içeren mesajlar göndermek yasaktır.</li>
                    <li>Diğer oyuncuları rahatsız edici davranışlarda bulunmak yasaktır.</li>
                    <li>Yasadışı faaliyetleri teşvik eden mesajlar göndermek yasaktır.</li>
                </ul>
                
                <h4>Kural İhlalleri ve Sonuçları</h4>
                <p>Kurallara uymayan mesajlar, diğer kullanıcılar tarafından bildirilebilir ve gerekli durumda şu işlemler uygulanabilir:</p>
                <ul>
                    <li>Mesajın kaldırılması</li>
                    <li>Geçici olarak sohbet özelliğinin engellenmesi</li>
                    <li>Hesabın kalıcı olarak engellenmesi</li>
                    <li>Gerekli durumlarda yasal yollara başvurulması</li>
                </ul>
                
                <h4>Haklarınız</h4>
                <p>KVKK ve GDPR kapsamında, kişisel verilerinize ilişkin şu haklara sahipsiniz:</p>
                <ul>
                    <li>Kişisel verilerinizin işlenip işlenmediğini öğrenme</li>
                    <li>Kişisel verileriniz işlenmişse buna ilişkin bilgi talep etme</li>
                    <li>Kişisel verilerinizin silinmesini veya yok edilmesini isteme</li>
                </ul>
                <p>Bu haklarınızı kullanmak için <a href="mailto:contact@example.com">contact@example.com</a> adresine e-posta gönderebilirsiniz.</p>
            </div>
            <div class="chat-rules-footer">
                <button id="accept-rules-btn">Anladım ve Kabul Ediyorum</button>
            </div>
        </div>
    </div>
</body>
</html> 